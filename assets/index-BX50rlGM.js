import{g as t,r as e,j as r}from"./index-C8uXfnIX.js";import{h as i,i as a,f as n,u as s,d as o}from"./recordStore-DHPEKnyF.js";import{d as l}from"./demoData-DANDD5Gv.js";var h=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},c=function(t,e){if(!h(t))return t;for(var r=[],i=0;i<t.length;i++){var a=t[i];e(a,i)&&r.push(a)}return r},u={}.toString,f=function(t,e){return u.call(t)==="[object "+e+"]"};const g=function(t){return f(t,"Function")};var d=function(t){return null==t};const p=function(t){return Array.isArray?Array.isArray(t):f(t,"Array")},v=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function m(t,e){if(t)if(p(t))for(var r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(v(t))for(var a in t)if(t.hasOwnProperty(a)&&!1===e(t[a],a))break}var y=function(t){if(!function(t){return"object"==typeof t&&null!==t}(t)||!f(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};var x=function(t){var e=t.filter((function(t){return!isNaN(t)}));if(!e.length)return{min:0,max:0};if(p(t[0])){for(var r=[],i=0;i<t.length;i++)r=r.concat(t[i]);e=r}var a=function(t){if(p(t))return t.reduce((function(t,e){return Math.max(t,e)}),t[0])}(e);return{min:function(t){if(p(t))return t.reduce((function(t,e){return Math.min(t,e)}),t[0])}(e),max:a}};const _=function(t){return f(t,"String")};function S(t){if(h(t))return t[0]}function b(t){if(h(t)){return t[t.length-1]}}var M=function(t,e){var r=e.toString(),i=r.indexOf(".");if(-1===i)return Math.round(t);var a=r.substr(i+1).length;return a>20&&(a=20),parseFloat(t.toFixed(a))},w=function(t){return f(t,"Number")},P=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return m(t,(function(r,i){g(t)&&"prototype"===i||e.push(r)})),e};const C=function(t){return d(t)?"":t.toString()};function k(t,e){return t&&e?t.replace(/\\?\{([^{}]+)\}/g,(function(t,r){return"\\"===t.charAt(0)?t.slice(1):void 0===e[r]?"":e[r]})):t}var T=function(t){var e=C(t);return e.charAt(0).toUpperCase()+e.substring(1)},D={}.toString,A=function(t){return f(t,"Date")},I=Object.prototype;function Y(t,e){for(var r in e)e.hasOwnProperty(r)&&"constructor"!==r&&void 0!==e[r]&&(t[r]=e[r])}function O(t,e,r,i){return e&&Y(t,e),r&&Y(t,r),t}function N(t,e,r,i){for(var a in r=r||0,i=i||5,e)if(e.hasOwnProperty(a)){var n=e[a];null!==n&&y(n)?(y(t[a])||(t[a]={}),r<i?N(t[a],n,r+1,i):t[a]=e[a]):p(n)?(t[a]=[],t[a]=t[a].concat(n)):void 0!==n&&(t[a]=n)}}var j=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var i=0;i<e.length;i+=1)N(t,e[i]);return t},E=function(t,e){if(!h(t))return-1;var r=Array.prototype.indexOf;if(r)return r.call(t,e);for(var i=-1,a=0;a<t.length;a++)if(t[a]===e){i=a;break}return i},F=Object.prototype.hasOwnProperty;function z(t){if(d(t))return!0;if(h(t))return!t.length;var e=function(t){return D.call(t).replace(/^\[object /,"").replace(/]$/,"")}(t);if("Map"===e||"Set"===e)return!t.size;if(function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||I)}(t))return!Object.keys(t).length;for(var r in t)if(F.call(t,r))return!1;return!0}var L;function B(t){return d(t)?0:h(t)?t.length:Object.keys(t).length}function X(t,e){for(var r=null,i=0,a=t.length;i<a;i++){var n=t[i][e];if(!d(n)){r=p(n)?n[0]:n;break}}return r}function R(t,e){if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}}function G(t){if(!t.length)return{min:0,max:0};var e=Math.max.apply(null,t);return{min:Math.min.apply(null,t),max:e}}!function(t,e){if(!g(t))throw new TypeError("Expected a function");var r=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var n=e?e.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var o=t.apply(this,i);return s.set(n,o),o};r.cache=new Map}((function(t,e){void 0===e&&(e={});var r=e.fontSize,i=e.fontFamily,a=e.fontWeight,n=e.fontStyle,s=e.fontVariant;return L||(L=document.createElement("canvas").getContext("2d")),L.font=[n,s,a,r+"px",i].join(" "),L.measureText(_(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),i([t],P(e)).join("")}));var H=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get(){t=!0}});window.addEventListener("e",null,e)}catch(r){}return t}()&&{passive:!0};function W(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}function V(t){var e=W(t,"width");return"auto"===e&&(e=t.offsetWidth),parseFloat(e)}function q(t){var e=W(t,"height");return"auto"===e&&(e=t.offsetHeight),parseFloat(e)}function Z(t,e){var r=e.get("el");if(!r)return t;var{top:i,left:a}=r.getBoundingClientRect(),n=parseFloat(W(r,"padding-left")),s=parseFloat(W(r,"padding-top"));return{x:t.x-a-n,y:t.y-i-s}}function U(t,e){var r=e.get("landscape");if(!r)return t;if(g(r))return r(t,e);var i=e.get("height");return{x:t.y,y:i-t.x}}function J(t,e){var r=t.touches;if(!r)return[U(Z({x:t.clientX,y:t.clientY},e),e)];r.length||(r=t.changedTouches||[]);for(var i=[],a=0,n=r.length;a<n;a++){var s=r[a],{x:o,y:l,clientX:h,clientY:c}=s,u=void 0;u=w(o)||w(l)?{x:o,y:l}:Z({x:h,y:c},e),i.push(U(u,e))}return i}function $(t,e){var r=J(t,e.get("canvas"))[0]||{};return{type:t.type,chart:e,native:t,x:r.x,y:r.y}}function K(t,e,r){return r||(r=document.createElement("canvas").getContext("2d")),r.font=e||"12px sans-serif",r.measureText(t)}function Q(t){var e,r,i,a;return w(t)||_(t)?e=i=a=r=t:p(t)&&(e=t[0],r=d(t[1])?t[0]:t[1],i=d(t[2])?t[0]:t[2],a=d(t[3])?r:t[3]),[e,r,i,a]}function tt(t,e){return void 0===t||"string"==typeof t&&-1!==t.indexOf(e)}function et(t){return _(t)&&(t=t.indexOf("T")>0?new Date(t).getTime():new Date(t.replace(/-/gi,"/")).getTime()),A(t)&&(t=t.getTime()),t}"object"==typeof wx&&wx.getSystemInfoSync,"object"==typeof my&&my.getSystemInfoSync;var rt="#E8E8E8",it={label:{fill:"#808080",fontSize:10},line:{stroke:rt,lineWidth:1},grid:{type:"line",stroke:rt,lineWidth:1,lineDash:[2]},tickLine:null,labelOffset:7.5},at={fontFamily:'"Helvetica Neue", "San Francisco", Helvetica, Tahoma, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", sans-serif',defaultColor:"#1890FF",pixelRatio:1,padding:"auto",appendPadding:15,colors:["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],shapes:{line:["line","dash"],point:["circle","hollowCircle"]},sizes:[4,10],axis:{common:it,bottom:O({},it,{grid:null}),left:O({},it,{line:null}),right:O({},it,{line:null}),circle:O({},it,{line:null}),radius:O({},it,{labelOffset:4})},shape:{line:{lineWidth:2,lineJoin:"round",lineCap:"round"},point:{lineWidth:0,size:3},area:{fillOpacity:.1}},_defaultAxis:it};const nt={general:{title:"这是一个图表，",withTitle:"这是一个关于“{title}”的图表。"},coord:{cartesian:"X轴是{xLabel}Y轴是{yLabel}"},scale:{linear:"数值型，数据最小值为{min}，最大值为{max}；",cat:"分类型, 分类类型有：{values}；",timeCat:"时间型，时间范围从{start}到{end}；"},geometry:{prefix:"共有{count}种分类组成，",oneData:"第{index}类是{name}，数据是{values};",partData:"第{index}类是{name}，共有{count}项数据，前{part}项是{values};",allData:"第{index}类是{name}，有{count}项数据，分别是{values};"},legend:{prefix:"图例分类有："}};var st={version:"3.8.13",scales:{},widthRatio:{column:.5,rose:.999999,multiplePie:3/4},lineDash:[4,4],lang:nt,setTheme:function(t){j(st,t)}};st.setTheme(at);var ot="afterinit",lt="afterdatachange",ht="_aftersizechange";class ct{constructor(){this.__events={}}on(t,e){if(t&&e){var r=this.__events[t]||[];r.push(e),this.__events[t]=r}}emit(t,e){var r=this;if(v(t)&&(t=(e=t)&&e.type),t){var i=this.__events[t];i&&i.length&&i.forEach((function(t){t.call(r,e)}))}}off(t,e){var r=this.__events,i=r[t];if(i&&i.length)if(e)for(var a=0,n=i.length;a<n;a++)i[a]===e&&(i.splice(a,1),a--);else delete r[t]}}let ut=class extends ct{getDefaultCfg(){return{}}constructor(t){super();var e={},r=this.getDefaultCfg();this._attrs=e,O(e,r,t)}get(t){return this._attrs[t]}set(t,e){this._attrs[t]=e}destroy(){this._attrs={},this.destroyed=!0}};class ft{constructor(t){O(this,t),this._init()}_init(){var t=this.start,e=this.end,r=Math.min(t.x,e.x),i=Math.max(t.x,e.x),a=Math.min(t.y,e.y),n=Math.max(t.y,e.y);this.tl={x:r,y:a},this.tr={x:i,y:a},this.bl={x:r,y:n},this.br={x:i,y:n},this.width=i-r,this.height=n-a}reset(t,e){this.start=t,this.end=e,this._init()}isInRange(t,e){v(t)&&(e=t.y,t=t.x);var r=this.tl,i=this.br;return r.x<=t&&t<=i.x&&r.y<=e&&e<=i.y}}var gt={generateDefault:()=>[1,0,0,1,0,0],isChanged:t=>1!==t[0]||0!==t[1]||0!==t[2]||1!==t[3]||0!==t[4]||0!==t[5],multiply:(t,e)=>[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]],scale:(t,e,r)=>(t[0]=e[0]*r[0],t[1]=e[1]*r[0],t[2]=e[2]*r[1],t[3]=e[3]*r[1],t[4]=e[4],t[5]=e[5],t),rotate(t,e,r){var i=Math.cos(r),a=Math.sin(r),n=e[0]*i+e[2]*a,s=e[1]*i+e[3]*a,o=e[0]*-a+e[2]*i,l=e[1]*-a+e[3]*i;return t[0]=n,t[1]=s,t[2]=o,t[3]=l,t[4]=e[4],t[5]=e[5],t},translate:(t,e,r)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+e[0]*r[0]+e[2]*r[1],t[5]=e[5]+e[1]*r[0]+e[3]*r[1],t),transform(t,e){for(var r=[].concat(t),i=0,a=e.length;i<a;i++){var n=e[i];switch(n[0]){case"t":gt.translate(r,r,[n[1],n[2]]);break;case"s":gt.scale(r,r,[n[1],n[2]]);break;case"r":gt.rotate(r,r,n[1])}}return r}};const dt={create:()=>[0,0],length(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},normalize(t,e){var r=this.length(e);return 0===r?(t[0]=0,t[1]=0):(t[0]=e[0]/r,t[1]=e[1]/r),t},add:(t,e,r)=>(t[0]=e[0]+r[0],t[1]=e[1]+r[1],t),sub:(t,e,r)=>(t[0]=e[0]-r[0],t[1]=e[1]-r[1],t),scale:(t,e,r)=>(t[0]=e[0]*r,t[1]=e[1]*r,t),dot:(t,e)=>t[0]*e[0]+t[1]*e[1],direction:(t,e)=>t[0]*e[1]-e[0]*t[1],angle(t,e){var r=this.dot(t,e)/(this.length(t)*this.length(e));return Math.acos(r)},angleTo(t,e,r){var i=this.angle(t,e),a=this.direction(t,e)>=0;return r?a?2*Math.PI-i:i:a?i:2*Math.PI-i},zero:t=>0===t[0]&&0===t[1],distance(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)},clone:t=>[t[0],t[1]],min:(t,e,r)=>(t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t),max:(t,e,r)=>(t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t),transformMat2d(t,e,r){var i=e[0],a=e[1];return t[0]=r[0]*i+r[2]*a+r[4],t[1]=r[1]*i+r[3]*a+r[5],t}};var pt=[1,0,0,1,0,0];let vt=class{_initDefaultCfg(){}constructor(t){var e,r;this._initDefaultCfg(),O(this,t),this.plot?(e=this.plot.bl,r=this.plot.tr,this.start=e,this.end=r):(e=this.start,r=this.end),this.init(e,r)}_scale(t,e){var r=this.matrix,i=this.center;gt.translate(r,r,[i.x,i.y]),gt.scale(r,r,[t,e]),gt.translate(r,r,[-i.x,-i.y])}init(t,e){this.matrix=[].concat(pt),this.center={x:(e.x-t.x)/2+t.x,y:(e.y-t.y)/2+t.y},this.scale&&this._scale(this.scale[0],this.scale[1])}convertPoint(t){var{x:e,y:r}=this._convertPoint(t);if(!gt.isChanged(this.matrix))return{x:e,y:r};var i=[e,r];return dt.transformMat2d(i,i,this.matrix),{x:i[0],y:i[1]}}invertPoint(t){return this._invertPoint(t)}_convertPoint(t){return t}_invertPoint(t){return t}reset(t){this.plot=t;var{bl:e,tr:r}=t;this.start=e,this.end=r,this.init(e,r)}};class mt extends vt{_initDefaultCfg(){this.type="cartesian",this.transposed=!1,this.isRect=!0}init(t,e){super.init(t,e),this.x={start:t.x,end:e.x},this.y={start:t.y,end:e.y}}_convertPoint(t){var e=this,r=e.transposed,i=r?"y":"x",a=r?"x":"y",n=e.x,s=e.y;return{x:n.start+(n.end-n.start)*t[i],y:s.start+(s.end-s.start)*t[a]}}_invertPoint(t){var e=this,r=e.transposed,i=r?"y":"x",a=r?"x":"y",n=e.x,s=e.y,o={};return o[i]=(t.x-n.start)/(n.end-n.start),o[a]=(t.y-s.start)/(s.end-s.start),o}}function yt(t,e){return _(e)?e:t.invert(t.scale(e))}vt.Cartesian=mt,vt.Rect=mt;class xt{constructor(t){var e=this;this.type="base",this.name=null,this.method=null,this.values=[],this.scales=[],this.linear=null;var r=null,i=this.callback;if(t.callback){var a=t.callback;r=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=a(...r);return d(s)&&(s=i.apply(e,r)),s}}O(this,t),r&&O(this,{callback:r})}_getAttrValue(t,e){var r=this.values;if(t.isCategory&&!this.linear)return r[t.translate(e)%r.length];var i=t.scale(e);return this.getLinearValue(i)}getLinearValue(t){var e=this.values,r=e.length-1,i=Math.floor(r*t),a=r*t-i,n=e[i];return n+((i===r?n:e[i+1])-n)*a}callback(t){var e=this.scales[0];return"identity"===e.type?e.value:this._getAttrValue(e,t)}getNames(){for(var t=this.scales,e=this.names,r=Math.min(t.length,e.length),i=[],a=0;a<r;a++)i.push(e[a]);return i}getFields(){var t=this.scales,e=[];return m(t,(function(t){e.push(t.field)})),e}getScale(t){return this.scales[this.names.indexOf(t)]}mapping(){for(var t=this.scales,e=this.callback,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var n=i;if(e){for(var s=0,o=i.length;s<o;s++)i[s]=this._toOriginParam(i[s],t[s]);n=e.apply(this,i)}return n=[].concat(n)}_toOriginParam(t,e){var r=t;if(!e.isLinear)if(p(t)){r=[];for(var i=0,a=t.length;i<a;i++)r.push(yt(e,t[i]))}else r=yt(e,t);return r}}function _t(t,e,r,i){return t[i]+(e[i]-t[i])*r}function St(t){return"#"+bt(t[0])+bt(t[1])+bt(t[2])}function bt(t){return 1===(t=(t=Math.round(t)).toString(16)).length&&(t="0"+t),t}var Mt={black:"#000000",blue:"#0000ff",grey:"#808080",green:"#008000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",red:"#ff0000",white:"#ffffff",yellow:"#ffff00"};function wt(t){var e=[];return _(t)&&(t=t.split("-")),m(t,(function(t){var r,i;-1===t.indexOf("#")&&(t=function(t){if(Mt[t])return Mt[t];if("#"===t[0]){if(7===t.length)return t;var e=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,r,i){return"#"+e+e+r+r+i+i}));return Mt[t]=e,e}var r=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return r.shift(),r=St(r),Mt[t]=r,r}(t)),e.push((r=t,(i=[]).push(parseInt(r.substr(1,2),16)),i.push(parseInt(r.substr(3,2),16)),i.push(parseInt(r.substr(5,2),16)),i))})),function(t){return function(t,e){var r=t.length-1,i=Math.floor(r*e),a=r*e-i,n=t[i],s=i===r?n:t[i+1];return St([_t(n,s,a,0),_t(n,s,a,1),_t(n,s,a,2)])}(e,t)}}const Pt=Object.freeze(Object.defineProperty({__proto__:null,Color:class extends xt{constructor(t){super(t),this.names=["color"],this.type="color",this.gradient=null,_(this.values)&&(this.linear=!0)}getLinearValue(t){var e=this.gradient;e||(e=wt(this.values),this.gradient=e);return e(t)}},Position:class extends xt{constructor(t){super(t),this.names=["x","y"],this.type="position"}mapping(t,e){var r,i,a,n=this.scales,s=this.coord,o=n[0],l=n[1];if(d(t)||d(e))return[];if(p(e)&&p(t)){r=[],i=[];for(var h=0,c=0,u=t.length,f=e.length;h<u&&c<f;h++,c++)a=s.convertPoint({x:o.scale(t[h]),y:l.scale(e[c])}),r.push(a.x),i.push(a.y)}else if(p(e))t=o.scale(t),i=[],m(e,(function(e){e=l.scale(e),a=s.convertPoint({x:t,y:e}),r&&r!==a.x?(p(r)||(r=[r]),r.push(a.x)):r=a.x,i.push(a.y)}));else if(p(t))e=l.scale(e),r=[],m(t,(function(t){t=o.scale(t),a=s.convertPoint({x:t,y:e}),i&&i!==a.y?(p(i)||(i=[i]),i.push(a.y)):i=a.y,r.push(a.x)}));else{t=o.scale(t),e=l.scale(e);var g=s.convertPoint({x:t,y:e});r=g.x,i=g.y}return[r,i]}},Shape:class extends xt{constructor(t){super(t),this.names=["shape"],this.type="shape",this.gradient=null}getLinearValue(t){var e=this.values;return e[Math.round((e.length-1)*t)]}},Size:class extends xt{constructor(t){super(t),this.names=["size"],this.type="size",this.gradient=null}}},Symbol.toStringTag,{value:"Module"}));var Ct,kt,Tt,Dt,At={},It={_coord:null,draw(t,e){this.drawShape&&this.drawShape(t,e)},setCoord(t){this._coord=t},parsePoint(t){var e=this._coord;return e.isPolar&&(1===t.x&&(t.x=.9999999),1===t.y&&(t.y=.9999999)),e.convertPoint(t)},parsePoints(t){if(!t)return!1;var e=this,r=[];return t.forEach((function(t){r.push(e.parsePoint(t))})),r}},Yt={defaultShapeType:null,setCoord(t){this._coord=t},getShape(t){var e=this;p(t)&&(t=t[0]);var r=e[t]||e[e.defaultShapeType];return r._coord=e._coord,r},getShapePoints(t,e){var r=this.getShape(t);return(r.getPoints||r.getShapePoints||this.getDefaultPoints)(e)},getDefaultPoints:()=>[],drawShape(t,e,r){var i=this.getShape(t);return e.color||(e.color=st.colors[0]),i.draw(e,r)}};function Ot(){if(Dt)return Tt;Dt=1;var t=function(){if(kt)return Ct;function t(t,e){for(var r in e)e.hasOwnProperty(r)&&"constructor"!==r&&void 0!==e[r]&&(t[r]=e[r])}return kt=1,Ct=function(e,r,i,a){return r&&t(e,r),i&&t(e,i),a&&t(e,a),e}}();return Tt=function(){var e=r.prototype;function r(e){this._initDefaultCfg(),t(this,e)}return e._initDefaultCfg=function(){this.adjustNames=["x","y"]},e.processAdjust=function(){},r}()}At.registerFactory=function(t,e){var r=T(t),i=O({},Yt,e);return At[r]=i,i.name=t,i},At.registerShape=function(t,e,r){var i=T(t),a=At[i],n=O({},It,r);return a[e]=n,n},At.registShape=At.registerShape,At.getShapeFactory=function(t){return this[T(t=t||"point")]};const Nt=t(Ot());function jt(t){var{type:e,values:r}=t;if("linear"===e)return k(nt.scale.linear,t);if("cat"===e)return k(nt.scale.cat,{values:r.slice(0,10).join(" ")});if("timeCat"===e){var i=t.getText(r[0]),a=t.getText(r[r.length-1]);return k(nt.scale.timeCat,{start:i,end:a})}return""}function Et(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Et(Object(r),!0).forEach((function(e){zt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function zt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Lt=["color","size","shape"],Bt="_origin",Xt="_originY";function Rt(t){return p(t)?t:_(t)?t.split("*"):[t]}class Gt extends ut{getDefaultCfg(){return{type:null,data:null,attrs:{},scales:{},container:null,styleOptions:null,chart:null,shapeType:"",generatePoints:!1,attrOptions:{},sortable:!1,startOnZero:!0,visible:!0,connectNulls:!1,ignoreEmptyGroup:!1,isInit:!1}}init(){var t=this;t.get("isInit")||(t._initAttrs(),t._processData(),t.set("isInit",!0))}_getGroupScales(){var t=this,e=[];return m(Lt,(function(r){var i=t.getAttr(r);i&&m(i.scales,(function(t){t&&t.isCategory&&-1===e.indexOf(t)&&e.push(t)}))})),e}_groupData(t){var e=this.get("colDefs"),r=this._getGroupScales();if(r.length){var i={},a=[];return m(r,(function(t){var r=t.field;a.push(r),e&&e[r]&&e[r].values&&(i[t.field]=e[r].values)})),function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return[t];var i=function(t,e){if(!e)return{0:t};for(var r=function(t){for(var r="_",i=0,a=e.length;i<a;i++)r+=t[e[i]]&&t[e[i]].toString();return r},i={},a=0,n=t.length;a<n;a++){var s=t[a],o=r(s);i[o]?i[o].push(s):i[o]=[s]}return i}(t,e),a=[];if(1===e.length&&r[e[0]])m(r[e[0]],(function(t){t="_"+t,a.push(i[t])}));else for(var n in i)a.push(i[n]);return a}(t,a,i)}return[t]}_setAttrOptions(t,e){this.get("attrOptions")[t]=e;var r=this.get("attrs");Object.keys(r).length&&this._createAttr(t,e)}_createAttrOption(t,e,r,i){var a={};a.field=e,r?g(r)?a.callback=r:a.values=r:a.values=i,this._setAttrOptions(t,a)}_createAttr(t,e){var r=this,i=r.get("attrs"),a=r.get("coord"),n=T(t),s=Rt(e.field);"position"===t&&(e.coord=a);for(var o=[],l=0,h=s.length;l<h;l++){var c=s[l],u=r._createScale(c);o.push(u)}if("position"===t){var f=o[1];"polar"===a.type&&a.transposed&&r.hasAdjust("stack")&&f.values.length&&f.change({nice:!1,min:0,max:Math.max.apply(null,f.values)})}e.scales=o;var g=new Pt[n](e);return i[t]=g,g}_initAttrs(){var t=this.get("attrOptions");for(var e in t)t.hasOwnProperty(e)&&this._createAttr(e,t[e])}_createScale(t){var e=this.get("scales"),r=e[t];return r||(r=this.get("chart").createScale(t),e[t]=r),r}_processData(){var t=this,e=this.get("data"),r=[],i=this._groupData(e);if(this.get("ignoreEmptyGroup")){var a=this.getYScale();i=i.filter((function(t){return t.some((function(t){return void 0!==t[a.field]}))}))}for(var n=0,s=i.length;n<s;n++){var o=i[n],l=t._saveOrigin(o);this.hasAdjust("dodge")&&t._numberic(l),r.push(l)}return t.get("adjust")&&t._adjustData(r),t.get("sortable")&&t._sort(r),t.emit("afterprocessdata",{dataArray:r}),t.set("mappingData",r),t.set("dataArray",r),r}_saveOrigin(t){for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r],n={};for(var s in a)n[s]=a[s];n[Bt]=a,e.push(n)}return e}_numberic(t){for(var e=this.getAttr("position").scales,r=0,i=t.length;r<i;r++)for(var a=t[r],n=Math.min(2,e.length),s=0;s<n;s++){var o=e[s];if(o.isCategory){var l=o.field;a[l]=o.translate(a[l])}}}_adjustData(t){var e=this,r=e.get("adjust");if(r){var i=T(r.type);if(!Nt[i])throw new Error("not support such adjust : "+r);var a=e.getXScale(),n=e.getYScale(),s=O({xField:a.field,yField:n.field},r);new Nt[i](s).processAdjust(t),"Stack"===i&&e._updateStackRange(n.field,n,t)}}_updateStackRange(t,e,r){for(var i=function(t){for(var e=[],r=0,i=t.length;r<i;r++)e=e.concat(t[r]);return e}(r),a=e.min,n=e.max,s=0,o=i.length;s<o;s++){var l=i[s],h=Math.min.apply(null,l[t]),c=Math.max.apply(null,l[t]);h<a&&(a=h),c>n&&(n=c)}(a<e.min||n>e.max)&&e.change({min:a,max:n})}_sort(t){var e=this,r=e.getXScale(),{field:i,type:a}=r;"identity"!==a&&r.values.length>1&&m(t,(function(t){t.sort((function(t,e){return"timeCat"===a?et(t[Bt][i])-et(e[Bt][i]):r.translate(t[Bt][i])-r.translate(e[Bt][i])}))})),e.set("hasSorted",!0),e.set("dataArray",t)}paint(){var t=this,e=t.get("mappingData"),r=[],i=t.getShapeFactory();i.setCoord(t.get("coord")),t._beforeMapping(e);for(var a=0,n=e.length;a<n;a++){var s=e[a];if(s.length){var o=t._mapping(s);r.push(o),t.draw(o,i)}}t.set("dataArray",r),this.generateAria()}getShapeFactory(){var t=this.get("shapeFactory");if(!t){var e=this.get("shapeType");t=At.getShapeFactory(e),this.set("shapeFactory",t)}return t}_mapping(t){var e=this,r=e.get("attrs"),i=e.getYScale().field,a={},n=new Array(t.length);for(var s in r)if(r.hasOwnProperty(s))for(var o=r[s],l=o.names,h=o.scales,c=0,u=t.length;c<u;c++){var f=t[c],g=Ft(Ft({},f),n[c]);if(g[Xt]=f[i],"position"===o.type)for(var d=e._getAttrValues(o,f),v=0,m=d.length;v<m;v++){var y=d[v];g[l[v]]=p(y)&&1===y.length?y[0]:y}else{var x=l[0],_=f[h[0].field],S="".concat(x).concat(_),b=a[S];b||(b=e._getAttrValues(o,f),a[S]=b),g[x]=b[0]}n[c]=g}return n}_getAttrValues(t,e){for(var r=t.scales,i=[],a=0,n=r.length;a<n;a++){var s=r[a],o=s.field;"identity"===s.type?i.push(s.value):i.push(e[o])}return t.mapping(...i)}getAttrValue(t,e){var r=this.getAttr(t),i=null;r&&(i=this._getAttrValues(r,e)[0]);return i}_beforeMapping(t){this.get("generatePoints")&&this._generatePoints(t)}isInCircle(){var t=this.get("coord");return t&&t.isPolar}getCallbackCfg(t,e,r){if(!t)return e;var i={},a=t.map((function(t){return r[t]}));return m(e,(function(t,e){g(t)?i[e]=t.apply(null,a):i[e]=t})),i}getDrawCfg(t){var e=this,r=e.isInCircle(),i={origin:t,x:t.x,y:t.y,color:t.color,size:t.size,shape:t.shape,isInCircle:r,opacity:t.opacity},a=e.get("styleOptions");return a&&a.style&&(i.style=e.getCallbackCfg(a.fields,a.style,t[Bt])),e.get("generatePoints")&&(i.points=t.points,i.nextPoints=t.nextPoints),r&&(i.center=e.get("coord").center),i}draw(t,e){var r=this,i=r.get("container"),a=r.getYScale();m(t,(function(t,n){if(!a||!d(t._origin[a.field])){t.index=n;var s=r.getDrawCfg(t),o=t.shape;r.drawShape(o,t,s,i,e)}}))}drawShape(t,e,r,i,a){var n=a.drawShape(t,r,i);n&&m([].concat(n),(function(t){t.set("origin",e)}))}_generatePoints(t){var e=this,r=e.getShapeFactory(),i=e.getAttr("shape");m(t,(function(t){for(var a=0,n=t.length;a<n;a++){var s=t[a],o=e.createShapePointsCfg(s),l=i?e._getAttrValues(i,s):null,h=r.getShapePoints(l,o);s.points=h}})),m(t,(function(e,r){var i=t[r+1];i&&(e[0].nextPoints=i[0].points)}))}generateAria(){var t=this.get("container");if(t.get("aria")){var e=[],r=this.get("coord"),i=this.getXScale(),a=this.getYScale(),n=function(t,e,r){var{type:i}=t;return nt.coord[i]?k(nt.coord[i],{xLabel:jt(e),yLabel:jt(r)}):""}(r,i,a);e.push(n);var{prefix:s,oneData:o,partData:l,allData:h}=nt.geometry,c=this.get("dataArray"),u=c.length,f=this._getGroupScales()[0];if(f){var g=k(s,{count:u});e.push(g),m(c,(function(t,r){var n=t.length;if(n){var s=t[0]._origin;if(1===n)e.push(k(o,{index:r+1,count:n,name:s[f.field],values:s[a.field]}));else{var c=n>5?l:h,u=t.slice(0,5).map((function(t){var{_origin:e}=t,r=i.getText(e[i.field]),n=a.getText(e[a.field]);return"".concat(r,":").concat(n)}));e.push(k(c,{index:r+1,count:n,part:3,name:s[f.field],values:u.join(" ")}))}}}))}t.set("ariaLabel",e.join(""))}}createShapePointsCfg(t){var e=this.getXScale(),r=this.getYScale();return{x:this._normalizeValues(t[e.field],e),y:r?this._normalizeValues(t[r.field],r):t.y?t.y:.1,y0:r?r.scale(this.getYMinValue()):void 0}}getYMinValue(){var t=this.getYScale(),{min:e,max:r}=t;return this.get("startOnZero")?r<=0&&e<=0?r:e>=0?e:0:e}_normalizeValues(t,e){var r=[];if(p(t))for(var i=0,a=t.length;i<a;i++){var n=t[i];r.push(e.scale(n))}else r=e.scale(t);return r}getAttr(t){return this.get("attrs")[t]}getXScale(){return this.getAttr("position").scales[0]}getYScale(){return this.getAttr("position").scales[1]}hasAdjust(t){return this.get("adjust")&&this.get("adjust").type===t}_getSnap(t,e,r){var i,a=0,n=this.getYScale().field;if(this.hasAdjust("stack")&&t.field===n){i=[],r.forEach((function(t){i.push(t[Xt])}));for(var s=i.length;a<s&&!(i[0][0]>e);a++){if(i[i.length-1][1]<=e){a=i.length-1;break}if(i[a][0]<=e&&i[a][1]>e)break}}else{(i=t.values).sort((function(t,e){return t-e}));for(var o=i.length;a<o&&!(o<=1)&&!((i[0]+i[1])/2>e)&&!((i[a-1]+i[a])/2<=e&&(i[a+1]+i[a])/2>e);a++)if((i[i.length-2]+i[i.length-1])/2<=e){a=i.length-1;break}}return i[a]}getSnapRecords(t){var e=this,r=e.get("coord"),i=e.getXScale(),a=e.getYScale(),n=i.field,s=e.get("dataArray");this.get("hasSorted")||this._sort(s);var o=[],l=r.invertPoint(t),h=l.x;if(e.isInCircle()&&!r.transposed&&h>(1+i.rangeMax())/2&&(h=i.rangeMin()),i.isCategory){var c=i.rangeMin(),u=i.rangeMax();h<c&&(h=c),h>u&&(h=u)}var f=i.invert(h);i.isCategory||(f=e._getSnap(i,f));var g=[];if(s.forEach((function(t){t.forEach((function(t){var r=d(t[Bt])?t[n]:t[Bt][n];e._isEqual(r,f,i)&&g.push(t)}))})),this.hasAdjust("stack")&&r.isPolar&&r.transposed){if(h>=0&&h<=1){var v=a.invert(l.y);v=e._getSnap(a,v,g),g.forEach((function(t){(p(v)?t[Xt].toString()===v.toString():t[Xt]===v)&&o.push(t)}))}}else o=g;return o}getRecords(t){var e=this,r=this.getXScale(),i=this.get("dataArray"),a=r.field;return i.map((function(i){for(var n=i.length-1;n>=0;n--){var s=i[n],o=d(s[Bt])?s[a]:s[Bt][a];if(e._isEqual(o,t,r))return s}return null}))}_isEqual(t,e,r){return"timeCat"===r.type?et(t)===e:e===t}position(t){return this._setAttrOptions("position",{field:t}),this}color(t,e){return this._createAttrOption("color",t,e,st.colors),this}size(t,e){return this._createAttrOption("size",t,e,st.sizes),this}shape(t,e){var r=this.get("type"),i=st.shapes[r]||[];return this._createAttrOption("shape",t,e,i),this}style(t,e){var r,i=this.get("styleOptions");return i||(i={},this.set("styleOptions",i)),v(t)&&(e=t,t=null),t&&(r=Rt(t)),i.fields=r,i.style=e,this}adjust(t){return _(t)&&(t={type:t}),this.set("adjust",t),this}animate(t){return this.set("animateCfg",t),this}changeData(t){this.set("data",t),this.set("scales",{}),this.get("isInit")&&(this.set("isInit",!1),this.init())}clearInner(){var t=this.get("container");t&&t.clear()}reset(){this.set("isInit",!1),this.set("attrs",{}),this.set("attrOptions",{}),this.set("adjust",null),this.clearInner()}clear(){this.clearInner()}destroy(){this.set("isInit",!1),this.clear(),super.destroy()}_display(t){this.set("visible",t);var e=this.get("container"),r=e.get("canvas");e.set("visible",t),r.draw()}show(){this._display(!0)}hide(){this._display(!1)}}var Ht={};function Wt(t){return Ht[t]}function Vt(t,e){Ht[t]=e}var qt=function(){function t(t){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=t,this.initCfg(),this.init()}return t.prototype.translate=function(t){return t},t.prototype.change=function(t){O(this.__cfg__,t),this.init()},t.prototype.clone=function(){return this.constructor(this.__cfg__)},t.prototype.getTicks=function(){var t=this;return function(t,e){if(!h(t))return t;for(var r=[],i=0;i<t.length;i++){var a=t[i];r.push(e(a,i))}return r}(this.ticks,(function(e,r){return v(e)?e:{text:t.getText(e,r),tickValue:e,value:t.scale(e)}}))},t.prototype.getText=function(t,e){var r=this.formatter,i=r?r(t,e):t;return d(i)||!g(i.toString)?"":i.toString()},t.prototype.getConfig=function(t){return this.__cfg__[t]},t.prototype.init=function(){O(this,this.__cfg__),this.setDomain(),z(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},t.prototype.initCfg=function(){},t.prototype.setDomain=function(){},t.prototype.calculateTicks=function(){var t=this.tickMethod,e=[];if(_(t)){var r=Wt(t);if(!r)throw new Error("There is no method to to calculate ticks!");e=r(this)}else g(t)&&(e=t(this));return e},t.prototype.rangeMin=function(){return this.range[0]},t.prototype.rangeMax=function(){return this.range[1]},t.prototype.calcPercent=function(t,e,r){return w(t)?(t-e)/(r-e):NaN},t.prototype.calcValue=function(t,e,r){return e+t*(r-e)},t}(),Zt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="cat",e.isCategory=!0,e}return a(e,t),e.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},e.prototype.translate=function(t){this.buildIndexMap();var e=this.translateIndexMap.get(t);return void 0===e&&(e=w(t)?t:NaN),e},e.prototype.scale=function(t){var e=this.translate(t),r=this.calcPercent(e,this.min,this.max);return this.calcValue(r,this.rangeMin(),this.rangeMax())},e.prototype.invert=function(t){var e=this.max-this.min,r=this.calcPercent(t,this.rangeMin(),this.rangeMax()),i=Math.round(e*r)+this.min;return i<this.min||i>this.max?NaN:this.values[i]},e.prototype.getText=function(e){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var n=e;return w(e)&&!this.values.includes(e)&&(n=this.values[n]),t.prototype.getText.apply(this,i([n],r))},e.prototype.initCfg=function(){this.tickMethod="cat"},e.prototype.setDomain=function(){if(d(this.getConfig("min"))&&(this.min=0),d(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},e}(qt),Ut=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Jt="\\d\\d?",$t="\\d\\d",Kt="[^\\s]+",Qt=/\[([^]*?)\]/gm;function te(t,e){for(var r=[],i=0,a=t.length;i<a;i++)r.push(t[i].substr(0,e));return r}var ee=function(t){return function(e,r){var i=r[t].map((function(t){return t.toLowerCase()})).indexOf(e.toLowerCase());return i>-1?i:null}};function re(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var i=0,a=e;i<a.length;i++){var n=a[i];for(var s in n)t[s]=n[s]}return t}var ie=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ae=["January","February","March","April","May","June","July","August","September","October","November","December"],ne=te(ae,3),se={dayNamesShort:te(ie,3),dayNames:ie,monthNamesShort:ne,monthNames:ae,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!=10?1:0)*t%10]}},oe=re({},se),le=function(t){return oe=re(oe,t)},he=function(t){return t.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},ce=function(t,e){for(void 0===e&&(e=2),t=String(t);t.length<e;)t="0"+t;return t},ue={D:function(t){return String(t.getDate())},DD:function(t){return ce(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return ce(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return ce(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return ce(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return ce(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return ce(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return ce(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return ce(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return ce(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return ce(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return ce(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+ce(100*Math.floor(Math.abs(e)/60)+Math.abs(e)%60,4)},Z:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+ce(Math.floor(Math.abs(e)/60),2)+":"+ce(Math.abs(e)%60,2)}},fe=function(t){return+t-1},ge=[null,Jt],de=[null,Kt],pe=["isPm",Kt,function(t,e){var r=t.toLowerCase();return r===e.amPm[0]?0:r===e.amPm[1]?1:null}],ve=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(t){var e=(t+"").match(/([+-]|\d\d)/gi);if(e){var r=60*+e[1]+parseInt(e[2],10);return"+"===e[0]?r:-r}return 0}],me={D:["day",Jt],DD:["day",$t],Do:["day",Jt+Kt,function(t){return parseInt(t,10)}],M:["month",Jt,fe],MM:["month",$t,fe],YY:["year",$t,function(t){var e=+(""+(new Date).getFullYear()).substr(0,2);return+(""+(+t>68?e-1:e)+t)}],h:["hour",Jt,void 0,"isPm"],hh:["hour",$t,void 0,"isPm"],H:["hour",Jt],HH:["hour",$t],m:["minute",Jt],mm:["minute",$t],s:["second",Jt],ss:["second",$t],YYYY:["year","\\d{4}"],S:["millisecond","\\d",function(t){return 100*+t}],SS:["millisecond",$t,function(t){return 10*+t}],SSS:["millisecond","\\d{3}"],d:ge,dd:ge,ddd:de,dddd:de,MMM:["month",Kt,ee("monthNamesShort")],MMMM:["month",Kt,ee("monthNames")],a:pe,A:pe,ZZ:ve,Z:ve},ye={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},xe=function(t){return re(ye,t)},_e=function(t,e,r){if(void 0===e&&(e=ye.default),void 0===r&&(r={}),"number"==typeof t&&(t=new Date(t)),"[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))throw new Error("Invalid Date pass to format");var i=[];e=(e=ye[e]||e).replace(Qt,(function(t,e){return i.push(e),"@@@"}));var a=re(re({},oe),r);return(e=e.replace(Ut,(function(e){return ue[e](t,a)}))).replace(/@@@/g,(function(){return i.shift()}))};function Se(t,e,r){if(void 0===r&&(r={}),"string"!=typeof e)throw new Error("Invalid format in fecha parse");if(e=ye[e]||e,t.length>1e3)return null;var i={year:(new Date).getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},a=[],n=[],s=e.replace(Qt,(function(t,e){return n.push(he(e)),"@@@"})),o={},l={};s=he(s).replace(Ut,(function(t){var e=me[t],r=e[0],i=e[1],n=e[3];if(o[r])throw new Error("Invalid format. "+r+" specified twice in format");return o[r]=!0,n&&(l[n]=!0),a.push(e),"("+i+")"})),Object.keys(l).forEach((function(t){if(!o[t])throw new Error("Invalid format. "+t+" is required in specified format")})),s=s.replace(/@@@/g,(function(){return n.shift()}));var h=t.match(new RegExp(s,"i"));if(!h)return null;for(var c,u=re(re({},oe),r),f=1;f<h.length;f++){var g=a[f-1],d=g[0],p=g[2],v=p?p(h[f],u):+h[f];if(null==v)return null;i[d]=v}if(1===i.isPm&&null!=i.hour&&12!=+i.hour?i.hour=+i.hour+12:0===i.isPm&&12==+i.hour&&(i.hour=0),null==i.timezoneOffset){c=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var m=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],y=(f=0,m.length);f<y;f++)if(o[m[f][0]]&&i[m[f][0]]!==c[m[f][1]]())return null}else if(c=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return c}var be={format:_e,parse:Se,defaultI18n:se,setGlobalDateI18n:le,setGlobalDateMasks:xe};const Me=Object.freeze(Object.defineProperty({__proto__:null,assign:re,default:be,defaultI18n:se,format:_e,parse:Se,setGlobalDateI18n:le,setGlobalDateMasks:xe},Symbol.toStringTag,{value:"Module"}));var we="format";function Pe(t,e){return(Me[we]||be[we])(t,e)}function Ce(t){return _(t)&&(t=t.indexOf("T")>0?new Date(t).getTime():new Date(t.replace(/-/gi,"/")).getTime()),A(t)&&(t=t.getTime()),t}var ke=1e3,Te=6e4,De=36e5,Ae=24*De,Ie=31*Ae,Ye=365*Ae,Oe=[["HH:mm:ss",ke],["HH:mm:ss",1e4],["HH:mm:ss",3e4],["HH:mm",Te],["HH:mm",6e5],["HH:mm",18e5],["HH",De],["HH",6*De],["HH",12*De],["YYYY-MM-DD",Ae],["YYYY-MM-DD",4*Ae],["YYYY-WW",7*Ae],["YYYY-MM",Ie],["YYYY-MM",4*Ie],["YYYY-MM",6*Ie],["YYYY",380*Ae]];function Ne(t,e,r){var i,a=(i=function(t){return t[1]},function(t,e,r,a){for(var n=d(r)?0:r,s=d(a)?t.length:a;n<s;){var o=n+s>>>1;i(t[o])>e?s=o:n=o+1}return n})(Oe,(e-t)/r)-1,n=Oe[a];return a<0?n=Oe[0]:a>=Oe.length&&(n=b(Oe)),n}var je=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="timeCat",e}return a(e,t),e.prototype.translate=function(t){t=Ce(t);var e=this.values.indexOf(t);return-1===e&&(e=w(t)&&t<this.values.length?t:NaN),e},e.prototype.getText=function(t,e){var r=this.translate(t);if(r>-1){var i=this.values[r],a=this.formatter;return i=a?a(i,e):Pe(i,this.mask)}return t},e.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},e.prototype.setDomain=function(){var e=this.values;m(e,(function(t,r){e[r]=Ce(t)})),e.sort((function(t,e){return t-e})),t.prototype.setDomain.call(this)},e}(Zt),Ee=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isContinuous=!0,e}return a(e,t),e.prototype.scale=function(t){if(d(t))return NaN;var e=this.rangeMin(),r=this.rangeMax();return this.max===this.min?e:e+this.getScalePercent(t)*(r-e)},e.prototype.init=function(){t.prototype.init.call(this);var e=this.ticks,r=S(e),i=b(e);r<this.min&&(this.min=r),i>this.max&&(this.max=i),d(this.minLimit)||(this.min=r),d(this.maxLimit)||(this.max=i)},e.prototype.setDomain=function(){var t=x(this.values),e=t.min,r=t.max;d(this.min)&&(this.min=e),d(this.max)&&(this.max=r),this.min>this.max&&(this.min=e,this.max=r)},e.prototype.calculateTicks=function(){var e=this,r=t.prototype.calculateTicks.call(this);return this.nice||(r=c(r,(function(t){return t>=e.min&&t<=e.max}))),r},e.prototype.getScalePercent=function(t){var e=this.max,r=this.min;return(t-r)/(e-r)},e.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},e}(qt),Fe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="linear",e.isLinear=!0,e}return a(e,t),e.prototype.invert=function(t){var e=this.getInvertPercent(t);return this.min+e*(this.max-this.min)},e.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},e}(Ee);function ze(t,e){var r=Math.E;return e>=0?Math.pow(r,Math.log(e)/t):-1*Math.pow(r,Math.log(-e)/t)}function Le(t,e){return 1===t?1:Math.log(e)/Math.log(t)}function Be(t,e,r){d(r)&&(r=Math.max.apply(null,t));var i=r;return m(t,(function(t){t>0&&t<i&&(i=t)})),i===r&&(i=r/e),i>1&&(i=1),i}var Xe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="log",e}return a(e,t),e.prototype.invert=function(t){var e,r=this.base,i=Le(r,this.max),a=this.rangeMin(),n=this.rangeMax()-a,s=this.positiveMin;if(s){if(0===t)return 0;var o=1/(i-(e=Le(r,s/r)))*n;if(t<o)return t/o*s}else e=Le(r,this.min);var l=(t-a)/n*(i-e)+e;return Math.pow(r,l)},e.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},e.prototype.setDomain=function(){t.prototype.setDomain.call(this);var e=this.min;if(e<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");0===e&&(this.positiveMin=Be(this.values,this.base,this.max))},e.prototype.getScalePercent=function(t){var e=this.max,r=this.min;if(e===r)return 0;if(t<=0)return 0;var i=this.base,a=this.positiveMin;return a&&(r=1*a/i),t<a?t/a/(Le(i,e)-Le(i,r)):(Le(i,t)-Le(i,r))/(Le(i,e)-Le(i,r))},e}(Ee),Re=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="pow",e}return a(e,t),e.prototype.invert=function(t){var e=this.getInvertPercent(t),r=this.exponent,i=ze(r,this.max),a=ze(r,this.min),n=e*(i-a)+a,s=n>=0?1:-1;return Math.pow(n,r)*s},e.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},e.prototype.getScalePercent=function(t){var e=this.max,r=this.min;if(e===r)return 0;var i=this.exponent;return(ze(i,t)-ze(i,r))/(ze(i,e)-ze(i,r))},e}(Ee),Ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="time",e}return a(e,t),e.prototype.getText=function(t,e){var r=this.translate(t),i=this.formatter;return i?i(r,e):Pe(r,this.mask)},e.prototype.scale=function(e){var r=e;return(_(r)||A(r))&&(r=this.translate(r)),t.prototype.scale.call(this,r)},e.prototype.translate=function(t){return Ce(t)},e.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},e.prototype.setDomain=function(){var t=this.values,e=this.getConfig("min"),r=this.getConfig("max");if(d(e)&&w(e)||(this.min=this.translate(this.min)),d(r)&&w(r)||(this.max=this.translate(this.max)),t&&t.length){var i=[],a=1/0,n=a,s=0;m(t,(function(t){var e=Ce(t);if(isNaN(e))throw new TypeError("Invalid Time: "+t+" in time scale!");a>e?(n=a,a=e):n>e&&(n=e),s<e&&(s=e),i.push(e)})),t.length>1&&(this.minTickInterval=n-a),d(e)&&(this.min=a),d(r)&&(this.max=s)}},e}(Fe),He=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="quantize",e}return a(e,t),e.prototype.invert=function(t){var e=this.ticks,r=e.length,i=this.getInvertPercent(t),a=Math.floor(i*(r-1));if(a>=r-1)return b(e);if(a<0)return S(e);var n=e[a],s=a/(r-1);return n+(i-s)/((a+1)/(r-1)-s)*(e[a+1]-n)},e.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},e.prototype.calculateTicks=function(){var e=t.prototype.calculateTicks.call(this);return this.nice||(b(e)!==this.max&&e.push(this.max),S(e)!==this.min&&e.unshift(this.min)),e},e.prototype.getScalePercent=function(t){var e=this.ticks;if(t<S(e))return 0;if(t>b(e))return 1;var r=0;return m(e,(function(e,i){if(!(t>=e))return!1;r=i})),r/(e.length-1)},e}(Ee),We=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="quantile",e}return a(e,t),e.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},e}(He),Ve={};function qe(t){return Ve[t]}function Ze(t,e){if(qe(t))throw new Error("type '"+t+"' existed.");Ve[t]=e}var Ue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="identity",e.isIdentity=!0,e}return a(e,t),e.prototype.calculateTicks=function(){return this.values},e.prototype.scale=function(t){return this.values[0]!==t&&w(t)?t:this.range[0]},e.prototype.invert=function(t){var e=this.range;return t<e[0]||t>e[1]?NaN:this.values[0]},e}(qt);function Je(t){var e=t.values,r=t.tickInterval,i=t.tickCount,a=t.showLast;if(w(r)){var n=c(e,(function(t,e){return e%r==0})),s=b(e);return a&&b(n)!==s&&n.push(s),n}var o=e.length,l=t.min,h=t.max;if(d(l)&&(l=0),d(h)&&(h=e.length-1),!w(i)||i>=o)return e.slice(l,h+1);if(i<=0||h<=0)return[];for(var u=1===i?o:Math.floor(o/(i-1)),f=[],g=l,p=0;p<i&&!(g>=h);p++)g=Math.min(l+p*u,h),p===i-1&&a?f.push(e[h]):f.push(e[g]);return f}var $e=Math.sqrt(50),Ke=Math.sqrt(10),Qe=Math.sqrt(2),tr=function(){function t(){this._domain=[0,1]}return t.prototype.domain=function(t){return t?(this._domain=Array.from(t,Number),this):this._domain.slice()},t.prototype.nice=function(t){var e,r;void 0===t&&(t=5);var i,a=this._domain.slice(),n=0,s=this._domain.length-1,o=this._domain[n],l=this._domain[s];return l<o&&(o=(e=[l,o])[0],l=e[1],n=(r=[s,n])[0],s=r[1]),(i=er(o,l,t))>0?i=er(o=Math.floor(o/i)*i,l=Math.ceil(l/i)*i,t):i<0&&(i=er(o=Math.ceil(o*i)/i,l=Math.floor(l*i)/i,t)),i>0?(a[n]=Math.floor(o/i)*i,a[s]=Math.ceil(l/i)*i,this.domain(a)):i<0&&(a[n]=Math.ceil(o*i)/i,a[s]=Math.floor(l*i)/i,this.domain(a)),this},t.prototype.ticks=function(t){return void 0===t&&(t=5),function(t,e,r){var i,a,n,s,o=-1;if(r=+r,(t=+t)===(e=+e)&&r>0)return[t];(i=e<t)&&(a=t,t=e,e=a);if(0===(s=er(t,e,r))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),n=new Array(a=Math.ceil(e-t+1));++o<a;)n[o]=(t+o)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),n=new Array(a=Math.ceil(t-e+1));++o<a;)n[o]=(t-o)/s;i&&n.reverse();return n}(this._domain[0],this._domain[this._domain.length-1],t||5)},t}();function er(t,e,r){var i=(e-t)/Math.max(0,r),a=Math.floor(Math.log(i)/Math.LN10),n=i/Math.pow(10,a);return a>=0?(n>=$e?10:n>=Ke?5:n>=Qe?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(n>=$e?10:n>=Ke?5:n>=Qe?2:1)}function rr(t,e,r){return("ceil"===r?Math.ceil(t/e):"floor"===r?Math.floor(t/e):Math.round(t/e))*e}function ir(t,e,r){var i=rr(t,r,"floor"),a=rr(e,r,"ceil");i=M(i,r),a=M(a,r);for(var n=[],s=Math.max((a-i)/(Math.pow(2,12)-1),r),o=i;o<=a;o+=s){var l=M(o,s);n.push(l)}return{min:i,max:a,ticks:n}}function ar(t,e,r){var i,a=t.minLimit,n=t.maxLimit,s=t.min,o=t.max,l=t.tickCount,h=void 0===l?5:l,c=d(a)?d(e)?s:e:a,u=d(n)?d(r)?o:r:n;if(c>u&&(u=(i=[c,u])[0],c=i[1]),h<=2)return[c,u];for(var f=(u-c)/(h-1),g=[],p=0;p<h;p++)g.push(c+f*p);return g}function nr(t){return Math.abs(t)<1e-15?t:parseFloat(t.toFixed(15))}var sr=[1,5,2,2.5,4,3],or=100*Number.EPSILON;function lr(t,e,r,i,a,n){var s=B(e),o=E(e,t),l=0,h=function(t,e){return(t%e+e)%e}(i,n);return(h<or||n-h<or)&&i<=0&&a>=0&&(l=1),1-o/(s-1)-r+l}function hr(t,e,r){var i=B(e);return 1-E(e,t)/(i-1)-r+1}function cr(t,e,r,i,a,n){var s=(t-1)/(n-a),o=(e-1)/(Math.max(n,i)-Math.min(r,a));return 2-Math.max(s/o,o/s)}function ur(t,e){return t>=e?2-(t-1)/(e-1):1}function fr(t,e,r,i){var a=e-t;return 1-.5*(Math.pow(e-i,2)+Math.pow(t-r,2))/Math.pow(.1*a,2)}function gr(t,e,r){var i=e-t;if(r>i){var a=(r-i)/2;return 1-Math.pow(a,2)/Math.pow(.1*i,2)}return 1}function dr(t,e,r,i,a,n){void 0===r&&(r=5),void 0===i&&(i=!0),void 0===a&&(a=sr),void 0===n&&(n=[.25,.2,.5,.05]);var s=r<0?0:Math.round(r);if(Number.isNaN(t)||Number.isNaN(e)||"number"!=typeof t||"number"!=typeof e||!s)return{min:0,max:0,ticks:[]};if(e-t<1e-15||1===s)return{min:t,max:e,ticks:[t]};if(e-t>1e148){var o=(e-t)/(M=r||5);return{min:t,max:e,ticks:Array(M).fill(null).map((function(e,r){return nr(t+o*r)}))}}for(var l={score:-2,lmin:0,lmax:0,lstep:0},h=1;h<1/0;){for(var c=0;c<a.length;c+=1){var u=a[c],f=hr(u,a,h);if(n[0]*f+n[1]+n[2]+n[3]<l.score){h=1/0;break}for(var g=2;g<1/0;){var d=ur(g,s);if(n[0]*f+n[1]+n[2]*d+n[3]<l.score)break;for(var p=(e-t)/(g+1)/h/u,v=Math.ceil(Math.log10(p));v<1/0;){var m=h*u*Math.pow(10,v),y=gr(t,e,m*(g-1));if(n[0]*f+n[1]*y+n[2]*d+n[3]<l.score)break;var x=Math.floor(e/m)*h-(g-1)*h,_=Math.ceil(t/m)*h;if(x<=_)for(var M=_-x,w=0;w<=M;w+=1){var P=(x+w)*(m/h),C=P+m*(g-1),k=m,T=lr(u,a,h,P,C,k),D=fr(t,e,P,C),A=cr(g,s,t,e,P,C),I=n[0]*T+n[1]*D+n[2]*A+1*n[3];I>l.score&&(!i||P<=t&&C>=e)&&(l.lmin=P,l.lmax=C,l.lstep=k,l.score=I)}v+=1}g+=1}}h+=1}var Y=nr(l.lmax),O=nr(l.lmin),N=nr(l.lstep),j=Math.floor(function(t){return Math.round(1e12*t)/1e12}((Y-O)/N))+1,E=new Array(j);E[0]=nr(O);for(c=1;c<j;c++)E[c]=nr(E[c-1]+N);return{min:Math.min(t,S(E)),max:Math.max(e,b(E)),ticks:E}}function pr(t,e,r){if(void 0===r&&(r=5),t===e)return{max:e,min:t,ticks:[t]};var i=r<0?0:Math.round(r);if(0===i)return{max:e,min:t,ticks:[]};var a=(e-t)/i,n=Math.pow(10,Math.floor(Math.log10(a))),s=n;2*n-a<1.5*(a-s)&&5*n-a<2.75*(a-(s=2*n))&&10*n-a<1.5*(a-(s=5*n))&&(s=10*n);for(var o=Math.ceil(e/s),l=Math.floor(t/s),h=Math.max(o*s,e),c=Math.min(l*s,t),u=Math.floor((h-c)/s)+1,f=new Array(u),g=0;g<u;g++)f[g]=nr(c+g*s);return{min:c,max:h,ticks:f}}function vr(t,e){var r=t.length*e;return 1===e?t[t.length-1]:0===e?t[0]:r%1!=0?t[Math.ceil(r)-1]:t.length%2==0?(t[r-1]+t[r])/2:t[r]}function mr(t){return new Date(t).getFullYear()}function yr(t){return new Date(t,0,1).getTime()}function xr(t){return new Date(t).getMonth()}function _r(t,e){return new Date(t,e,1).getTime()}Vt("cat",Je),Vt("time-cat",(function(t){return Je(n({showLast:!0},t))})),Vt("wilkinson-extended",(function(t){var e=t.min,r=t.max,i=t.tickCount,a=t.nice,n=t.tickInterval,s=t.minLimit,o=t.maxLimit,l=dr(e,r,i,a).ticks;return d(s)&&d(o)?n?ir(e,r,n).ticks:l:ar(t,S(l),b(l))})),Vt("r-pretty",(function(t){var e=t.min,r=t.max,i=t.tickCount,a=t.tickInterval,n=t.minLimit,s=t.maxLimit,o=pr(e,r,i).ticks;return d(n)&&d(s)?a?ir(e,r,a).ticks:o:ar(t,S(o),b(o))})),Vt("time",(function(t){var e=t.min,r=t.max,i=t.minTickInterval,a=t.tickInterval,n=t.tickCount;if(a)n=Math.ceil((r-e)/a);else{var s=(r-e)/(a=Ne(e,r,n)[1])/n;s>1&&(a*=Math.ceil(s)),i&&a<i&&(a=i)}a=Math.max(Math.floor((r-e)/(Math.pow(2,12)-1)),a);for(var o=[],l=e;l<r+a;l+=a)o.push(l);return o})),Vt("time-pretty",(function(t){var e=t.min,r=t.max,i=t.minTickInterval,a=t.tickCount,n=t.tickInterval,s=[];n||(n=(r-e)/a,i&&n<i&&(n=i)),n=Math.max(Math.floor((r-e)/(Math.pow(2,12)-1)),n);var o=mr(e);if(n>Ye)for(var l=mr(r),h=Math.ceil(n/Ye),c=o;c<=l+h;c+=h)s.push(yr(c));else if(n>Ie){var u=Math.ceil(n/Ie),f=xr(e),g=function(t,e){var r=mr(t),i=mr(e),a=xr(t);return 12*(i-r)+(xr(e)-a)%12}(e,r);for(c=0;c<=g+u;c+=u)s.push(_r(o,c+f))}else if(n>Ae){var d=(x=new Date(e)).getFullYear(),p=x.getMonth(),v=x.getDate(),m=Math.ceil(n/Ae),y=function(t,e){return Math.ceil((e-t)/Ae)}(e,r);for(c=0;c<y+m;c+=m)s.push(new Date(d,p,v+c).getTime())}else if(n>De){d=(x=new Date(e)).getFullYear(),p=x.getMonth(),m=x.getDate();var x,_=x.getHours(),S=Math.ceil(n/De),b=function(t,e){return Math.ceil((e-t)/De)}(e,r);for(c=0;c<=b+S;c+=S)s.push(new Date(d,p,m,_+c).getTime())}else if(n>Te){var M=function(t,e){return Math.ceil((e-t)/6e4)}(e,r),w=Math.ceil(n/Te);for(c=0;c<=M+w;c+=w)s.push(e+c*Te)}else{var P=n;P<ke&&(P=ke);var C=Math.floor(e/ke)*ke,k=Math.ceil((r-e)/ke),T=Math.ceil(P/ke);for(c=0;c<k+T;c+=T)s.push(C+c*ke)}return s.length,s})),Vt("log",(function(t){var e,r=t.base,i=t.tickCount,a=t.min,n=t.max,s=t.values,o=Le(r,n);if(a>0)e=Math.floor(Le(r,a));else{var l=Be(s,r,n);e=Math.floor(Le(r,l))}for(var h=o-e,c=Math.ceil(h/i),u=[],f=e;f<o+c;f+=c)u.push(Math.pow(r,f));return a<=0&&u.unshift(0),u})),Vt("pow",(function(t){var e=t.exponent,r=t.tickCount,i=Math.ceil(ze(e,t.max));return pr(Math.floor(ze(e,t.min)),i,r).ticks.map((function(t){var r=t>=0?1:-1;return Math.pow(t,e)*r}))})),Vt("quantile",(function(t){var e=t.tickCount,r=t.values;if(!r||!r.length)return[];for(var i=r.slice().sort((function(t,e){return t-e})),a=[],n=0;n<e;n++){var s=n/(e-1);a.push(vr(i,s))}return a})),Vt("d3-linear",(function(t){var e=t.min,r=t.max,i=t.tickInterval,a=t.minLimit,n=t.maxLimit,s=function(t){var e=t.min,r=t.max,i=t.nice,a=t.tickCount,n=new tr;return n.domain([e,r]),i&&n.nice(a),n.ticks(a)}(t);return d(a)&&d(n)?i?ir(e,r,i).ticks:s:ar(t,S(s),b(s))})),Ze("cat",Zt),Ze("category",Zt),Ze("identity",Ue),Ze("linear",Fe),Ze("log",Xe),Ze("pow",Re),Ze("time",Ge),Ze("timeCat",je),Ze("quantize",He),Ze("quantile",We);const Sr=function(t){var{values:e,tickCount:r}=t;if(!r)return e;if(e.length<=1)return e;for(var i=parseInt(e.length/(r-1))||1,a=[],n=0;n<e.length;n+=i)a.push(e[n]);var s=e[e.length-1];return a[a.length-1]!==s&&(a.length>=r?a[a.length-1]=s:a.push(s)),a};var br=[1,1.2,1.5,2,2.2,2.4,2.5,3,4,5,6,7.5,8,10];var Mr=12;function wr(t){var e=1;if(0===(t=Math.abs(t)))return e;if(t<1){for(var r=0;t<1;)e/=10,t*=10,r++;return e.toString().length>Mr&&(e=parseFloat(e.toFixed(r))),e}for(;t>10;)e*=10,t/=10;return e}function Pr(t,e,r,i){for(var a=!1,n=br[t],s=t;s<br.length;s++)if(Cr({interval:br[s],tickCount:e,max:i,min:r})){n=br[s],a=!0;break}return a?n:10*Pr(0,e,r/10,i/10)}function Cr(t){var{interval:e,tickCount:r,max:i,min:a}=t;return Math.floor(a/e)*e+(r-1)*e>=i}function kr(t){var e=t.toString(),r=e.indexOf("."),i=e.indexOf("e-"),a=i>=0?parseInt(e.substr(i+2),10):e.substr(r+1).length;return a>20&&(a=20),a}function Tr(t,e){return parseFloat(t.toFixed(e))}var Dr=qe("linear"),Ar=qe("identity"),Ir=qe("category"),Yr=qe("timeCat");function Or(t){Object.keys(t).forEach((function(e){delete t[e]}))}Vt("cat",Sr),Vt("time-cat",Sr),Vt("wilkinson-extended",(function(t){var{tickCount:e,tickInterval:r}=t||{},{min:i,max:a}=t||{};i=isNaN(i)?0:i,a=isNaN(a)?0:a;var n=e&&e>=2?e:5,s=r||function(t){var{tickCount:e,min:r,max:i}=t;if(r===i)return 1*wr(i);for(var a=(i-r)/(e-1),n=wr(a),s=a/n,o=i/n,l=r/n,h=0,c=0;c<br.length;c++){if(s<=br[c]){h=c;break}}var u=r<0&&i>0&&2===e?br[h]:Pr(h,e,l,o),f=kr(u)+kr(n);return Tr(u*n,f)}({tickCount:n,max:a,min:i}),o=Math.floor(i/s)*s;if(r){var l=Math.abs(Math.ceil((a-o)/r))+1;n=Math.max(n,l)}var h=[],c=0,u=kr(s);if(i<0&&a>0&&2===n)return[Tr(o,u),Tr(Math.ceil(a/s)*s,u)];for(;c<n;)h.push(Tr(o+c*s,u)),c++;return h})),qt.Linear=Dr,qt.Identity=Ar,qt.Category=Ir,qt.Cat=Ir,qt.TimeCat=Yr;class Nr{constructor(t){this.defs={},this.scales={},O(this,t)}setFieldDef(t,e){var{defs:r}=this;v(t)?O(r,t):r[t]=e,this.updateScales()}_getDef(t){var e=this.defs,r=null;return(st.scales[t]||e[t])&&(r=O({},st.scales[t]),m(e[t],(function(t,e){d(t)?delete r[e]:r[e]=t}))),r}_getDefaultType(t,e,r){if(r&&r.type)return r.type;var i="linear",a=X(e,t);return p(a)&&(a=a[0]),_(a)&&(i="cat"),i}_getScaleDef(t,e,r,i){var a;a=i&&i.values?i.values:function(t,e){for(var r=[],i={},a=0,n=t.length;a<n;a++){var s=t[a][e];d(s)||(p(s)?m(s,(function(t){i[t]||(r.push(t),i[t]=!0)})):i[s]||(r.push(s),i[s]=!0))}return r}(r,e);var n={field:e,values:a};if("cat"!==t&&"timeCat"!==t){if(!i||!i.min||!i.max){var{min:s,max:o}=G(a);n.min=s,n.max=o,n.nice=!0}}else n.isRounding=!1;return n}_adjustRange(t,e){var{range:r,values:i}=e;if("linear"===t||r||!i)return e;var a=i.length;if(1===a)e.range=[.5,1];else{var{chart:n}=this,s=n.get("coord"),o=st.widthRatio.multiplePie,l=0;!function(t){if(!t.isPolar)return!1;var e=t.startAngle,r=t.endAngle;return!(!d(e)&&!d(r)&&r-e<2*Math.PI)}(s)?(l=1/a*.5,e.range=[l,1-l]):s.transposed?(l=1/a*o,e.range=[l/2,1-l/2]):e.range=[0,1-1/a]}return e}_getScaleCfg(t,e){var r=this,i=r._getDef(t);if(!e||!e.length)return i&&i.type?(i.field=t,{type:i.type,cfg:i}):{type:"identity",cfg:{value:t,field:t.toString(),values:[t]}};var a=e[0][t];if(null===a&&(a=X(e,t)),w(t)||d(a)&&!i)return{type:"identity",cfg:{value:t,field:t.toString(),values:[t]}};var n=r._getDefaultType(t,e,i),s=r._getScaleDef(n,t,e,i);return i&&O(s,i),{type:n,cfg:s=this._adjustRange(n,s)}}createScale(t,e){var{scales:r}=this,{type:i,cfg:a}=this._getScaleCfg(t,e),n=r[t];if(n&&n.type===i)return n.change(a),n;var s=new(qe(i))(a);return r[t]=s,s}_updateScale(t){var{field:e}=t,r=this.chart._getScaleData(e),{cfg:i}=this._getScaleCfg(e,r);t.change(i)}updateScales(){var t=this,{scales:e}=this;m(e,(function(e){t._updateScale(e)}))}adjustStartZero(t){var{defs:e}=this,{field:r,min:i,max:a}=t;e[r]&&e[r].min||(i>0?t.change({min:0}):a<0&&t.change({max:0}))}clear(){Or(this.defs),Or(this.scales),this.data=null}}class jr{_initDefaultCfg(){this.ticks=[],this.tickLine={},this.offsetFactor=1,this.frontContainer=null,this.backContainer=null,this.gridPoints=[]}constructor(t){this._initDefaultCfg(),O(this,t),this.draw()}draw(){var{line:t,tickLine:e,label:r,grid:i}=this;i&&this.drawGrid(i),e&&this.drawTicks(e),t&&this.drawLine(t),r&&this.drawLabels()}drawTicks(t){var e=this,r=e.ticks,i=t.length,a=e.getContainer(t.top);m(r,(function(r){var n=e.getOffsetPoint(r.value),s=e.getSidePoint(n,i);a.addShape("line",{className:"axis-tick",attrs:O({x1:n.x,y1:n.y,x2:s.x,y2:s.y},t)})._id=e._id+"-ticks"}))}drawLabels(){var t=this,e=t.labelOffset;m(t.labels,(function(r){var i=t.getContainer(r.get("top")),a=t.getOffsetPoint(r.get("value")),{x:n,y:s}=t.getSidePoint(a,e);r.attr(O({x:n,y:s},t.getTextAlignInfo(a,e),r.get("textStyle"))),r._id=t._id+"-"+r.attr("text"),i.add(r)}))}drawLine(){}drawGrid(t){var e=this,{gridPoints:r,ticks:i}=e,a=t,n=r.length;m(r,(function(r,s){if(g(t)){var o=i[s]||{},l=t(o.text,s,n);a=l?O({},st._defaultAxis.grid,l):null}if(a){var h,c=a.type,u=r.points,f=e.getContainer(a.top);if("arc"===c){var{center:d,startAngle:p,endAngle:v}=e,m=dt.length([u[0].x-d.x,u[0].y-d.y]);h=f.addShape("Arc",{className:"axis-grid",attrs:O({x:d.x,y:d.y,startAngle:p,endAngle:v,r:m},a)})}else h=f.addShape("Polyline",{className:"axis-grid",attrs:O({points:u},a)});h._id=r._id}}))}getOffsetPoint(){}getAxisVector(){}getOffsetVector(t,e){var r=this.getAxisVector(t),i=dt.normalize([],r),a=this.offsetFactor,n=[-1*i[1]*a,i[0]*a];return dt.scale([],n,e)}getSidePoint(t,e){var r=this.getOffsetVector(t,e);return{x:t.x+r[0],y:t.y+r[1]}}getTextAlignInfo(t,e){var r=this.getOffsetVector(t,e);return{textAlign:r[0]>0?"left":r[0]<0?"right":"center",textBaseline:r[1]>0?"top":r[1]<0?"bottom":"middle"}}getContainer(t){var{frontContainer:e,backContainer:r}=this;return t?e:r}}jr.Line=class extends jr{_initDefaultCfg(){super._initDefaultCfg(),this.start=null,this.end=null}getOffsetPoint(t){var{start:e,end:r}=this;return{x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t}}getAxisVector(){var{start:t,end:e}=this;return[e.x-t.x,e.y-t.y]}drawLine(t){var e=this.getContainer(t.top),{start:r,end:i}=this;e.addShape("line",{className:"axis-line",attrs:O({x1:r.x,y1:r.y,x2:i.x,y2:i.y},t)})}};class Er{constructor(t){this.axisCfg={},this.frontPlot=null,this.backPlot=null,this.axes={},O(this,t)}_isHide(t){var e=this.axisCfg;return!e||!1===e[t]}_getLinePosition(t,e,r,i){var a="",n=t.field,s=this.axisCfg;return s[n]&&s[n].position?a=s[n].position:"x"===e?a=i?"left":"bottom":"y"===e&&(a=r?"right":"left",i&&(a="bottom")),a}_getLineCfg(t,e,r){var i,a,n=1;return"x"===e?(i={x:0,y:0},a={x:1,y:0}):"right"===r?(i={x:1,y:0},a={x:1,y:1}):(i={x:0,y:0},a={x:0,y:1},n=-1),t.transposed&&(n*=-1),{offsetFactor:n,start:t.convertPoint(i),end:t.convertPoint(a)}}_getCircleCfg(t){return{startAngle:t.startAngle,endAngle:t.endAngle,center:t.center,radius:t.circleRadius}}_getRadiusCfg(t){var e,r;return t.transposed?(e={x:0,y:0},r={x:1,y:0}):(e={x:0,y:0},r={x:0,y:1}),{offsetFactor:-1,start:t.convertPoint(e),end:t.convertPoint(r)}}_getAxisCfg(t,e,r,i,a){var n=this,s=this,o=this.axisCfg,l=e.getTicks(),h=j({ticks:l,frontContainer:this.frontPlot,backContainer:this.backPlot},a,o[e.field]),c=[],u=h.label,f=l.length,d=0,p=0,v=u;return m(l,(function(t,e){if(g(u)){var r=u(t.text,e,f);v=r?O({},st._defaultAxis.label,r):null}if(v){var i={};v.textAlign&&(i.textAlign=v.textAlign),v.textBaseline&&(i.textBaseline=v.textBaseline);var a=(v.top?n.frontPlot:n.backPlot).addShape("text",{className:"axis-label",aria:!1,attrs:O({x:0,y:0,text:t.text,fontFamily:s.chart.get("canvas").get("fontFamily")},v),value:t.value,textStyle:i,top:v.top,context:s.chart.get("canvas").get("context")});c.push(a);var{width:o,height:l}=a.getBBox();d=Math.max(d,o),p=Math.max(p,l)}})),h.labels=c,h.maxWidth=d,h.maxHeight=p,h}_createAxis(t,e,r,i){var a,n,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=t.type,h=t.transposed;if("cartesian"===l||"rect"===l){var c=this._getLinePosition(e,i,o,h);(s=st.axis[c]).position=c,a="Line",n=c}else"x"===i&&!h||"y"===i&&h?(s=st.axis.circle,a="Circle",n="circle"):(s=st.axis.radius,a="Line",n="radius");var u=this._getAxisCfg(t,e,r,i,s);u.type=a,u.dimType=i,u.verticalScale=r,u.index=o,this.axes[n]=u}createAxis(t,e,r){var i=this;e&&!i._isHide(e.field)&&i._createAxis(t,e,r[0],"x"),m(r,(function(r,a){i._isHide(r.field)||i._createAxis(t,r,e,"y",a)}));var a=this.axes,n=i.chart;if(n._isAutoPadding()){var s=Q(n.get("padding")),o=Q(n.get("appendPadding")),l=n.get("legendRange")||{top:0,right:0,bottom:0,left:0},h=["auto"===s[0]?l.top+2*o[0]:s[0],"auto"===s[1]?l.right+o[1]:s[1],"auto"===s[2]?l.bottom+o[2]:s[2],"auto"===s[3]?l.left+o[3]:s[3]];if(t.isPolar){var c=a.circle;if(c){var{maxHeight:u,maxWidth:f,labelOffset:g}=c;h[0]+=u+g,h[1]+=f+g,h[2]+=u+g,h[3]+=f+g}}else{if(a.right&&"auto"===s[1]){var{maxWidth:p,labelOffset:v}=a.right;h[1]+=p+v}if(a.left&&"auto"===s[3]){var{maxWidth:y,labelOffset:x}=a.left;h[3]+=y+x}if(a.bottom&&"auto"===s[2]){var{maxHeight:_,labelOffset:S}=a.bottom;h[2]+=_+S}}n.set("_padding",h),n._updateLayout(h)}m(a,(function(e){var r,{type:a,grid:n,verticalScale:s,ticks:o,dimType:l,position:h,index:c}=e;if(t.isPolar?"Line"===a?r=i._getRadiusCfg(t):"Circle"===a&&(r=i._getCircleCfg(t)):r=i._getLineCfg(t,l,h),n&&s){var u=[],f=function(t){var e=t.slice(0);if(e.length>0){var r=e[0],i=e[e.length-1];0!==r.value&&e.unshift({value:0}),1!==i.value&&e.push({value:1})}return e}(s.getTicks());m(o,(function(e){var r=[];m(f,(function(i){var a="x"===l?e.value:i.value,n="x"===l?i.value:e.value;if(a>=0&&a<=1&&n>=0&&n<=1){var s=t.convertPoint({x:a,y:n});r.push(s)}})),u.push({points:r,_id:"axis-"+l+c+"-grid-"+e.tickValue})})),e.gridPoints=u,t.isPolar&&(e.center=t.center,e.startAngle=t.startAngle,e.endAngle=t.endAngle)}r._id="axis-"+l,d(c)||(r._id="axis-"+l+c),new jr[a](O(e,r))}))}clear(){this.axes={},this.frontPlot.clear(),this.backPlot.clear()}}function Fr(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var zr=function(t,e){var r=e.x-t.x,i=e.y-t.y;return Math.abs(r)>Math.abs(i)?r>0?"right":"left":i>0?"down":"up"},Lr=function(t,e){var r=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return Math.sqrt(r*r+i*i)};class Br{constructor(t){var e=this,{canvas:r,el:i}=t;Fr(this,"_click",(function(t){var r=J(t,e.canvas);t.points=r,e.emitEvent("click",t)})),Fr(this,"_start",(function(t){var r,i,a=J(t,e.canvas);a&&(t.points=a,e.emitEvent("touchstart",t),e.reset(),e.startTime=Date.now(),e.startPoints=a,a.length>1?(e.startDistance=Lr(a[0],a[1]),e.center=(r=a[0],i=a[1],{x:r.x+(i.x-r.x)/2,y:r.y+(i.y-r.y)/2})):e.pressTimeout=setTimeout((function(){var r="press",i="none";t.direction=i,e.emitStart(r,t),e.emitEvent(r,t),e.eventType=r,e.direction=i}),250))})),Fr(this,"_move",(function(t){var r=J(t,e.canvas);if(r){e.clearPressTimeout(),t.points=r,e.emitEvent("touchmove",t);var i=e.startPoints;if(i)if(r.length>1){var a=e.startDistance,n=Lr(r[0],r[1]);t.zoom=n/a,t.center=e.center,e.emitStart("pinch",t),e.emitEvent("pinch",t)}else{var s=r[0].x-i[0].x,o=r[0].y-i[0].y,l=e.direction||zr(i[0],r[0]);e.direction=l;var h=e.getEventType(r);t.direction=l,t.deltaX=s,t.deltaY=o,e.emitStart(h,t),e.emitEvent(h,t);var c=e.lastMoveTime,u=Date.now();u-c>0&&(e.prevMoveTime=c,e.prevMovePoints=e.lastMovePoints,e.lastMoveTime=u,e.lastMovePoints=r)}}})),Fr(this,"_end",(function(t){var r=J(t,e.canvas);t.points=r,e.emitEnd(t),e.emitEvent("touchend",t);var i=e.lastMoveTime;if(Date.now()-i<100){var a=i-(e.prevMoveTime||e.startTime);if(a>0){var n=e.prevMovePoints||e.startPoints,s=e.lastMovePoints,o=Lr(n[0],s[0])/a;o>.3&&(t.velocity=o,t.direction=zr(n[0],s[0]),e.emitEvent("swipe",t))}}e.reset();var l=t.touches;l&&l.length>0&&e._start(t)})),Fr(this,"_cancel",(function(t){e.emitEvent("touchcancel",t),e.reset()})),this.canvas=r,this.delegateEvent(i),this.processEvent={}}delegateEvent(t){t.addEventListener("click",this._click),t.addEventListener("touchstart",this._start),t.addEventListener("touchmove",this._move),t.addEventListener("touchend",this._end),t.addEventListener("touchcancel",this._cancel)}emitEvent(t,e){this.canvas.emit(t,e)}getEventType(t){var e,{eventType:r,canvas:i,startTime:a,startPoints:n}=this;if(r)return r;var s=i.__events.pan;s&&s.length?e=Date.now()-a>250&&Lr(n[0],t[0])<10?"press":"pan":e="press";return this.eventType=e,e}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}emitStart(t,e){this.isProcess(t)||(this.enable(t),this.emitEvent("".concat(t,"start"),e))}emitEnd(t){var e=this,r=this.processEvent;Object.keys(r).forEach((function(i){e.emitEvent("".concat(i,"end"),t),delete r[i]}))}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=0)}reset(){this.clearPressTimeout(),this.startTime=0,this.startPoints=null,this.startDistance=0,this.direction=null,this.eventType=null,this.pinch=!1,this.prevMoveTime=0,this.prevMovePoints=null,this.lastMoveTime=0,this.lastMovePoints=null}}class Xr extends ct{constructor(t){super(),this.context=t,this.width=0,this.height=0,this.style={},this.currentStyle={},this.attrs={},this.isCanvasElement=!0}getContext(){return this.context}getBoundingClientRect(){return{top:0,right:this.width,bottom:this.height,left:0}}setAttribute(t,e){this.attrs[t]=e}addEventListener(t,e){this.on(t,e)}removeEventListener(t,e){this.off(t,e)}dispatchEvent(t,e){this.emit(t,e)}}const Rr={create:t=>t?function(t){if(!t)return!1;if(1!==t.nodeType||!t.nodeName||"canvas"!==t.nodeName.toLowerCase())return!1;var e=!1;try{t.addEventListener("eventTest",(function(){e=!0})),t.dispatchEvent(new Event("eventTest"))}catch(r){e=!1}return e}(t.canvas)?t.canvas:new Xr(t):null};function Gr(t,e){m(t,(function(t){t=t.split(":"),e.addColorStop(Number(t[0]),t[1])}))}function Hr(t,e,r){if("("===t[1])try{var i=t[0];if("l"===i)return function(t,e,r){var i,a,n=t.split(" "),s=n[0].slice(2,n[0].length-1);i=parseFloat(s)*Math.PI/180,a=2*Math.PI,s=(i%a+a)%a;var o,l,h=n.slice(1),{minX:c,minY:u,maxX:f,maxY:g}=e.getBBox();s>=0&&s<.5*Math.PI?(o={x:c,y:u},l={x:f,y:g}):.5*Math.PI<=s&&s<Math.PI?(o={x:f,y:u},l={x:c,y:g}):Math.PI<=s&&s<1.5*Math.PI?(o={x:f,y:g},l={x:c,y:u}):(o={x:c,y:g},l={x:f,y:u});var d=Math.tan(s),p=d*d,v=(l.x-o.x+d*(l.y-o.y))/(p+1)+o.x,m=d*(l.x-o.x+d*(l.y-o.y))/(p+1)+o.y,y=r.createLinearGradient(o.x,o.y,v,m);return Gr(h,y),y}(t,e,r);if("r"===i)return function(t,e,r){var i=t.split(" "),a=i[0].slice(2,i[0].length-1);a=a.split(",");var n=parseFloat(a[0]),s=parseFloat(a[1]),o=parseFloat(a[2]),l=i.slice(1);if(0===o)return l[l.length-1].split(":")[1];var{width:h,height:c,minX:u,minY:f}=e.getBBox(),g=Math.sqrt(h*h+c*c)/2,d=r.createRadialGradient(u+h*n,f+c*s,o*g,u+h/2,f+c/2,g);return Gr(l,d),d}(t,e,r)}catch(a){}return t}var Wr={stroke:"strokeStyle",fill:"fillStyle",opacity:"globalAlpha"},Vr=["fillStyle","font","globalAlpha","lineCap","lineWidth","lineJoin","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","textAlign","textBaseline","lineDash","shadow"],qr=["circle","sector","polygon","rect","polyline"];class Zr{_initProperties(){this._attrs={zIndex:0,visible:!0,destroyed:!1}}constructor(t){this._initProperties(),O(this._attrs,t);var e=this._attrs.attrs;e&&this.initAttrs(e),this.initTransform()}get(t){return this._attrs[t]}set(t,e){this._attrs[t]=e}isGroup(){return this.get("isGroup")}isShape(){return this.get("isShape")}initAttrs(t){this.attr(O(this.getDefaultAttrs(),t))}getDefaultAttrs(){return{}}_setAttr(t,e){var r=this._attrs.attrs;if("clip"===t)e=this._setAttrClip(e);else{var i=Wr[t];i&&(r[i]=e)}r[t]=e}_getAttr(t){return this._attrs.attrs[t]}_setAttrClip(t){return t&&qr.indexOf(t._attrs.type)>-1?(null===t.get("canvas")&&(t=Object.assign({},t)),t.set("parent",this.get("parent")),t.set("context",this.get("context")),t):null}attr(t,e){var r=this;if(r.get("destroyed"))return null;var i=arguments.length;if(0===i)return r._attrs.attrs;if(v(t)){for(var a in this._attrs.bbox=null,t)r._setAttr(a,t[a]);return r._afterAttrsSet&&r._afterAttrsSet(),r}return 2===i?(this._attrs.bbox=null,r._setAttr(t,e),r._afterAttrsSet&&r._afterAttrsSet(),r):r._getAttr(t)}getParent(){return this.get("parent")}draw(t){this.get("destroyed")||this.get("visible")&&(this.setContext(t),this.drawInner(t),this.restoreContext(t))}setContext(t){var e=this._attrs.attrs.clip;t.save(),e&&(e.resetTransform(t),e.createPath(t),t.clip()),this.resetContext(t),this.resetTransform(t)}restoreContext(t){t.restore()}resetContext(t){var e=this._attrs.attrs;for(var r in e)if(Vr.indexOf(r)>-1){var i=e[r];"fillStyle"!==r&&"strokeStyle"!==r||!i||(i=Hr(i,this,t)),"lineDash"===r&&t.setLineDash&&p(i)?t.setLineDash(i):t[r]=i}}hasFill(){return this.get("canFill")&&this._attrs.attrs.fillStyle}hasStroke(){return this.get("canStroke")&&this._attrs.attrs.strokeStyle}drawInner(){}show(){return this.set("visible",!0),this}hide(){return this.set("visible",!1),this}isVisible(){return this.get("visible")}getAriaLabel(){var{destroyed:t,visible:e,isShape:r,aria:i}=this._attrs;if(!t&&e&&(!r||i))return this._getAriaLabel()}_getAriaLabel(){return this._attrs.ariaLabel}_removeFromParent(){var t=this.get("parent");t&&R(t.get("children"),this);return this}remove(t){t?this.destroy():this._removeFromParent()}destroy(){if(this.get("destroyed"))return null;this._removeFromParent(),this._attrs={},this.set("destroyed",!0)}getBBox(){return{minX:0,maxX:0,minY:0,maxY:0,width:0,height:0}}initTransform(){var t=this._attrs.attrs||{};t.matrix||(t.matrix=[1,0,0,1,0,0]),this._attrs.attrs=t}getMatrix(){return this._attrs.attrs.matrix}setMatrix(t){this._attrs.attrs.matrix=[t[0],t[1],t[2],t[3],t[4],t[5]]}transform(t){var e=this._attrs.attrs.matrix;return this._attrs.attrs.matrix=gt.transform(e,t),this}setTransform(t){return this._attrs.attrs.matrix=[1,0,0,1,0,0],this.transform(t)}translate(t,e){var r=this._attrs.attrs.matrix;gt.translate(r,r,[t,e])}rotate(t){var e=this._attrs.attrs.matrix;gt.rotate(e,e,t)}scale(t,e){var r=this._attrs.attrs.matrix;gt.scale(r,r,[t,e])}moveTo(t,e){var r=this._attrs.x||0,i=this._attrs.y||0;this.translate(t-r,e-i),this.set("x",t),this.set("y",e)}apply(t){var e=this._attrs.attrs.matrix;return dt.transformMat2d(t,t,e),this}resetTransform(t){var e=this._attrs.attrs.matrix;gt.isChanged(e)&&t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}isDestroyed(){return this.get("destroyed")}}class Ur extends Zr{_initProperties(){this._attrs={zIndex:0,visible:!0,destroyed:!1,isShape:!0,attrs:{}}}getType(){return this._attrs.type}drawInner(t){var e=this,r=e.get("attrs");e.createPath(t);var i=t.globalAlpha;if(e.hasFill()){var a=r.fillOpacity;d(a)||1===a?t.fill():(t.globalAlpha=a,t.fill(),t.globalAlpha=i)}if(e.hasStroke()&&r.lineWidth>0){var n=r.strokeOpacity;d(n)||1===n||(t.globalAlpha=n),t.stroke()}}getBBox(){var t=this._attrs.bbox;return t||((t=this.calculateBox())&&(t.x=t.minX,t.y=t.minY,t.width=t.maxX-t.minX,t.height=t.maxY-t.minY),this._attrs.bbox=t),t}calculateBox(){return null}createPath(){}}let Jr=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="rect"}getDefaultAttrs(){return{x:0,y:0,width:0,height:0,radius:0,lineWidth:0}}createRadiusPath(t,e,r,i,a,n){n=function(t,e,r){if(!((t=Q(t))[0]||t[1]||t[2]||t[3]))return t;var i=Math.max(t[0]+t[1],t[2]+t[3]),a=Math.max(t[0]+t[3],t[1]+t[2]),n=Math.min(e/i,r/a);return n<1?t.map((function(t){return t*n})):t}(n,i,a),t.moveTo(e+n[0],r),t.lineTo(e+i-n[1],r),t.arc(e+i-n[1],r+n[1],n[1],-Math.PI/2,0,!1),t.lineTo(e+i,r+a-n[2]),t.arc(e+i-n[2],r+a-n[2],n[2],0,Math.PI/2,!1),t.lineTo(e+n[3],r+a),t.arc(e+n[3],r+a-n[3],n[3],Math.PI/2,Math.PI,!1),t.lineTo(e,r+n[0]),t.arc(e+n[0],r+n[0],n[0],Math.PI,3*Math.PI/2,!1),t.closePath()}createPath(t){var e=this.get("attrs"),{x:r,y:i,width:a,height:n,radius:s}=e;t.beginPath(),s&&a*n?this.createRadiusPath(t,r,i,a,n,s):t.rect(r,i,a,n)}calculateBox(){var t=this.get("attrs"),{x:e,y:r,width:i,height:a}=t;return{minX:e,minY:r,maxX:e+i,maxY:r+a}}};var $r={};var Kr=dt.create(),Qr=dt.create(),ti=dt.create();function ei(t,e,r,i,a){var n=t*t;return e+(3*-e+t*(3*e-e*t))*t+(3*r+t*(-6*r+3*r*t))*t+(3*i-3*i*t)*n+a*(n*t)}function ri(t){for(var e,r,i,a,n,s=1/0,o=-1/0,l=1/0,h=-1/0,c={x:t[0],y:t[1]},u={x:t[2],y:t[3]},f={x:t[4],y:t[5]},g={x:t[6],y:t[7]},d=0;d<100;d++){var p={x:ei(n=d/100,(e=c).x,(r=u).x,(i=f).x,(a=g).x),y:ei(n,e.y,r.y,i.y,a.y)};p.x<s&&(s=p.x),p.x>o&&(o=p.x),p.y<l&&(l=p.y),p.y>h&&(h=p.y)}return{minX:s,minY:l,maxX:o,maxY:h}}function ii(t,e){if(0!==t.length){for(var r=t[0],i=r.x,a=r.x,n=r.y,s=r.y,o=t.length,l=1;l<o;l++)r=t[l],i=Math.min(i,r.x),a=Math.max(a,r.x),n=Math.min(n,r.y),s=Math.max(s,r.y);return{minX:i-(e=e/2||0),minY:n-e,maxX:a+e,maxY:s+e}}}function ai(t,e,r,i,a,n){var s=Math.abs(i-a);if(s%(2*Math.PI)<1e-4&&s>1e-4)return{minX:t-r,minY:e-r,maxX:t+r,maxY:e+r};Kr[0]=Math.cos(i)*r+t,Kr[1]=Math.sin(i)*r+e,Qr[0]=Math.cos(a)*r+t,Qr[1]=Math.sin(a)*r+e;var o=[0,0],l=[0,0];if(dt.min(o,Kr,Qr),dt.max(l,Kr,Qr),(i%=2*Math.PI)<0&&(i+=2*Math.PI),(a%=2*Math.PI)<0&&(a+=2*Math.PI),i>a&&!n?a+=2*Math.PI:i<a&&n&&(i+=2*Math.PI),n){var h=a;a=i,i=h}for(var c=0;c<a;c+=Math.PI/2)c>i&&(ti[0]=Math.cos(c)*r+t,ti[1]=Math.sin(c)*r+e,dt.min(o,ti,o),dt.max(l,ti,l));return{minX:o[0],minY:o[1],maxX:l[0],maxY:l[1]}}function ni(t){return[t.x,t.y]}function si(t,e,r){for(var i,a,n,s=function(t,e,r,i){var a,n,s,o,l,h,c,u,f=[],g=!!i;if(g){for(s=[1/0,1/0],o=[-1/0,-1/0],u=0,c=t.length;u<c;u++)l=ni(t[u]),dt.min(s,s,l),dt.max(o,o,l);dt.min(s,s,i[0]),dt.max(o,o,i[1])}for(u=0,h=t.length;u<h;u++)if(l=ni(t[u]),0!==u&&u!==h-1){a=ni(t[u-1]),n=ni(t[u+1]);var d=dt.sub([],n,a);dt.scale(d,d,e);var p=dt.distance(l,a),v=dt.distance(l,n),m=p+v;0!==m&&(p/=m,v/=m);var y=dt.scale([],d,-p),x=dt.scale([],d,v),_=dt.add([],l,y),S=dt.add([],l,x);g&&(dt.max(_,_,s),dt.min(_,_,o),dt.max(S,S,s),dt.min(S,S,o)),f.push([_[0],_[1]]),f.push([S[0],S[1]])}else f.push([l[0],l[1]]);return f}(t,.4,0,r),o=t.length,l=[],h=0;h<o-1;h++)i=s[2*h],a=s[2*h+1],n=t[h+1],l.push(["C",i[0],i[1],a[0],a[1],n.x,n.y]);return l}function oi(t){for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r];isNaN(a.x)||isNaN(a.y)||e.push(a)}return e}var li={calcRotatedBox(t){var{width:e,height:r,rotate:i}=t,a=Math.abs(i);return{width:Math.abs(e*Math.cos(a)+r*Math.sin(a)),height:Math.abs(r*Math.cos(a)+e*Math.sin(a))}}},hi=0,ci={};var ui={circle(t,e,r,i){i.arc(t,e,r,0,2*Math.PI,!1)},square(t,e,r,i){i.moveTo(t-r,e-r),i.lineTo(t+r,e-r),i.lineTo(t+r,e+r),i.lineTo(t-r,e+r),i.closePath()}};Ur.Rect=Jr,Ur.Image=class extends Jr{_initProperties(){super._initProperties(),this._attrs.canFill=!1,this._attrs.canStroke=!1,this._attrs.loading=!1,this._attrs.image=null,this._attrs.type="image"}draw(t){var e=this;if(!this.get("loading"))if(this.get("image"))super.draw(t);else{var r=this.get("attrs"),{src:i}=r;if(i&&window.Image){var a=this.get("cacheImage");if(a&&$r[i])return this.set("image",$r[i]),void this.draw(t);this.set("loading",!0);var n=new Image;n.crossOrigin="",n.onload=function(){e.set("loading",!1),e.set("image",n),e.draw(t)},n.src=i,a&&($r[i]=n)}}}createPath(t){var e=this.get("image");this.drawImage(t,e)}drawImage(t,e){var{attrs:r,destroyed:i}=this._attrs;if(!i){var{x:a,y:n,width:s,height:o,sx:l,sy:h,swidth:c,sheight:u,radius:f,fillOpacity:g}=r;f&&(t.save(),this.createRadiusPath(t,a,n,s,o,f),t.clip());var p=t.globalAlpha;d(g)||(t.globalAlpha=g),d(l)||d(h)||d(c)||d(u)?t.drawImage(e,a,n,s,o):t.drawImage(e,l,h,c,u,a,n,s,o),t.globalAlpha=p,f&&t.restore()}}},Ur.Circle=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="circle"}getDefaultAttrs(){return{x:0,y:0,r:0,lineWidth:0}}createPath(t){var e=this.get("attrs"),{x:r,y:i,r:a}=e;t.beginPath(),t.arc(r,i,a,0,2*Math.PI,!1),t.closePath()}calculateBox(){var t=this.get("attrs"),{x:e,y:r,r:i}=t;return{minX:e-i,maxX:e+i,minY:r-i,maxY:r+i}}},Ur.Line=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canStroke=!0,this._attrs.type="line"}getDefaultAttrs(){return{x1:0,y1:0,x2:0,y2:0,lineWidth:1}}createPath(t){var e=this.get("attrs"),{x1:r,y1:i,x2:a,y2:n}=e;t.beginPath(),t.moveTo(r,i),t.lineTo(a,n)}calculateBox(){var t=this.get("attrs"),{x1:e,y1:r,x2:i,y2:a,lineWidth:n}=t;return function(t,e,r,i,a){return a=a/2||0,{minX:Math.min(t,r)-a,minY:Math.min(e,i)-a,maxX:Math.max(t,r)+a,maxY:Math.max(e,i)+a}}(e,r,i,a,n)}},Ur.Polygon=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="polygon"}getDefaultAttrs(){return{points:null,lineWidth:0}}createPath(t){var e=this.get("attrs").points;t.beginPath();for(var r=0,i=e.length;r<i;r++){var a=e[r];0===r?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)}t.closePath()}calculateBox(){var t=this.get("attrs"),{points:e}=t;return ii(e)}},Ur.Polyline=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="polyline"}getDefaultAttrs(){return{points:null,lineWidth:1,smooth:!1}}createPath(t){var e=this.get("attrs"),{points:r,smooth:i}=e,a=oi(r);if(t.beginPath(),a.length)if(t.moveTo(a[0].x,a[0].y),i)for(var n=si(a,0,[[0,0],[1,1]]),s=0,o=n.length;s<o;s++){var l=n[s];t.bezierCurveTo(l[1],l[2],l[3],l[4],l[5],l[6])}else{var h,c;for(h=1,c=a.length-1;h<c;h++)t.lineTo(a[h].x,a[h].y);t.lineTo(a[c].x,a[c].y)}}calculateBox(){var t=this.get("attrs"),{points:e,smooth:r,lineWidth:i}=t,a=oi(e);if(a.length<=1)return ii(a,i);if(r){for(var n=[],s=si(a,0,[[0,0],[1,1]]),o=0,l=s.length;o<l;o++){var h=s[o];if(0===o)n.push([a[0].x,a[0].y,h[1],h[2],h[3],h[4],h[5],h[6]]);else{var c=s[o-1];n.push([c[5],c[6],h[1],h[2],h[3],h[4],h[5],h[6]])}}return function(t,e){for(var r=1/0,i=-1/0,a=1/0,n=-1/0,s=0,o=t.length;s<o;s++){var l=ri(t[s]);l.minX<r&&(r=l.minX),l.maxX>i&&(i=l.maxX),l.minY<a&&(a=l.minY),l.maxY>n&&(n=l.maxY)}return{minX:r-(e=e/2||0),minY:a-e,maxX:i+e,maxY:n+e}}(n,i)}return ii(a,i)}},Ur.Arc=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canStroke=!0,this._attrs.canFill=!0,this._attrs.type="arc"}getDefaultAttrs(){return{x:0,y:0,r:0,startAngle:0,endAngle:2*Math.PI,anticlockwise:!1,lineWidth:1}}createPath(t){var e=this.get("attrs"),{x:r,y:i,r:a,startAngle:n,endAngle:s,anticlockwise:o}=e;t.beginPath(),n!==s&&t.arc(r,i,a,n,s,o)}calculateBox(){var t=this.get("attrs"),{x:e,y:r,r:i,startAngle:a,endAngle:n,anticlockwise:s}=t;return ai(e,r,i,a,n,s)}},Ur.Sector=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="sector"}getDefaultAttrs(){return{x:0,y:0,lineWidth:0,r:0,r0:0,startAngle:0,endAngle:2*Math.PI,anticlockwise:!1}}createPath(t){var e=this.get("attrs"),{x:r,y:i,startAngle:a,endAngle:n,r:s,r0:o,anticlockwise:l}=e;t.beginPath();var h=Math.cos(a),c=Math.sin(a);t.moveTo(h*o+r,c*o+i),t.lineTo(h*s+r,c*s+i),(Math.abs(n-a)>1e-4||0===a&&n<0)&&(t.arc(r,i,s,a,n,l),t.lineTo(Math.cos(n)*o+r,Math.sin(n)*o+i),0!==o&&t.arc(r,i,o,n,a,!l)),t.closePath()}calculateBox(){var t=this.get("attrs"),{x:e,y:r,r:i,r0:a,startAngle:n,endAngle:s,anticlockwise:o}=t,l=ai(e,r,i,n,s,o),h=ai(e,r,a,n,s,o);return{minX:Math.min(l.minX,h.minX),minY:Math.min(l.minY,h.minY),maxX:Math.max(l.maxX,h.maxX),maxY:Math.max(l.maxY,h.maxY)}}},Ur.Text=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="text"}getDefaultAttrs(){return{lineWidth:0,lineCount:1,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom",lineHeight:null,textArr:null}}_getFontStyle(){var t=this._attrs.attrs,{fontSize:e,fontFamily:r,fontWeight:i,fontStyle:a,fontVariant:n}=t;return"".concat(a," ").concat(n," ").concat(i," ").concat(e,"px ").concat(r)}_afterAttrsSet(){var t=this._attrs.attrs;if(t.font=this._getFontStyle(),t.text){var e=t.text,r=null,i=1;_(e)&&-1!==e.indexOf("\n")&&(i=(r=e.split("\n")).length),t.lineCount=i,t.textArr=r}this.set("attrs",t)}_getTextHeight(){var t=this._attrs.attrs;if(t.height)return t.height;var e=t.lineCount,r=1*t.fontSize;return e>1?r*e+this._getSpaceingY()*(e-1):r}_getSpaceingY(){var t=this._attrs.attrs,e=t.lineHeight,r=1*t.fontSize;return e?e-r:.14*r}drawInner(t){var e=this,r=e._attrs.attrs,i=r.text,a=r.x,n=r.y;if(!(d(i)||isNaN(a)||isNaN(n))){var s=r.textArr,o=1*r.fontSize,l=e._getSpaceingY();r.rotate&&(t.translate(a,n),t.rotate(r.rotate),a=0,n=0);var h,c,u=r.textBaseline;if(s&&(h=e._getTextHeight()),e.hasFill()){var f=r.fillOpacity;if(d(f)||1===f||(t.globalAlpha=f),s)for(var g=0,p=s.length;g<p;g++){var v=s[g];c=n+g*(l+o)-h+o,"middle"===u&&(c+=h-o-(h-o)/2),"top"===u&&(c+=h-o),t.fillText(v,a,c)}else t.fillText(i,a,n)}if(e.hasStroke())if(s)for(var m=0,y=s.length;m<y;m++){var x=s[m];c=n+m*(l+o)-h+o,"middle"===u&&(c+=h-o-(h-o)/2),"top"===u&&(c+=h-o),t.strokeText(x,a,c)}else t.strokeText(i,a,n)}}_getAriaLabel(){return this._attrs.attrs.text}calculateBox(){var t=this,e=t._attrs.attrs,{x:r,y:i,textAlign:a,textBaseline:n}=e,s=t._getTextWidth();if(!s)return{minX:r,minY:i,maxX:r,maxY:i};var o=t._getTextHeight();if(e.rotate){var l=li.calcRotatedBox({width:s,height:o,rotate:e.rotate});s=l.width,o=l.height}var h={x:r,y:i-o};return a&&("end"===a||"right"===a?h.x-=s:"center"===a&&(h.x-=s/2)),n&&("top"===n?h.y+=o:"middle"===n&&(h.y+=o/2)),{minX:h.x,minY:h.y,maxX:h.x+s,maxY:h.y+o}}_getTextWidth(){var t=this._attrs.attrs;if(t.width)return t.width;var e=t.text,r=this.get("context");if(!d(e)){var i=t.font,a=t.textArr,n=e+""+i;if(ci[n])return ci[n];var s=0;if(a)for(var o=0,l=a.length;o<l;o++){var h=a[o];s=Math.max(s,K(h,i,r).width)}else s=K(e,i,r).width;return hi>5e3&&(hi=0,ci={}),hi++,ci[n]=s,s}}},Ur.Custom=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.createPath=null,this._attrs.type="custom"}createPath(t){var e=this.get("createPath");e&&e.call(this,t)}calculateBox(){var t=this.get("calculateBox");return t&&t.call(this)}},Ur.Marker=class extends Ur{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="marker"}getDefaultAttrs(){return{x:0,y:0,lineWidth:0}}createPath(t){var e,r=this.get("attrs"),{x:i,y:a,radius:n}=r,s=r.symbol||"circle";e=g(s)?s:ui[s],t.beginPath(),e(i,a,n,t,this)}calculateBox(){var t=this.get("attrs"),{x:e,y:r,radius:i}=t;return{minX:e-i,minY:r-i,maxX:e+i,maxY:r+i}}};var fi={},gi="_INDEX";const di={getGroupClass(){},getChildren(){return this.get("children")},addShape(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=fi[t];r||(r=T(t),fi[t]=r);var i=new Ur[r](e);return this.add(i),i},addGroup(t){var e=new(this.getGroupClass())(t);return this.add(e),e},contain(t){return this.get("children").indexOf(t)>-1},sort(){for(var t,e=this.get("children"),r=0,i=e.length;r<i;r++){e[r][gi]=r}return e.sort((t=function(t,e){return t.get("zIndex")-e.get("zIndex")},function(e,r){var i=t(e,r);return 0===i?e[gi]-r[gi]:i})),this},drawChildren(t){for(var e=this.get("children"),r=0,i=e.length;r<i;r++){e[r].draw(t)}return this},clear(){for(var t=this.get("children");0!==t.length;)t[t.length-1].remove(!0);return this},add(t){var e=this,r=e.get("children");p(t)||(t=[t]);for(var i=0,a=t.length;i<a;i++){var n=t[i],s=n.get("parent");if(s)R(s.get("children"),n);e._setEvn(n),r.push(n)}return e},_setEvn(t){var e=this,{context:r,canvas:i,aria:a}=e._attrs,{isGroup:n,type:s}=t._attrs;t._attrs.parent=e,t._attrs.context=r,t._attrs.canvas=i,a&&!1!==t._attrs.aria&&(t._attrs.aria=a),"text"===s&&i&&i.get("fontFamily")&&(t._attrs.attrs.fontFamily=t._attrs.attrs.fontFamily||i.get("fontFamily"));var o=t._attrs.attrs.clip;if(o&&(o._attrs.parent=e,o._attrs.context=r,o._attrs.canvas=i),n)for(var l=t._attrs.children,h=0,c=l.length;h<c;h++)t._setEvn(l[h])},_getAriaLabel(){var{aria:t,ariaLabel:e,children:r}=this._attrs;if(t){var i=[];if(r&&r.length)for(var a=0,n=r.length;a<n;a++){var s=r[a].getAriaLabel();s&&i.push(s)}var o=i.join(" ");return e&&o?"".concat(e," ").concat(o," "):e||o}}};class pi extends Jr{_initProperties(){this._attrs={type:"group",zIndex:0,visible:!0,destroyed:!1,isGroup:!0,canFill:!0,canStroke:!0,attrs:{},children:[]}}getBBox(){for(var t=1/0,e=-1/0,r=1/0,i=-1/0,a=this.get("children"),n=0,s=a.length;n<s;n++){var o=a[n];if(o.get("visible")){var l=o.getBBox();if(!l)continue;var h=[l.minX,l.minY],c=[l.minX,l.maxY],u=[l.maxX,l.minY],f=[l.maxX,l.maxY],g=o.attr("matrix");dt.transformMat2d(h,h,g),dt.transformMat2d(c,c,g),dt.transformMat2d(u,u,g),dt.transformMat2d(f,f,g),t=Math.min(h[0],c[0],u[0],f[0],t),e=Math.max(h[0],c[0],u[0],f[0],e),r=Math.min(h[1],c[1],u[1],f[1],r),i=Math.max(h[1],c[1],u[1],f[1],i)}}return{minX:t,minY:r,maxX:e,maxY:i,x:t,y:r,width:e-t,height:i-r}}createPath(t){var e=this.get("attrs");(e.fillStyle||e.strokeStyle)&&super.createPath(t)}drawInner(t){super.drawInner(t),this.drawChildren(t)}destroy(){this.get("destroyed")||(this.clear(),super.destroy())}}O(pi.prototype,di,{getGroupClass:()=>pi});var vi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:function(t){return setTimeout(t,16)};class mi extends ct{get(t){return this._attrs[t]}set(t,e){this._attrs[t]=e}constructor(t){super();var{title:e}=t,r=e?k(nt.general.withTitle,{title:e}):nt.general.title;this._attrs=O({type:"canvas",children:[],ariaLabel:r},t),this._initPixelRatio(),this._initCanvas()}_initPixelRatio(){this.get("pixelRatio")||this.set("pixelRatio",window&&window.devicePixelRatio||1)}beforeDraw(){var t=this._attrs.context,e=this._attrs.el;t&&t.clearRect&&t.clearRect(0,0,e.width,e.height)}_initCanvas(){var t,e,r=this,i=r.get("el"),a=r.get("context");if(!i&&!a)throw new Error("Please specify the id, el or context of the chart!");t=i?_(i)?(e=i)?document.getElementById(e):null:i:Rr.create(a),a&&t&&!t.getContext&&(t.getContext=function(){return a});var n=r.get("width");n||(n=V(t));var s=r.get("height");s||(s=q(t)),r.set("canvas",this),r.set("el",t),r.set("context",a||t.getContext("2d")),r.changeSize(n,s);var o=new Br({canvas:this,el:t});r.set("eventController",o)}changeSize(t,e){var r,i=this.get("pixelRatio"),a=this.get("el");(a.style&&(a.style.width=t+"px",a.style.height=e+"px"),(r=a)&&"object"==typeof r&&(1===r.nodeType&&r.nodeName||r.isCanvasElement))&&(a.width=t*i,a.height=e*i,1!==i&&this.get("context").scale(i,i));this.set("width",t),this.set("height",e)}getWidth(){var t=this.get("pixelRatio");return this.get("width")*t}getHeight(){var t=this.get("pixelRatio");return this.get("height")*t}getPointByClient(t,e){var r=this.get("el"),i=r.getBoundingClientRect(),a=i.right-i.left,n=i.bottom-i.top;return{x:(t-i.left)*(r.width/a),y:(e-i.top)*(r.height/n)}}_beginDraw(){this._attrs.toDraw=!0}_endDraw(){this._attrs.toDraw=!1}draw(){var t=this;t.get("destroyed")||(t.get("animateHandler")?this._beginDraw():function e(){t.set("animateHandler",vi((function(){t.set("animateHandler",void 0),t.get("toDraw")&&e()}))),t.beforeDraw();try{var r=t._attrs.context;t.drawChildren(r),r.draw&&r.draw(),t.setAriaLabel()}catch(i){t._endDraw()}t._endDraw()}())}setAriaLabel(){var{el:t}=this._attrs,e=this._getAriaLabel();e&&t.setAttribute&&t.setAttribute("aria-label",e)}destroy(){if(!this.get("destroyed")){var t=this.get("el");t.width=0,t.height=0,this.clear(),this._attrs={},this.set("destroyed",!0)}}isDestroyed(){return this.get("destroyed")}}O(mi.prototype,di,{getGroupClass:()=>pi});var yi={};function xi(t){var{renderer:e}=t;return new(function(t){var e=yi[t];return e||{Canvas:mi,Group:pi,Shape:Ur}}(e).Canvas)(t)}function _i(t){var e,r=t.start,i=t.end,a=i.x-r.x,n=Math.abs(i.y-r.y);if(t.isPolar){var{circleRadius:s,center:o,startAngle:l,endAngle:h}=t;e=new Ur.Sector({attrs:{x:o.x,y:o.y,r:s,r0:0,startAngle:l,endAngle:h}})}else e=new Ur.Rect({attrs:{x:r.x,y:i.y-10,width:a,height:n+20}});return e.isClip=!0,e}function Si(t,e){var{x:r,y:i}=t,{tl:a,tr:n,br:s}=e;return r>=a.x&&r<=n.x&&i>=a.y&&i<=s.y}function bi(t,e){return t-e}class Mi extends ut{static initPlugins(){return{_plugins:[],_cacheId:0,register(t){var e=this._plugins;[].concat(t).forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),this._cacheId++},unregister(t){var e=this._plugins;[].concat(t).forEach((function(t){var r=e.indexOf(t);-1!==r&&e.splice(r,1)})),this._cacheId++},clear(){this._plugins=[],this._cacheId++},count(){return this._plugins.length},getAll(){return this._plugins},notify(t,e,r){var i,a,n,s,o=this.descriptors(t),l=o.length;for(i=0;i<l;++i)if("function"==typeof(s=(a=o[i].plugin)[e])&&(n=[t].concat(r||[]),!1===s.apply(a,n)))return!1;return!0},descriptors(t){var e=t._plugins||(t._plugins={});if(e.id===this._cacheId)return e.descriptors;var r=[],i=[];return this._plugins.concat(t&&t.get("plugins")||[]).forEach((function(t){-1===r.indexOf(t)&&(r.push(t),i.push({plugin:t}))})),e.descriptors=i,e.id=this._cacheId,i}}}getDefaultCfg(){return{id:null,renderer:"canvas",rendered:!1,padding:st.padding,data:null,scales:{},geoms:[],colDefs:null,pixelRatio:st.pixelRatio,filters:null,appendPadding:st.appendPadding}}_syncYScales(){if(this.get("syncY")){var t=this.get("geoms"),e=[],r=[],i=[];m(t,(function(t){var a=t.getYScale();a.isLinear&&(e.push(a),r.push(a.min),i.push(a.max))})),r=Math.min.apply(null,r),i=Math.max.apply(null,i),m(e,(function(t){t.change({min:r}),t.change({max:i})}))}}_getFieldsForLegend(){var t=[];return m(this.get("geoms"),(function(e){var r=e.get("attrOptions").color;r&&r.field&&_(r.field)&&m(r.field.split("*"),(function(e){-1===t.indexOf(e)&&t.push(e)}))})),t}_getScaleData(t){var e=this.get("data"),r=this.get("filteredData");r.length&&(-1===this._getFieldsForLegend().indexOf(t)&&(e=r));return e}_adjustScale(){for(var t=this.get("scaleController"),e=this.get("geoms"),r=0;r<e.length;r++){var i=e[r];if("interval"===i.get("type")){var a=i.getYScale();t.adjustStartZero(a)}}}_removeGeoms(){for(var t=this.get("geoms");t.length>0;){t.shift().destroy()}}_clearGeoms(){for(var t=this.get("geoms"),e=0,r=t.length;e<r;e++){t[e].clear()}}_clearInner(){this._clearGeoms(),Mi.plugins.notify(this,"clearInner"),this.emit("clearinner"),this.get("axisController")&&this.get("axisController").clear()}_initFilteredData(){var t=this.get("filters"),e=this.get("data")||[];t&&(e=e.filter((function(e){var r=!0;return m(t,(function(t,i){if(t&&!(r=t(e[i],e)))return!1})),r}))),this.set("filteredData",e)}_changeGeomsData(){for(var t=this.get("geoms"),e=this.get("filteredData"),r=0,i=t.length;r<i;r++){t[r].changeData(e)}}_initGeom(t){if(!t.get("isInit")){var e=this.get("coord"),r=this.get("filteredData"),i=this.get("colDefs"),a=this.get("middlePlot");t.set("chart",this),t.set("container",a.addGroup()),t.set("data",r),t.set("coord",e),t.set("colDefs",i),t.init(),this.emit("_aftergeominit",t)}}_initGeoms(){for(var t=this.get("geoms"),e=0,r=t.length;e<r;e++)this._initGeom(t[e])}_initCoord(){var t=this.get("plotRange"),e=O({type:"cartesian"},this.get("coordCfg"),{plot:t}),r=e.type,i=new(0,vt[T(r)])(e);this.set("coord",i)}_initLayout(){var t=this.get("_padding");t||(t=Q(t=this.get("margin")||this.get("padding")));var e="auto"===t[0]?0:t[0],r="auto"===t[1]?0:t[1],i="auto"===t[2]?0:t[2],a={x:"auto"===t[3]?0:t[3],y:e},n={x:this.get("width")-r,y:this.get("height")-i},s=this.get("plot");if(s)s.reset(a,n);else{var o=new ft({start:a,end:n});this.set("plotRange",o),this.set("plot",o)}}_initCanvas(){var t=this;try{var e=xi({renderer:t.get("renderer"),el:t.get("el")||t.get("id"),context:t.get("context"),pixelRatio:t.get("pixelRatio"),width:t.get("width"),height:t.get("height"),fontFamily:st.fontFamily,aria:t.get("aria"),title:t.get("title"),landscape:t.get("landscape")});t.set("canvas",e),t.set("el",e.get("el")),t.set("width",e.get("width")),t.set("height",e.get("height"))}catch(r){throw r}Mi.plugins.notify(t,"afterCanvasInit")}_initLayers(){var t=this.get("canvas");this.set("backPlot",t.addGroup()),this.set("middlePlot",t.addGroup({zIndex:10})),this.set("frontPlot",t.addGroup({zIndex:20}))}_initEvents(){var t=this;this.on(lt,(function(){t._initFilteredData(),t._changeGeomsData()})),this.on(ht,(function(){t._initLayout();var e=t.get("coord");e&&e.reset(t.get("plot"))}))}_initScaleController(){var t=new Nr({chart:this});this.set("colDefs",t.defs),this.set("scales",t.scales),this.set("scaleController",t)}_clearScaleController(){this.get("scaleController").clear()}_init(){var t=this;t._initCanvas(),t._initLayout(),t._initLayers(),t._initEvents(),t._initScaleController(),t.set("axisController",new Er({frontPlot:t.get("frontPlot").addGroup({className:"axisContainer"}),backPlot:t.get("backPlot").addGroup({className:"axisContainer"}),chart:t})),Mi.plugins.notify(t,"init")}constructor(t){super(t);var e=this;m(Gt,(function(t,r){var i,a=(i=C(r)).charAt(0).toLowerCase()+i.substring(1);e[a]=function(r){var i=new t(r);return e.addGeom(i),i}})),e._init()}init(){this._initFilteredData(),this._initCoord(),Mi.plugins.notify(this,"beforeGeomInit"),this._initGeoms(),this._syncYScales(),this._adjustScale(),this.emit(ot)}source(t,e){return this.set("data",t),e&&this.scale(e),this}scale(t,e){return this.get("scaleController").setFieldDef(t,e),this}axis(t,e){var r=this.get("axisController");return t?(r.axisCfg=r.axisCfg||{},r.axisCfg[t]=e):r.axisCfg=null,this}coord(t,e){var r;return v(t)?r=t:(r=e||{}).type=t||"cartesian",this.set("coordCfg",r),this}filter(t,e){var r=this.get("filters")||{};r[t]=e,this.set("filters",r),this.get("rendered")&&this.emit(lt,this.get("data"))}render(){var t=this.get("rendered"),e=this.get("canvas"),r=this.get("geoms");t?(this._initGeoms(),this._adjustScale()):(this.init(),this.set("rendered",!0)),this.emit("beforerender"),Mi.plugins.notify(this,"beforeGeomDraw"),this._renderAxis();var i=this.get("middlePlot");if(this.get("limitInPlot")&&!i.attr("clip")){var a=_i(this.get("coord"));a.set("canvas",i.get("canvas")),i.attr("clip",a)}this.emit("beforegeomdraw");for(var n=0,s=r.length;n<s;n++){r[n].paint()}return this.emit("aftergeomdraw"),Mi.plugins.notify(this,"afterGeomDraw"),e.sort(),this.get("frontPlot").sort(),Mi.plugins.notify(this,"beforeCanvasDraw"),e.draw(),this.emit("afterrender"),this}clear(){return Mi.plugins.notify(this,"clear"),this.emit("clear"),this._clearInner(),this._removeGeoms(),this._clearScaleController(),this.set("legendItems",null),this.set("filters",null),this.set("isUpdate",!1),this.set("_padding",null),this.set("rendered",!1),this.get("canvas").draw(),this}repaint(){this.get("rendered")&&(this.set("isUpdate",!0),this.set("legendItems",null),Mi.plugins.notify(this,"repaint"),this._clearInner(),this.emit("repaint"),this.render())}changeData(t){this.emit("beforedatachange",t),this.set("data",t),Mi.plugins.notify(this,"changeData"),this.emit(lt,t),this.set("_padding",null),this.repaint()}changeSize(t,e){return t?this.set("width",t):t=this.get("width"),e?this.set("height",e):e=this.get("height"),this.get("canvas").changeSize(t,e),this.emit(ht,{width:t,height:e}),this.repaint(),this}destroy(){this.clear(),this.get("canvas").destroy(),Mi.plugins.notify(this,"afterCanvasDestroyed"),this._interactions&&m(this._interactions,(function(t){t.destroy()})),super.destroy()}getPosition(t){for(var e=this,r=e.get("coord"),i=e.getXScale(),a=i.field,n=e.getYScales(),s=n[0],o=s.field,l=0,h=n.length;l<h;l++){var c=n[l],u=c.field;if(t[u]){s=c,o=u;break}}var f=i.scale(t[a]),g=s.scale(t[o]);return r.convertPoint({x:f,y:g})}getRecord(t){var e=this,r=e.get("coord"),i=e.getXScale(),a=e.getYScales()[0],n=r.invertPoint(t),s={};return s[i.field]=i.invert(n.x),s[a.field]=a.invert(n.y),s}getSnapRecords(t){var e=this.get("geoms")[0],r=[];return e&&(r=e.getSnapRecords(t)),r}createScale(t){var e=this._getScaleData(t);return this.get("scaleController").createScale(t,e)}addGeom(t){this.get("geoms").push(t)}getXScale(){return this.get("geoms")[0].getXScale()}getYScales(){var t=this.get("geoms"),e=[];return m(t,(function(t){var r=t.getYScale();-1===e.indexOf(r)&&e.push(r)})),e}getLegendItems(){if(this.get("legendItems"))return this.get("legendItems");var t={},e=[];return m(this.get("geoms"),(function(r){var i=r.getAttr("color");if(i){var a=i.getScale("color");if(a.isCategory&&!function(t,e){var r=!1;return m(t,(function(t){var i=[].concat(t.values),a=[].concat(e.values);t.type!==e.type||t.field!==e.field||i.sort(bi).toString()!==a.sort(bi).toString()||(r=!0)})),r}(e,a)){e.push(a);var n=a.field,s=a.getTicks(),o=[];m(s,(function(t){var e=t.text,r=t.value,n=a.invert(r),s={fill:i.mapping(n).join("")||st.defaultColor,radius:3,symbol:"circle",stroke:"#fff"};o.push({name:e,dataValue:n,checked:!0,marker:s})})),t[n]=o}}})),this.set("legendItems",t),t}registerPlugins(t){var e=this,r=e.get("plugins")||[];p(r)||(r=[r]),[].concat(t).forEach((function(t){-1===r.indexOf(t)&&(t.init&&t.init(e),r.push(t))})),Mi.plugins._cacheId++,e.set("plugins",r)}_renderAxis(){var t=this.get("axisController"),e=this.getXScale(),r=this.getYScales(),i=this.get("coord");Mi.plugins.notify(this,"beforeRenderAxis"),t.createAxis(i,e,r)}_isAutoPadding(){if(this.get("_padding"))return!1;var t=this.get("padding");return p(t)?-1!==t.indexOf("auto"):"auto"===t}_updateLayout(t){var e=this.get("width"),r=this.get("height"),i={x:t[3],y:t[0]},a={x:e-t[1],y:r-t[2]},n=this.get("plot"),s=this.get("coord");n.reset(i,a),s.reset(n)}landscape(t){this.get("canvas").set("landscape",t)}}function wi(t){var e=[],r=t.x,i=t.y;return(i=p(i)?i:[i]).forEach((function(t,i){var a={x:p(r)?r[i]:r,y:t};e.push(a)})),e}function Pi(t,e,r){if(!t.length)return[];var i,a=[],n=[];return m(t,(function(t){i=t._origin?t._origin[e]:t[e],r?d(i)||n.push(t):p(i)&&d(i[0])||d(i)?n.length&&(a.push(n),n=[]):n.push(t)})),n.length&&a.push(n),a}Mi.plugins=Mi.initPlugins(),st.version;function Ci(t,e,r){if(0!==t.size){var i=function(t){var e={lineWidth:0,stroke:t.color,fill:t.color};return t.size&&(e.size=t.size),O(e,t.style),O({},st.shape.point,e)}(t),a=i.r||i.size,n=t.x,s=p(t.y)?t.y:[t.y];"hollowCircle"===r&&(i.lineWidth=1,i.fill=null);for(var o=0,l=s.length;o<l;o++)return"rect"===r?e.addShape("Rect",{className:"point",attrs:O({x:n-a,y:s[o]-a,width:2*a,height:2*a},i)}):e.addShape("Circle",{className:"point",attrs:O({x:n,y:s[o],r:a},i)})}}At.registerFactory("point",{defaultShapeType:"circle",getDefaultPoints:t=>wi(t)}),m(["circle","hollowCircle","rect"],(function(t){At.registerShape("point",t,{draw:(e,r)=>Ci(e,r,t)})}));Gt.Point=class extends Gt{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="point",t.shapeType="point",t.generatePoints=!1,t}draw(t,e){var r=this,i=r.get("container");m(t,(function(t){var a=t.shape,n=r.getDrawCfg(t);if(p(t.y)){var s=r.hasAdjust("stack");m(t.y,(function(o,l){n.y=o,s&&0===l||r.drawShape(a,t,n,i,e)}))}else d(t.y)||r.drawShape(a,t,n,i,e)}))}},At.registerFactory("line",{defaultShapeType:"line"});m(["line","smooth","dash"],(function(t){At.registerShape("line",t,{draw(e,r){var i="smooth"===t,a=function(t){var e={strokeStyle:t.color};return t.size>=0&&(e.lineWidth=t.size),O(e,t.style),O({},st.shape.line,e)}(e);return"dash"===t&&(a.lineDash=st.lineDash),function(t,e,r,i){var a=t.points;if(a.length&&p(a[0].y)){for(var n=[],s=[],o=0,l=a.length;o<l;o++){var h=wi(a[o]);s.push(h[0]),n.push(h[1])}return t.isInCircle&&(n.push(n[0]),s.push(s[0])),t.isStack?e.addShape("Polyline",{className:"line",attrs:O({points:n,smooth:i},r)}):[e.addShape("Polyline",{className:"line",attrs:O({points:n,smooth:i},r)}),e.addShape("Polyline",{className:"line",attrs:O({points:s,smooth:i},r)})]}return t.isInCircle&&a.push(a[0]),e.addShape("Polyline",{className:"line",attrs:O({points:a,smooth:i},r)})}(e,r,a,i)}})}));class ki extends Gt{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="path",t.shapeType="line",t}getDrawCfg(t){var e=super.getDrawCfg(t);return e.isStack=this.hasAdjust("stack"),e}draw(t,e){var r=this,i=r.get("container"),a=r.getYScale(),n=r.get("connectNulls"),s=Pi(t,a.field,n),o=this.getDrawCfg(t[0]);o.origin=t,m(s,(function(a,n){o.splitedIndex=n,o.points=a,r.drawShape(o.shape,t[0],o,i,e)}))}}Gt.Path=ki;function Ti(t,e){return Math.abs(t-e)<1e-5}function Di(t){return!isNaN(t)&&!d(t)}function Ai(t){for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r];Di(a.x)&&Di(a.y)&&e.push(a)}return e}function Ii(t,e,r){var i=t.points,a=[],n=[];m(i,(function(t){n.push(t[0]),a.push(t[1])}));var s=O({fillStyle:t.color},st.shape.area,t.style);return n.reverse(),a=this.parsePoints(a),n=this.parsePoints(n),t.isInCircle&&(a.push(a[0]),n.unshift(n[n.length-1]),function(t,e){var r=!0;return m(t,(function(t){if(!Ti(t.x,e.x)||!Ti(t.y,e.y))return r=!1,!1})),r}(n,t.center)&&(n=[])),function(t,e,r,i,a){var n=t.concat(e);return a?r.addShape("Custom",{className:"area",attrs:O({points:n},i),createPath(t){var e=[[0,0],[1,1]],r=Ai(this._attrs.attrs.points),i=r.length,a=r.slice(0,i/2),n=r.slice(i/2,i),s=si(a,0,e);t.beginPath(),t.moveTo(a[0].x,a[0].y);for(var o=0,l=s.length;o<l;o++){var h=s[o];t.bezierCurveTo(h[1],h[2],h[3],h[4],h[5],h[6])}if(n.length){var c=si(n,0,e);t.lineTo(n[0].x,n[0].y);for(var u=0,f=c.length;u<f;u++){var g=c[u];t.bezierCurveTo(g[1],g[2],g[3],g[4],g[5],g[6])}}t.closePath()},calculateBox(){return ii(Ai(this._attrs.attrs.points))}}):r.addShape("Polyline",{className:"area",attrs:O({points:n},i)})}(a,n,e,s,r)}Gt.Line=class extends ki{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="line",t.sortable=!0,t}},At.registerFactory("area",{defaultShapeType:"area",getDefaultPoints(t){var e=t.x,r=t.y,i=t.y0;r=p(r)?r:[i,r];var a=[];return a.push({x:e,y:r[0]},{x:e,y:r[1]}),a}});m(["area","smooth"],(function(t){At.registerShape("area",t,{draw(e,r){var i="smooth"===t;return Ii.call(this,e,r,i)}})}));Gt.Area=class extends Gt{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="area",t.shapeType="area",t.generatePoints=!0,t.sortable=!0,t}draw(t,e){var r=this,i=r.get("container"),a=this.getDrawCfg(t[0]),n=r.getYScale(),s=r.get("connectNulls"),o=Pi(t,n.field,s);a.origin=t,m(o,(function(n,s){a.splitedIndex=s;var o=n.map((function(t){return t.points}));a.points=o,r.drawShape(a.shape,t[0],a,i,e)}))}};var Yi,Oi,Ni,ji,Ei,Fi,zi,Li,Bi,Xi,Ri,Gi,Hi,Wi,Vi,qi,Zi,Ui,Ji,$i,Ki,Qi,ta={initEvent(){var t=this,e=this.get("chart");e&&e.on(ht,(function(){t.set("_width",null)}))},getDefaultSize(){var t=this.get("defaultSize");if(!t){var e=this.get("coord"),r=this.getXScale(),i=this.get("dataArray"),a=function(t,e){void 0===e&&(e=new Map);var r=[];if(Array.isArray(t))for(var i=0,a=t.length;i<a;i++){var n=t[i];e.has(n)||(r.push(n),e.set(n,!0))}return r}(r.values).length,n=r.range,s=1/a,o=1;e&&e.isPolar?o=e.transposed&&a>1?st.widthRatio.multiplePie:st.widthRatio.rose:(r.isLinear&&(s*=n[1]-n[0]),o=st.widthRatio.column),s*=o,this.hasAdjust("dodge")&&(s/=i.length),t=s,this.set("defaultSize",t)}return t},getDimWidth(t){var e=this.get("coord"),r=e.convertPoint({x:0,y:0}),i=e.convertPoint({x:"x"===t?1:0,y:"x"===t?0:1}),a=0;return r&&i&&(a=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))),a},_getWidth(){var t=this.get("_width");if(!t){var e=this.get("coord");t=e&&e.isPolar&&!e.transposed?(e.endAngle-e.startAngle)*e.circleRadius:this.getDimWidth("x"),this.set("_width",t)}return t},_toNormalizedSize(t){return t/this._getWidth()},_toCoordSize(t){return this._getWidth()*t},getNormalizedSize(t){var e=this.getAttrValue("size",t);return e=d(e)?this.getDefaultSize():this._toNormalizedSize(e)},getSize(t){var e=this.getAttrValue("size",t);if(d(e)){var r=this.getDefaultSize();e=this._toCoordSize(r)}return e}};function ea(t){var e,r,{x:i,y:a,y0:n,size:s}=t,o=n,l=a;return p(a)&&(l=a[1],o=a[0]),p(i)?(e=i[0],r=i[1]):(e=i-s/2,r=i+s/2),[{x:e,y:o},{x:e,y:l},{x:r,y:l},{x:r,y:o}]}At.registerFactory("interval",{defaultShapeType:"rect",getDefaultPoints:t=>ea(t)}),At.registerShape("interval","rect",{draw(t,e){var r=this.parsePoints(t.points),i=O({fill:t.color},st.shape.interval,t.style);if(t.isInCircle){var a=r.slice(0);this._coord.transposed&&(a=[r[0],r[3],r[2],r[1]]);var{x:n,y:s}=t.center,o=[1,0],l=[a[0].x-n,a[0].y-s],h=[a[1].x-n,a[1].y-s],c=[a[2].x-n,a[2].y-s],u=dt.angleTo(o,h),f=dt.angleTo(o,c),g=dt.length(l),d=dt.length(h);return u>=1.5*Math.PI&&(u-=2*Math.PI),f>=1.5*Math.PI&&(f-=2*Math.PI),e.addShape("Sector",{className:"interval",attrs:O({x:n,y:s,r:d,r0:g,startAngle:u,endAngle:f},i)})}var p=function(t){for(var e=[],r=[],i=0,a=t.length;i<a;i++){var n=t[i];e.push(n.x),r.push(n.y)}var s=Math.min.apply(null,e),o=Math.min.apply(null,r);return{x:s,y:o,width:Math.max.apply(null,e)-s,height:Math.max.apply(null,r)-o}}(r);return e.addShape("rect",{className:"interval",attrs:O(p,i)})}}),["pyramid","funnel"].forEach((function(t){At.registerShape("interval",t,{getPoints:t=>(t.size=2*t.size,ea(t)),draw(e,r){var i,a,n=this.parsePoints(e.points),s=this.parsePoints(e.nextPoints),o=null;s?o=[n[0],n[1],s[1],s[0]]:(o=[n[0],n[1]],"pyramid"===t?o.push((i=n[2],a=n[3],{x:(i.x-a.x)/2+a.x,y:(i.y-a.y)/2+a.y})):o.push(n[2],n[3]));var l=O({fill:e.color,points:o},st.shape.interval,e.style);return r.addShape("polygon",{className:"interval",attrs:l})}})}));Gt.Interval=class extends Gt{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="interval",t.shapeType="interval",t.generatePoints=!0,t}constructor(t){super(t),O(this,ta)}init(){super.init(),this.initEvent()}createShapePointsCfg(t){var e=super.createShapePointsCfg(t);return e.size=this.getNormalizedSize(t),e}clearInner(){super.clearInner(),this.set("defaultSize",null)}},At.registerFactory("polygon",{defaultShapeType:"polygon",getDefaultPoints(t){for(var e=[],{x:r,y:i}=t,a=0,n=r.length;a<n;a++)e.push({x:r[a],y:i[a]});return e}}),At.registerShape("polygon","polygon",{draw(t,e){var r=this.parsePoints(t.points),i=O({fill:t.color,points:r},t.style);return e.addShape("Polygon",{className:"polygon",attrs:i})}});Gt.Polygon=class extends Gt{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="polygon",t.shapeType="polygon",t.generatePoints=!0,t}createShapePointsCfg(t){var e,r=super.createShapePointsCfg(t),i=r.x,a=r.y;if(!p(i)||!p(a)){var n=this.getXScale(),s=this.getYScale(),o=.5/(n.values?n.values.length:n.ticks.length),l=.5/(s.values?s.values.length:s.ticks.length);n.isCategory&&s.isCategory?(i=[i-o,i-o,i+o,i+o],a=[a-l,a+l,a+l,a-l]):p(i)?(i=[(e=i)[0],e[0],e[1],e[1]],a=[a-l/2,a+l/2,a+l/2,a-l/2]):p(a)&&(a=[(e=a)[0],e[1],e[1],e[0]],i=[i-o/2,i-o/2,i+o/2,i+o/2]),r.x=i,r.y=a}return r}},At.registerFactory("schema",{}),At.registerShape("schema","candle",{getPoints(t){return e=t.x,r=t.y,i=t.size,a=function(t){var e=t.sort((function(t,e){return t<e?1:-1})),r=e.length;if(r<4)for(var i=e[r-1],a=0;a<4-r;a++)e.push(i);return e}(r),[{x:e,y:a[0]},{x:e,y:a[1]},{x:e-i/2,y:a[2]},{x:e-i/2,y:a[1]},{x:e+i/2,y:a[1]},{x:e+i/2,y:a[2]},{x:e,y:a[2]},{x:e,y:a[3]}];var e,r,i,a},draw(t,e){var r=this.parsePoints(t.points),i=O({stroke:t.color,fill:t.color,lineWidth:1},t.style);return e.addShape("Custom",{className:"schema",attrs:i,createPath(t){t.beginPath(),t.moveTo(r[0].x,r[0].y),t.lineTo(r[1].x,r[1].y),t.moveTo(r[2].x,r[2].y);for(var e=3;e<6;e++)t.lineTo(r[e].x,r[e].y);t.closePath(),t.moveTo(r[6].x,r[6].y),t.lineTo(r[7].x,r[7].y)}})}});function ra(){if(Oi)return Yi;Oi=1;var t={}.toString;return Yi=function(e,r){return t.call(e)==="[object "+r+"]"}}function ia(){if(ji)return Ni;ji=1;var t=ra(),e=Array.isArray?Array.isArray:function(e){return t(e,"Array")};return Ni=e}function aa(){if(Gi)return Ri;Gi=1;var t=function(){if(Xi)return Bi;Xi=1;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return Bi=function(e){var r=void 0===e?"undefined":t(e);return null!==e&&"object"===r||"function"===r}}(),e=ia();return Ri=function(r,i){if(r){if(e(r))for(var a=0,n=r.length;a<n&&!1!==i(r[a],a);a++);else if(t(r))for(var s in r)if(r.hasOwnProperty(s)&&!1===i(r[s],s))break}}}function na(){if(Ui)return Zi;Ui=1;var t=ia(),e=function(){if(qi)return Vi;qi=1;var t=ra();return Vi=function(e){return t(e,"Function")}}(),r=aa();return Zi=function(i,a){if(t(i)){var n=i[0],s=void 0;s=e(a)?a(i[0]):i[0][a];var o=void 0;return r(i,(function(t){(o=e(a)?a(t):t[a])>s&&(n=t,s=o)})),n}}}function sa(){if($i)return Ji;$i=1;return Ji=function(t){for(var e=[],r=0;r<t.length;r++)e=e.concat(t[r]);return e}}Gt.Schema=class extends Gt{getDefaultCfg(){var t=super.getDefaultCfg();return t.type="schema",t.shapeType="schema",t.generatePoints=!0,t}constructor(t){super(t),O(this,ta)}init(){super.init(),this.initEvent()}createShapePointsCfg(t){var e=super.createShapePointsCfg(t);return e.size=this.getNormalizedSize(t),e}clearInner(){super.clearInner(),this.set("defaultSize",null)}},function(){if(Li)return zi;Li=1;var t=ia(),e=Fi?Ei:(Fi=1,Ei=function(t){return null==t}),r=Ot(),i=function(r){var i,a;function n(){return r.apply(this,arguments)||this}a=r,(i=n).prototype=Object.create(a.prototype),i.prototype.constructor=i,i.__proto__=a;var s=n.prototype;return s._initDefaultCfg=function(){this.xField=null,this.yField=null},s.processAdjust=function(t){this.processStack(t)},s.processStack=function(r){var i=this,a=i.xField,n=i.yField,s=r.length,o={positive:{},negative:{}};i.reverseOrder&&(r=r.slice(0).reverse());for(var l=0;l<s;l++)for(var h=r[l],c=0,u=h.length;c<u;c++){var f=h[c],g=f[a]||0,d=f[n],p=g.toString();if(d=t(d)?d[1]:d,!e(d)){var v=d>=0?"positive":"negative";o[v][p]||(o[v][p]=0),f[n]=[o[v][p],d+o[v][p]],o[v][p]+=d}}},n}(r);r.Stack=i,zi=i}(),function(){if(Wi)return Hi;Wi=1;var t=Ot(),e=aa(),r=function(t){var r,i;function a(){return t.apply(this,arguments)||this}i=t,(r=a).prototype=Object.create(i.prototype),r.prototype.constructor=r,r.__proto__=i;var n=a.prototype;return n._initDefaultCfg=function(){this.marginRatio=.5,this.dodgeRatio=.5,this.adjustNames=["x","y"]},n.getDodgeOffset=function(t,e,r){var i=t.pre,a=t.next,n=a-i,s=n*this.dodgeRatio/r,o=this.marginRatio*s;return(i+a)/2+(.5*(n-r*s-(r-1)*o)+((e+1)*s+e*o)-.5*s-.5*n)},n.processAdjust=function(t){var r=this,i=t.length,a=r.xField;e(t,(function(t,e){for(var n=0,s=t.length;n<s;n++){var o=t[n],l=o[a],h={pre:1===s?l-1:l-.5,next:1===s?l+1:l+.5},c=r.getDodgeOffset(h,e,i);o[a]=c}}))},a}(t);t.Dodge=r,Hi=r}(),function(){if(Qi)return Ki;Qi=1;var t=aa(),e=na(),r=ia(),i={merge:sa()},a=Ot(),n=function(a){var n,s;function o(){return a.apply(this,arguments)||this}s=a,(n=o).prototype=Object.create(s.prototype),n.prototype.constructor=n,n.__proto__=s;var l=o.prototype;return l._initDefaultCfg=function(){this.xField=null,this.yField=null,this.cacheMax=null,this.adjustNames=["y"],this.groupFields=null},l._getMax=function(t){var i=this.mergeData,a=e(i,(function(e){var i=e[t];return r(i)?Math.max.apply(null,i):i}))[t];return r(a)?Math.max.apply(null,a):a},l._getXValuesMax=function(){var e=this,i=e.yField,a=e.xField,n={},s=e.mergeData;return t(s,(function(t){var e=t[a],s=t[i],o=r(s)?Math.max.apply(null,s):s;n[e]=n[e]||0,n[e]<o&&(n[e]=o)})),n},l.processAdjust=function(t){var e=this,r=i.merge(t);e.mergeData=r,e._processSymmetric(t),e.mergeData=null},l._processSymmetric=function(e){var i,a=this,n=a.xField,s=a.yField,o=a._getMax(s),l=e[0][0];l&&r(l[s])&&(i=a._getXValuesMax()),t(e,(function(e){t(e,(function(e){var a,l=e[s];if(r(l)){var h=e[n],c=i[h];a=(o-c)/2;var u=[];t(l,(function(t){u.push(a+t)})),e[s]=u}else a=(o-l)/2,e[s]=[a,l+a]}))}))},o}(a);a.Symmetric=n,Ki=n}();vt.Polar=class extends vt{_initDefaultCfg(){this.type="polar",this.startAngle=-Math.PI/2,this.endAngle=3*Math.PI/2,this.inner=0,this.innerRadius=0,this.isPolar=!0,this.transposed=!1,this.center=null,this.radius=null}init(t,e){super.init(t,e);var r,i,a=this,n=a.inner||a.innerRadius,s=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);a.startAngle===-Math.PI&&0===a.endAngle?(r=Math.min(s/2,o),i={x:(t.x+e.x)/2,y:t.y}):(r=Math.min(s,o)/2,i={x:(t.x+e.x)/2,y:(t.y+e.y)/2});var l=a.radius;l>0&&l<=1&&(r*=l),this.x={start:a.startAngle,end:a.endAngle},this.y={start:r*n,end:r},this.center=i,this.circleRadius=r}_convertPoint(t){var e=this,r=e.center,i=e.transposed,a=i?"y":"x",n=i?"x":"y",s=e.x,o=e.y,l=s.start+(s.end-s.start)*t[a],h=o.start+(o.end-o.start)*t[n];return{x:r.x+Math.cos(l)*h,y:r.y+Math.sin(l)*h}}_invertPoint(t){var{center:e,transposed:r,x:i,y:a}=this,n=r?"y":"x",s=r?"x":"y",o=[1,0,0,1,0,0];gt.rotate(o,o,i.start);var l=[1,0];dt.transformMat2d(l,l,o),l=[l[0],l[1]];var h=[t.x-e.x,t.y-e.y];if(dt.zero(h))return{x:0,y:0};var c=dt.angleTo(l,h,i.end<i.start);Math.abs(c-2*Math.PI)<.001&&(c=0);var u=dt.length(h),f=c/(i.end-i.start);f=i.end-i.start>0?f:-f;var g=(u-a.start)/(a.end-a.start),d={};return d[n]=f,d[s]=g,d}};jr.Circle=class extends jr{_initDefaultCfg(){super._initDefaultCfg(),this.startAngle=-Math.PI/2,this.endAngle=3*Math.PI/2,this.radius=null,this.center=null}getOffsetPoint(t){var{startAngle:e,endAngle:r}=this,i=e+(r-e)*t;return this._getCirclePoint(i)}_getCirclePoint(t,e){var r=this.center;return e=e||this.radius,{x:r.x+Math.cos(t)*e,y:r.y+Math.sin(t)*e}}getTextAlignInfo(t,e){var r,i=this.getOffsetVector(t,e),a="middle";return i[0]>0?r="left":i[0]<0?r="right":(r="center",i[1]>0?a="top":i[1]<0&&(a="bottom")),{textAlign:r,textBaseline:a}}getAxisVector(t){var e=this.center,r=this.offsetFactor;return[(t.y-e.y)*r,-1*(t.x-e.x)*r]}drawLine(t){var{center:e,radius:r,startAngle:i,endAngle:a}=this;this.getContainer(t.top).addShape("arc",{className:"axis-line",attrs:O({x:e.x,y:e.y,r:r,startAngle:i,endAngle:a},t)})}};var oa={min:0,median:.5,max:1};class la{_initDefaultCfg(){}constructor(t){this._initDefaultCfg(),j(this,t)}_getNormalizedValue(t,e){return d(oa[t])?e.scale(t):oa[t]}parsePercentPoint(t,e){var r=parseFloat(e[0])/100,i=parseFloat(e[1])/100,a=t.start,n=t.end,s=Math.abs(a.x-n.x),o=Math.abs(a.y-n.y);return{x:s*r+Math.min(a.x,n.x),y:o*i+Math.min(a.y,n.y)}}parsePoint(t,e){var r=this,i=r.xScale,a=r.yScales;if(g(e)&&(e=e(i,a)),_(e[0])&&-1!==e[0].indexOf("%")&&!isNaN(e[0].slice(0,-1)))return this.parsePercentPoint(t,e);var n=r._getNormalizedValue(e[0],i),s=r._getNormalizedValue(e[1],a[0]),o=t.convertPoint({x:n,y:s});return r.limitInPlot?n>=0&&n<=1&&s>=0&&s<=1?o:null:o}render(){}repaint(){this.remove();var{coord:t,container:e,canvas:r}=this;e&&!e.isDestroyed()&&(this.render(t,e),r.draw())}remove(){var{element:t}=this;t&&t.remove(!0)}changeVisible(t){this.visible=t;var e=this.element;e&&(e.set?e.set("visible",t):e.style.display=t?"":"none")}}function ha(t,e){for(var r in e)e.hasOwnProperty(r)&&(t.style[r]=e[r]);return t}function ca(t){var e=document.createElement("div");return t=t.replace(/(^\s*)|(\s*$)/g,""),e.innerHTML=""+t,e.childNodes[0]}la.Arc=class extends la{_initDefaultCfg(){this.type="arc",this.start=[],this.end=[],this.style={stroke:"#999",lineWidth:1}}render(t,e){var r=this,i=r.parsePoint(t,r.start),a=r.parsePoint(t,r.end);if(i&&a){var n=t.center,s=Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y)),o=Math.atan2(i.y-n.y,i.x-n.x),l=Math.atan2(a.y-n.y,a.x-n.x),h=e.addShape("arc",{className:"guide-arc",attrs:O({x:n.x,y:n.y,r:s,startAngle:o,endAngle:l},r.style)});return r.element=h,h}}};la.Html=class extends la{_initDefaultCfg(){this.type="html",this.position=null,this.alignX="center",this.alignY="middle",this.offsetX=null,this.offsetY=null,this.html=null}render(t,e){var r=this,i=r.parsePoint(t,r.position);if(i){var a=ca(r.html);a=ha(a,{position:"absolute",top:Math.floor(i.y)+"px",left:Math.floor(i.x)+"px",visibility:"hidden"});var n=e.get("canvas").get("el"),s=n.parentNode;s=ha(s,{position:"relative"});var o=ca('<div class="guideWapper" style="position: absolute;top: 0; left: 0;"></div>');s.appendChild(o),o.appendChild(a);var l=n.offsetTop,h=n.offsetLeft,{alignX:c,alignY:u,offsetX:f,offsetY:g}=r,d=function(t,e,r,i){var a=[];return"left"===t&&"top"===e?(a[0]=0,a[1]=0):"right"===t&&"top"===e?(a[0]=-r,a[1]=0):"left"===t&&"bottom"===e?(a[0]=0,a[1]=Math.floor(-i)):"right"===t&&"bottom"===e?(a[0]=Math.floor(-r),a[1]=Math.floor(-i)):"right"===t&&"middle"===e?(a[0]=Math.floor(-r),a[1]=Math.floor(-i/2)):"left"===t&&"middle"===e?(a[0]=0,a[1]=Math.floor(-i/2)):"center"===t&&"bottom"===e?(a[0]=Math.floor(-r/2),a[1]=Math.floor(-i)):"center"===t&&"top"===e?(a[0]=Math.floor(-r/2),a[1]=0):(a[0]=Math.floor(-r/2),a[1]=Math.floor(-i/2)),a}(c,u,V(a),q(a));i.x=i.x+d[0]+h,i.y=i.y+d[1]+l,f&&(i.x+=f),g&&(i.y+=g),ha(a,{top:Math.floor(i.y)+"px",left:Math.floor(i.x)+"px",visibility:"visible"}),r.element=o}}remove(){var t=this.element;t&&t.parentNode&&t.parentNode.removeChild(t)}};la.Line=class extends la{_initDefaultCfg(){this.type="line",this.start=[],this.end=[],this.style={stroke:"#000",lineWidth:1}}render(t,e){var r=[];if(r[0]=this.parsePoint(t,this.start),r[1]=this.parsePoint(t,this.end),r[0]&&r[1]){var i=e.addShape("Line",{className:"guide-line",attrs:O({x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y},this.style)});return this.element=i,i}}};la.Rect=class extends la{_initDefaultCfg(){this.type="rect",this.start=[],this.end=[],this.style={fill:"#CCD7EB",opacity:.4}}render(t,e){var r=this.parsePoint(t,this.start),i=this.parsePoint(t,this.end);if(r&&i){var a=e.addShape("rect",{className:"guide-rect",attrs:O({x:Math.min(r.x,i.x),y:Math.min(r.y,i.y),width:Math.abs(i.x-r.x),height:Math.abs(r.y-i.y)},this.style)});return this.element=a,a}}};la.Text=class extends la{_initDefaultCfg(){this.type="text",this.position=null,this.content=null,this.style={fill:"#000"},this.offsetX=0,this.offsetY=0}render(t,e){var r=this.position,i=this.parsePoint(t,r);if(i){var{content:a,style:n,offsetX:s,offsetY:o}=this;s&&(i.x+=s),o&&(i.y+=o);var l=e.addShape("text",{className:"guide-text",attrs:O({x:i.x,y:i.y,text:a},n)});return this.element=l,l}}};la.Tag=class extends la{_initDefaultCfg(){this.type="tag",this.position=null,this.content=null,this.direct="tl",this.autoAdjust=!0,this.offsetX=0,this.offsetY=0,this.side=4,this.background={padding:5,radius:2,fill:"#1890FF"},this.textStyle={fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"},this.withPoint=!0,this.pointStyle={fill:"#1890FF",r:3,lineWidth:1,stroke:"#fff"}}_getDirect(t,e,r,i){var a=this.direct,n=this.side,s=t.get("canvas"),o=s.get("width"),l=s.get("height"),{x:h,y:c}=e,u=a[0],f=a[1];"t"===u&&c-n-i<0?u="b":"b"===u&&c+n+i>l&&(u="t");var g="c"===u?n:0;return"l"===f&&h-g-r<0?f="r":"r"===f&&h+g+r>o?f="l":"c"===f&&(r/2+h+g>o?f="l":h-r/2-g<0&&(f="r")),a=u+f}render(t,e){var r=this.parsePoint(t,this.position);if(r&&!isNaN(r.x)&&!isNaN(r.y)){var{content:i,background:a,textStyle:n}=this,s=[],o=e.addGroup({className:"guide-tag"});if(this.withPoint){var l=o.addShape("Circle",{className:"guide-tag-point",attrs:O({x:r.x,y:r.y},this.pointStyle)});s.push(l)}var h=o.addGroup(),c=h.addShape("text",{className:"guide-tag-text",zIndex:1,attrs:O({x:0,y:0,text:i},n)});s.push(c);var u=c.getBBox(),f=Q(a.padding),g=u.width+f[1]+f[3],d=u.height+f[0]+f[2],p=u.minY-f[0],v=u.minX-f[3],m=h.addShape("rect",{className:"guide-tag-bg",zIndex:-1,attrs:O({x:v,y:p,width:g,height:d},a)});s.push(m);var y,x=this.autoAdjust?this._getDirect(e,r,g,d):this.direct,_=this.side,S=r.x+this.offsetX,b=r.y+this.offsetY,M=Q(a.radius);"tl"===x?(y=[{x:g+v-_-1,y:d+p-1},{x:g+v,y:d+p-1},{x:g+v,y:d+_+p}],M[2]=0,S-=g,b=b-_-d):"cl"===x?(y=[{x:g+v-1,y:(d-_)/2+p-1},{x:g+v-1,y:(d+_)/2+p+1},{x:g+_+v,y:d/2+p}],S=S-g-_,b-=d/2):"bl"===x?(y=[{x:g+v,y:-_+p},{x:g+v-_-1,y:p+1},{x:g+v,y:p+1}],M[1]=0,S-=g,b+=_):"bc"===x?(y=[{x:g/2+v,y:-_+p},{x:(g-_)/2+v-1,y:p+1},{x:(g+_)/2+v+1,y:p+1}],S-=g/2,b+=_):"br"===x?(y=[{x:v,y:p-_},{x:v,y:p+1},{x:v+_+1,y:p+1}],M[0]=0,b+=_):"cr"===x?(y=[{x:v-_,y:d/2+p},{x:v+1,y:(d-_)/2+p-1},{x:v+1,y:(d+_)/2+p+1}],S+=_,b-=d/2):"tr"===x?(y=[{x:v,y:d+_+p},{x:v,y:d+p-1},{x:_+v+1,y:d+p-1}],M[3]=0,b=b-d-_):"tc"===x&&(y=[{x:(g-_)/2+v-1,y:d+p-1},{x:(g+_)/2+v+1,y:d+p-1},{x:g/2+v,y:d+_+p}],S-=g/2,b=b-d-_);var w=h.addShape("Polygon",{className:"guide-tag-side",zIndex:0,attrs:{points:y,fill:a.fill}});return s.push(w),m.attr("radius",M),h.moveTo(S-v,b-p),h.sort(),this.element=o,s}}};la.Point=class extends la{_initDefaultCfg(){this.type="point",this.position=null,this.offsetX=0,this.offsetY=0,this.style={fill:"#1890FF",r:3,lineWidth:1,stroke:"#fff"}}render(t,e){var r=this.parsePoint(t,this.position);if(!r)return null;var i=e.addShape("Circle",{className:"guide-point",attrs:O({x:r.x+this.offsetX,y:r.y+this.offsetY},this.style)});return this.element=i,i}};class ua{getDefaultCfg(){return{showTitle:!1,title:null,items:null,titleGap:12,itemGap:10,itemMarginBottom:12,itemFormatter:null,itemWidth:null,wordSpace:6,x:0,y:0,layout:"horizontal",joinString:": "}}constructor(t){j(this,this.getDefaultCfg(),t),this._init(),this._renderTitle(),this._renderItems()}_init(){var t=this.parent;if(t){var e=t.addGroup({zIndex:this.zIndex||0});this.container=e;var r=e.addGroup();this.wrapper=r;var i=r.addGroup({className:"itemsGroup"});this.itemsGroup=i}}_renderTitle(t){t=t||this.title;var e=this.titleShape,r=0;if(this.showTitle&&t){if(e&&!e.get("destroyed"))e.attr("text",t);else{var{wrapper:i,titleStyle:a}=this;e=i.addShape("text",{className:"title",attrs:O({x:0,y:0,text:t},a)}),this.titleShape=e}r=e.getBBox().height+this.titleGap}this._titleHeight=r}_renderItems(t){var e=this;(t=t||e.items)&&(e.reversed&&t.reverse(),m(t,(function(t,r){e._addItem(t,r)})),t.length>1&&this._adjustItems(),this._renderBackground())}_renderBackground(){var t=this.background;if(t){var e=this.container,r=this.wrapper,{minX:i,minY:a,width:n,height:s}=r.getBBox(),o=t.padding||[0,0,0,0],l=O({x:i-(o=Q(o))[3],y:a-o[0],width:n+o[1]+o[3],height:s+o[0]+o[2]},t),h=this.backShape;h?h.attr(l):h=e.addShape("Rect",{zIndex:-1,attrs:l}),this.backShape=h,e.sort()}}_addItem(t){var e,r=this.itemsGroup.addGroup({name:t.name,value:t.value,dataValue:t.dataValue,checked:t.checked}),{unCheckStyle:i,unCheckColor:a,nameStyle:n,valueStyle:s,wordSpace:o}=this,{marker:l,value:h}=t,c=0;if(a&&(i.fill=a),l){var u=O({x:l.radius||3,y:this._titleHeight},l);!1===t.checked&&O(u,i),c+=r.addShape("marker",{className:"item-marker",attrs:u}).getBBox().width+o}var f=t.name;if(f){var g=this.joinString||"";f=h?f+g:f,e=r.addShape("text",{className:"name",attrs:O({x:c,y:this._titleHeight,text:this._formatItemValue(f)},n,!1===t.checked?i:null)})}if(h){var d=c;e&&(d+=e.getBBox().width),r.addShape("text",{className:"value",attrs:O({x:d,y:this._titleHeight,text:h},s,!1===t.checked?i:null)})}return r}_formatItemValue(t){var e=this.itemFormatter;return e&&(t=e.call(this,t)),t}_getMaxItemWidth(){var t=this.itemWidth;if(w(t)||d(t))return t;if("auto"===t){for(var e=this.itemsGroup.get("children"),r=e.length,i=0,a=0;a<r;a++){var{width:n}=e[a].getBBox();i=Math.max(i,n)}var s=this.maxLength,o=this.itemGap,l=(s-o)/2,h=(s-2*o)/3;return 2===r?Math.max(i,l):i<=h?h:i<=l?l:i}}_adjustHorizontal(){for(var t,e,{maxLength:r,itemsGroup:i}=this,a=i.get("children"),{itemGap:n,itemMarginBottom:s}=this,o=this._titleHeight,l=0,h=0,c=this._getMaxItemWidth(),u=[],f=0,g=a.length;f<g;f++){var d=a[f],p=d.getBBox(),v=p.height,m=p.width;e=v+s,(t=c||m)-(r-h)>1e-4&&(l++,h=0),d.moveTo(h,l*e),u.push({x:h,y:l*e+o-v/2,width:1.375*m,height:1.375*v}),h+=t+n}this.legendHitBoxes=u}_adjustVertical(){for(var t,e,{maxLength:r,itemsGroup:i}=this,{itemGap:a,itemMarginBottom:n,itemWidth:s}=this,o=this._titleHeight,l=i.get("children"),h=0,c=0,u=0,f=[],g=0,d=l.length;g<d;g++){var p=l[g],v=p.getBBox();t=v.width,e=v.height,w(s)?c=s+a:t>c&&(c=t+a),r-h<e?(h=0,u+=c,p.moveTo(u,0),f.push({x:u,y:o-e/2,width:1.375*t,height:1.375*e})):(p.moveTo(u,h),f.push({x:u,y:h-e/2+o,width:1.375*t,height:1.375*e})),h+=e+n}this.legendHitBoxes=f}_adjustItems(){"horizontal"===this.layout?this._adjustHorizontal():this._adjustVertical()}moveTo(t,e){this.x=t,this.y=e;var r=this.container;return r&&r.moveTo(t,e),this}setItems(t){this.clearItems(),this._renderItems(t)}setTitle(t){this._renderTitle(t)}clearItems(){this.itemsGroup.clear()}getWidth(){return this.container.getBBox().width}getHeight(){return this.container.getBBox().height}show(){this.container.show()}hide(){this.container.hide()}clear(){var t=this.container;t.clear(),t.remove(!0)}}class fa{getDefaultCfg(){return{x:0,y:0,content:"",textStyle:{fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle",fontFamily:"Arial"},background:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},width:0,height:0,className:""}}constructor(t){j(this,this.getDefaultCfg(),t),this._init();var{content:e,x:r,y:i}=this;d(e)||this.updateContent(e),this.updatePosition(r,i)}_init(){var{content:t,textStyle:e,background:r,className:i,visible:a,context:n}=this,s=new pi({context:n,className:i,zIndex:0,visible:a}),o=s.addShape("Text",{className:i+"-text",zIndex:1,attrs:O({text:t,x:0,y:0},e)}),l=s.addShape("Rect",{className:i+"-bg",zIndex:-1,attrs:O({x:0,y:0,width:0,height:0},r)});s.sort(),this.container=s,this.textShape=o,this.backgroundShape=l}_getBBox(){var t=this.textShape,e=this.background,r=t.getBBox(),i=Q(e.padding),a=r.width+i[1]+i[3],n=r.height+i[0]+i[2];return{x:r.minX-i[3],y:r.minY-i[0],width:a,height:n}}updateContent(t){var{textShape:e,backgroundShape:r}=this;if(!d(t)){v(t)||(t={text:t}),e.attr(t);var{x:i,y:a,width:n,height:s}=this._getBBox(),o=this.width||n,l=this.height||s;r.attr({x:i,y:a,width:o,height:l}),this._width=o,this._height=l,this.content=t.text}}updatePosition(t,e){var r=this.container,{x:i,y:a}=this._getBBox();r.moveTo(t-i,e-a),this.x=t-i,this.y=e-a}getWidth(){return this._width}getHeight(){return this._height}show(){this.container.show()}hide(){this.container.hide()}clear(){var t=this.container;t.clear(),t.remove(!0),this.container=null,this.textShape=null,this.backgroundShape=null}}let ga=class{getDefaultCfg(){return{showCrosshairs:!1,crosshairsStyle:{stroke:"rgba(0, 0, 0, 0.25)",lineWidth:1},crosshairsType:"y",showXTip:!1,showYTip:!1,xTip:null,xTipBackground:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},xTipTextStyle:{fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"},yTip:null,yTipBackground:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},yTipTextStyle:{fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"},background:null,layout:"horizontal",offsetX:0,offsetY:0}}constructor(t){j(this,this.getDefaultCfg(),t);var{frontPlot:e,custom:r}=this;if(!r){var i=new ua(O({parent:e,zIndex:3},t));this.container=i;var{fixed:a,background:n}=this;a||(this.tooltipArrow=e.addShape("Polygon",{className:"tooltip-arrow",visible:!1,zIndex:2,attrs:O({points:[]},n)}))}if(this.showXTip){var{xTipBackground:s,xTipTextStyle:o}=this,l=new fa({context:e.get("context"),className:"xTip",background:s,textStyle:o,visible:!1});e.add(l.container),this.xTipBox=l}if(this.showYTip){var{yTipBackground:h,yTipTextStyle:c}=this,u=new fa({context:e.get("context"),className:"yTip",background:h,textStyle:c,visible:!1});e.add(u.container),this.yTipBox=u}this.showCrosshairs&&this._renderCrosshairs(),e.sort()}setContent(t,e){if(this.title=t,this.items=e,!this.custom){var r=this.container;r.setTitle(t),r.setItems(e)}}setYTipContent(t){var e=this.yTip;t=g(e)?e(t):O({text:t},e),this.yTipBox&&this.yTipBox.updateContent(t)}setYTipPosition(t){var e=this.plotRange,r=this.crosshairsShapeX;if(this.showYTip){var i=this.yTipBox,a=i.getHeight(),n=i.getWidth(),s=e.tl.x-n,o=t-a/2;o<=e.tl.y&&(o=e.tl.y),o+a>=e.br.y&&(o=e.br.y-a),s<0&&(s=e.tl.x,r&&r.attr("x1",e.tl.x+n)),i.updatePosition(s,o)}}setXTipContent(t){var e=this.xTip;t=g(e)?e(t):O({text:t},e),this.xTipBox&&this.xTipBox.updateContent(t)}setXTipPosition(t){var{showXTip:e,canvas:r,plotRange:i,xTipBox:a,crosshairsShapeY:n}=this;if(e){var s=r.get("height"),o=a.getWidth(),l=a.getHeight(),h=t-o/2,c=i.br.y;h<=i.tl.x&&(h=i.tl.x),h+o>=i.tr.x&&(h=i.tr.x-o),s-c<l&&(c-=l),a.updatePosition(h,c),n&&n.attr("y1",c)}}setXCrosshairPosition(t){this.crosshairsShapeX&&this.crosshairsShapeX.moveTo(0,t)}setYCrosshairPosition(t){this.crosshairsShapeY&&this.crosshairsShapeY.moveTo(t,0)}setPosition(t){var{container:e,plotRange:r,offsetX:i,offsetY:a,fixed:n,tooltipArrow:s}=this;if(e){var o,l=e.container.getBBox(),{minX:h,minY:c,width:u,height:f}=l,{tl:g,tr:d}=r,p=0,v=g.y-f-4+a;if(v<0&&(v=0),n)p=(g.x+d.x)/2-u/2+i;else if((p=(o=t.length>1?(t[0].x+t[t.length-1].x)/2:t[0].x)-u/2+i)<g.x&&(p=g.x),p+u>d.x&&(p=d.x-u),s){var m=v+f;s.attr("points",[{x:o-3,y:m},{x:o+3,y:m},{x:o,y:m+4}]);var y=e.backShape,x=Q(y.attr("radius"));o===g.x?(x[3]=0,s.attr("points",[{x:g.x,y:m},{x:g.x+4,y:m},{x:g.x,y:m+4}])):o===d.x&&(x[2]=0,s.attr("points",[{x:d.x-4,y:m},{x:d.x,y:m},{x:d.x,y:m+4}])),y.attr("radius",x)}e.moveTo(p-h,v-c)}}setMarkers(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{items:e,style:r,type:i}=t,a=this._getMarkerGroup(i);if("circle"===i)for(var n=0,s=e.length;n<s;n++){var o=e[n];a.addShape("marker",{className:"tooltip-circle-marker",attrs:O({x:o.x,y:o.y,stroke:o.color},r)})}else a.addShape("rect",{className:"tooltip-rect-marker",attrs:r})}clearMarkers(){var t=this.markerGroup;t&&t.clear()}show(){var t=this.crosshairsShapeX,e=this.crosshairsShapeY,r=this.markerGroup,i=this.container,a=this.tooltipArrow,n=this.xTipBox,s=this.yTipBox,o=this.canvas;t&&t.show(),e&&e.show(),r&&r.show(),i&&i.show(),a&&a.show(),n&&n.show(),s&&s.show(),o.draw()}hide(){var t=this.crosshairsShapeX,e=this.crosshairsShapeY,r=this.markerGroup,i=this.container,a=this.tooltipArrow,n=this.xTipBox,s=this.yTipBox;t&&t.hide(),e&&e.hide(),r&&r.hide(),i&&i.hide(),a&&a.hide(),n&&n.hide(),s&&s.hide()}destroy(){var t=this.crosshairsShapeX,e=this.crosshairsShapeY,r=this.markerGroup,i=this.container,a=this.tooltipArrow,n=this.xTipBox,s=this.yTipBox;t&&t.remove(!0),e&&e.remove(!0),r&&r.remove(!0),a&&a.remove(!0),i&&i.clear(),n&&n.clear(),s&&s.clear(),this.destroyed=!0}_getMarkerGroup(t){var e=this.markerGroup;return e?e.clear():("circle"===t?(e=this.frontPlot.addGroup({zIndex:1}),this.frontPlot.sort()):e=this.backPlot.addGroup(),this.markerGroup=e),e}_renderCrosshairs(){var{crosshairsType:t,crosshairsStyle:e,frontPlot:r,plotRange:i}=this,{tl:a,br:n}=i;tt(t,"x")&&(this.crosshairsShapeX=r.addShape("Line",{className:"tooltip-crosshairs-x",zIndex:0,visible:!1,attrs:O({x1:a.x,y1:0,x2:n.x,y2:0},e)})),tt(t,"y")&&(this.crosshairsShapeY=r.addShape("Line",{className:"tooltip-crosshairs-y",zIndex:0,visible:!1,attrs:O({x1:0,y1:n.y,x2:0,y2:a.y},e)}))}};function da(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pa(t){var e=t.getAttr("color");if(e){var r=e.getScale(e.type);if(r.isLinear)return r}var i=t.getXScale(),a=t.getYScale();return a||i}function va(t,e){var r,i,a=t._getGroupScales();if(a.length&&m(a,(function(t){return i=t,!1})),i){var n=i.field;r=i.getText(e[n])}else{var s=pa(t);r=s.alias||s.field}return r}function ma(t,e){var r=pa(t);return r.getText(e[r.field])}function ya(t,e){var r=t.getAttr("position").getFields()[0],i=t.get("scales")[r];return i.getText(e[i.field])}function xa(t){var e=[];return m(t,(function(t){var r=function(t,e){var r=-1;return m(t,(function(t,i){if(t.title===e.title&&t.name===e.name&&t.value===e.value&&t.color===e.color)return r=i,!1})),r}(e,t);-1===r?e.push(t):e[r]=t})),e}st.tooltip=j({triggerOn:"press",triggerOff:"pressend",alwaysShow:!1,showTitle:!1,showCrosshairs:!1,crosshairsStyle:{stroke:"rgba(0, 0, 0, 0.25)",lineWidth:1},showTooltipMarker:!0,background:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},titleStyle:{fontSize:12,fill:"#fff",textAlign:"start",textBaseline:"top"},nameStyle:{fontSize:12,fill:"rgba(255, 255, 255, 0.65)",textAlign:"start",textBaseline:"middle"},valueStyle:{fontSize:12,fill:"#fff",textAlign:"start",textBaseline:"middle"},showItemMarker:!0,itemMarkerStyle:{radius:3,symbol:"circle",lineWidth:1,stroke:"#fff"},layout:"horizontal",snap:!1},st.tooltip||{});class _a{constructor(t){var e=this;da(this,"handleShowEvent",(function(t){var r=e.chart;if(e.enable){var i=r.get("plotRange"),a=$(t,r);if(Si(a,i)||e._tooltipCfg.alwaysShow){var n=e.timeStamp,s=+new Date;s-n>16&&(e.showTooltip(a),e.timeStamp=s)}else e.hideTooltip()}})),da(this,"handleHideEvent",(function(){e.enable&&e.hideTooltip()})),this.enable=!0,this.cfg={},this.tooltip=null,this.chart=null,this.timeStamp=0,O(this,t);var r=this.chart.get("canvas");this.canvas=r,this.canvasDom=r.get("el")}_setCrosshairsCfg(){var t=this.chart,e=O({},st.tooltip),r=t.get("geoms"),i=[];m(r,(function(t){var e=t.get("type");-1===i.indexOf(e)&&i.push(e)}));var a=t.get("coord").type;return!r.length||"cartesian"!==a&&"rect"!==a||1===i.length&&-1!==["line","area","path","point"].indexOf(i[0])&&O(e,{showCrosshairs:!0}),e}_getMaxLength(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{layout:e,plotRange:r}=t;return"horizontal"===e?r.br.x-r.bl.x:r.bl.y-r.tr.y}render(){var t=this;if(!t.tooltip){var e=t.chart,r=e.get("canvas"),i=e.get("frontPlot").addGroup({className:"tooltipContainer",zIndex:10}),a=e.get("backPlot").addGroup({className:"tooltipContainer"}),n=e.get("plotRange"),s=e.get("coord"),o=t._setCrosshairsCfg(),l=t.cfg,h=j({plotRange:n,frontPlot:i,backPlot:a,canvas:r,fixed:s.transposed||s.isPolar},o,l);h.maxLength=t._getMaxLength(h),this._tooltipCfg=h;var c=new ga(h);t.tooltip=c,h.alwaysShow&&t.prePoint&&this.showTooltip(t.prePoint),t.bindEvents()}}clear(){var t=this.tooltip;t&&(t.destroy(),this.unBindEvents()),this.tooltip=null,this._lastActive=null}_getTooltipMarkerStyle(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{type:e,items:r}=t,i=this._tooltipCfg;if("rect"===e){var a,n,s,o,l=this.chart,{tl:h,br:c}=l.get("plotRange"),u=l.get("coord"),f=r[0],g=r[r.length-1],d=f.width;u.transposed?(a=h.x,n=g.y-.75*d,s=c.x-h.x,o=f.y-g.y+1.5*d):(a=f.x-.75*d,n=h.y,s=g.x-f.x+1.5*d,o=c.y-h.y),t.style=O({x:a,y:n,width:s,height:o,fill:"#CCD6EC",opacity:.3},i.tooltipMarkerStyle)}else t.style=O({radius:4,fill:"#fff",lineWidth:2},i.tooltipMarkerStyle);return t}_setTooltip(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.prePoint=t;var i=this._lastActive,a=this.tooltip,n=this._tooltipCfg;e=xa(e);var s=this.chart,o=s.get("coord"),l=s.getYScales()[0],h=n.snap;if(!1===h&&l.isLinear){var c,u,f=o.invertPoint(t);Si(t,s.get("plotRange"))&&(o.transposed?(c=l.invert(f.x),u=t.x,a.setXTipContent(c),a.setXTipPosition(u),a.setYCrosshairPosition(u)):(c=l.invert(f.y),u=t.y,a.setYTipContent(c),a.setYTipPosition(u),a.setXCrosshairPosition(u)))}if(n.onShow&&n.onShow({x:t.x,y:t.y,tooltip:a,items:e,tooltipMarkerCfg:r}),g=i,d=e,JSON.stringify(g)!==JSON.stringify(d)){var g,d;this._lastActive=e;var p=n.onChange;p&&p({x:t.x,y:t.y,tooltip:a,items:e,tooltipMarkerCfg:r});var v=e[0],m=v.title||v.name,y=v.x;if(e.length>1&&(y=(e[0].x+e[e.length-1].x)/2),a.setContent(m,e,o.transposed),a.setPosition(e,t),o.transposed){var x=v.y;e.length>1&&(x=(e[0].y+e[e.length-1].y)/2),a.setYTipContent(m),a.setYTipPosition(x),a.setXCrosshairPosition(x),h&&(a.setXTipContent(v.value),a.setXTipPosition(y),a.setYCrosshairPosition(y))}else a.setXTipContent(m),a.setXTipPosition(y),a.setYCrosshairPosition(y),h&&(a.setYTipContent(v.value),a.setYTipPosition(v.y),a.setXCrosshairPosition(v.y));var _=r.items;n.showTooltipMarker&&_.length?(r=this._getTooltipMarkerStyle(r),a.setMarkers(r)):a.clearMarkers(),a.show()}else{!1===h&&(tt(n.crosshairsType,"y")||n.showYTip)&&this.chart.get("canvas").draw()}}showTooltip(t){var e,r,i=this,a=i.chart,n=[],s=[],o=i._tooltipCfg,{showItemMarker:l,itemMarkerStyle:h,alwaysShow:c}=o;l&&(r=h);var u=a.get("geoms"),f=a.get("coord");if(m(u,(function(i){if(i.get("visible")){var a=i.get("type"),o=i.getSnapRecords(t),l=i.get("adjust");if("interval"===a&&l&&"symmetric"===l.type)return;m(o,(function(t){var{x:o,y:l,_origin:h,color:c}=t;if((o||!isNaN(o))&&(l||!isNaN(l))){var u={x:o,y:p(l)?l[1]:l,color:c||st.defaultColor,origin:h,name:va(i,h),value:ma(i,h),title:ya(i,h)};r&&(u.marker=O({fill:c||st.defaultColor},r)),s.push(u),-1!==["line","area","path"].indexOf(a)?(e="circle",n.push(u)):"interval"!==a||"cartesian"!==f.type&&"rect"!==f.type||(e="rect",u.width=i.getSize(t._origin),n.push(u))}}))}})),s.length){var g={items:n,type:e};i._setTooltip(t,s,g)}else c||i.hideTooltip()}hideTooltip(){var t=this._tooltipCfg;this._lastActive=null;var e=this.tooltip;e&&(e.hide(),t.onHide&&t.onHide({tooltip:e}),this.chart.get("canvas").draw())}_handleEvent(t,e,r){var i=this.canvas;m([].concat(t),(function(t){"bind"===r?i.on(t,e):i.off(t,e)}))}bindEvents(){var t=this._tooltipCfg,{triggerOn:e,triggerOff:r,alwaysShow:i}=t;e&&this._handleEvent(e,this.handleShowEvent,"bind"),i||this._handleEvent(r,this.handleHideEvent,"bind")}unBindEvents(){var t=this._tooltipCfg,{triggerOn:e,triggerOff:r,alwaysShow:i}=t;e&&this._handleEvent(e,this.handleShowEvent,"unBind"),i||this._handleEvent(r,this.handleHideEvent,"unBind")}}function Sa(t){var e=new _a({chart:t});t.set("tooltipController",e),t.tooltip=function(t,r){return v(t)&&(r=t,t=!0),e.enable=t,r&&(e.cfg=r),this}}function ba(t){var e=t.get("tooltipController");e.render(),t.showTooltip=function(t){return e.showTooltip(t),this},t.hideTooltip=function(){return e.hideTooltip(),this}}function Ma(t){t.get("tooltipController").clear()}const wa={init:Sa,afterGeomDraw:ba,clearInner:Ma},Pa=Object.freeze(Object.defineProperty({__proto__:null,afterGeomDraw:ba,clearInner:Ma,default:wa,init:Sa},Symbol.toStringTag,{value:"Module"}));st.guide=j({line:{style:{stroke:"#a3a3a3",lineWidth:1},top:!0},text:{style:{fill:"#787878",textAlign:"center",textBaseline:"middle"},offsetX:0,offsetY:0,top:!0},rect:{style:{fill:"#fafafa"},top:!1},arc:{style:{stroke:"#a3a3a3"},top:!0},html:{offsetX:0,offsetY:0,alignX:"center",alignY:"middle"},tag:{top:!0,offsetX:0,offsetY:0,side:4,background:{padding:5,radius:2,fill:"#1890FF"},textStyle:{fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"}},point:{top:!0,offsetX:0,offsetY:0,style:{fill:"#fff",r:3,lineWidth:2,stroke:"#1890ff"}}},st.guide||{});class Ca{constructor(t){this.guides=[],this.xScale=null,this.yScales=null,this.guideShapes=[],O(this,t)}_toString(t){return g(t)&&(t=t(this.xScale,this.yScales)),t=t.toString()}_getId(t,e){var r=e.id;if(!r){var i=e.type;r="arc"===i||"line"===i||"rect"===i?this._toString(e.start)+"-"+this._toString(e.end):this._toString(e.position)}return r}paint(t){var e=this,{chart:r,guides:i,xScale:a,yScales:n}=e,s=[];m(i,(function(i,o){var l;i.xScale=a,i.yScales=n,"regionFilter"===i.type?i.chart=r:l=i.top?e.frontPlot:e.backPlot,i.coord=t,i.container=l,i.canvas=r.get("canvas");var h=i.render(t,l);if(h){var c=e._getId(h,i);[].concat(h).forEach((function(t){t._id=t.get("className")+"-"+c,t.set("index",o),s.push(t)}))}})),e.guideShapes=s}clear(){return this.reset(),this.guides=[],this}reset(){m(this.guides,(function(t){t.remove()}))}_createGuide(t,e){var r=T(t),i=new la[r](j({},st.guide[t],e));return this.guides.push(i),i}line(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("line",t)}text(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("text",t)}arc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("arc",t)}html(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("html",t)}rect(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("rect",t)}tag(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("tag",t)}point(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("point",t)}regionFilter(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._createGuide("regionFilter",t)}}function ka(t){var e=new Ca({frontPlot:t.get("frontPlot").addGroup({zIndex:20,className:"guideContainer"}),backPlot:t.get("backPlot").addGroup({className:"guideContainer"})});t.set("guideController",e),t.guide=function(){return e}}function Ta(t){var e=t.get("guideController");if(e.guides.length){var r=t.getXScale(),i=t.getYScales(),a=t.get("coord");e.xScale=r,e.yScales=i,e.chart=t,e.paint(a)}}function Da(t){t.get("guideController").clear()}function Aa(t){t.get("guideController").reset()}const Ia={init:ka,afterGeomDraw:Ta,clear:Da,repaint:Aa},Ya=Object.freeze(Object.defineProperty({__proto__:null,afterGeomDraw:Ta,clear:Da,default:Ia,init:ka,repaint:Aa},Symbol.toStringTag,{value:"Module"}));function Oa(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Na={itemMarginBottom:12,itemGap:10,showTitle:!1,titleStyle:{fontSize:12,fill:"#808080",textAlign:"start",textBaseline:"top"},nameStyle:{fill:"#808080",fontSize:12,textAlign:"start",textBaseline:"middle"},valueStyle:{fill:"#000000",fontSize:12,textAlign:"start",textBaseline:"middle"},unCheckStyle:{fill:"#bfbfbf"},itemWidth:"auto",wordSpace:6,selectedMode:"multiple"};st.legend=j({common:Na,right:O({position:"right",layout:"vertical"},Na),left:O({position:"left",layout:"vertical"},Na),top:O({position:"top",layout:"horizontal"},Na),bottom:O({position:"bottom",layout:"horizontal"},Na)},st.legend||{});class ja{constructor(t){var e=this;Oa(this,"handleEvent",(function(t){var r=e;var i,a,n,s=r.chart,{x:o,y:l}=$(t,s),h=(i=o,a=l,n=null,m(r.legends,(function(t){m(t,(function(t){var{itemsGroup:e,legendHitBoxes:r}=t,s=e.get("children");if(s.length){var o=t.x,l=t.y;m(r,(function(e,r){if(i>=e.x+o&&i<=e.x+e.width+o&&a>=e.y+l&&a<=e.height+e.y+l)return n={clickedItem:s[r],clickedLegend:t},!1}))}}))})),n);if(h&&!1!==h.clickedLegend.clickable){var{clickedItem:c,clickedLegend:u}=h;if(u.onClick)t.clickedItem=c,u.onClick(t);else if(!u.custom){var f=c.get("checked"),g=c.get("dataValue"),{filteredVals:d,field:p,selectedMode:v}=u;"single"===v?s.filter(p,(function(t){return t===g})):(f?d.push(g):R(d,g),s.filter(p,(function(t){return-1===d.indexOf(t)}))),s.repaint()}}})),this.legendCfg={},this.enable=!0,this.position="top",O(this,t);var r=this.chart;this.canvasDom=r.get("canvas").get("el"),this.clear()}addLegend(t,e,r){var i=this,a=i.legendCfg,n=t.field,s=a[n];if(!1===s)return null;if(s&&s.custom)i.addCustomLegend(n);else{var o=a.position||i.position;s&&s.position&&(o=s.position),t.isCategory&&i._addCategoryLegend(t,e,o,r)}}addCustomLegend(t){var e=this,r=e.legendCfg;t&&r[t]&&(r=r[t]);var i=r.position||e.position,a=e.legends;a[i]=a[i]||[];var n=r.items;if(!n)return null;var s=e.container;m(n,(function(t){y(t.marker)?t.marker.radius=t.marker.radius||3:t.marker={symbol:t.marker||"circle",fill:t.fill,radius:3},t.checked=!!d(t.checked)||t.checked,t.name=t.name||t.value}));var o=new ua(j({},st.legend[i],r,{maxLength:e._getMaxLength(i),items:n,parent:s}));a[i].push(o)}clear(){m(this.legends,(function(t){m(t,(function(t){t.clear()}))})),this.legends={},this.unBindEvents()}_isFiltered(t,e,r){var i=!1;return m(e,(function(e){if(i=i||t.getText(e)===t.getText(r))return!1})),i}_getMaxLength(t){var e=this.chart,r=Q(e.get("appendPadding"));return"right"===t||"left"===t?e.get("height")-(r[0]+r[2]):e.get("width")-(r[1]+r[3])}_addCategoryLegend(t,e,r,i){var a=this,{legendCfg:n,legends:s,container:o,chart:l}=a,h=t.field;s[r]=s[r]||[];var c="circle";n[h]&&n[h].marker?c=n[h].marker:n.marker&&(c=n.marker),m(e,(function(e){y(c)?O(e.marker,c):e.marker.symbol=c,i&&(e.checked=!a._isFiltered(t,i,e.dataValue))})),l.get("legendItems")[h]=e;var u=j({},st.legend[r],n[h]||n,{maxLength:a._getMaxLength(r),items:e,field:h,filteredVals:i,parent:o});u.showTitle&&j(u,{title:t.alias||t.field});var f=new ua(u);return s[r].push(f),f}_alignLegend(t,e,r){var{tl:i,bl:a}=this.plotRange,n=this.chart,s=t.offsetX||0,o=t.offsetY||0,l=n.get("width"),h=n.get("height"),c=Q(n.get("appendPadding")),u=t.getHeight(),f=t.getWidth(),g=0,d=0;if("left"===r||"right"===r){var p=t.verticalAlign||"middle",v=Math.abs(i.y-a.y);g="left"===r?c[3]:l-f-c[1],d=(v-u)/2+i.y,"top"===p?d=i.y:"bottom"===p&&(d=a.y-u),e&&(d=e.get("y")-u-12)}else{var m=t.align||"left";if(g=c[3],"center"===m?g=l/2-f/2:"right"===m&&(g=l-(f+c[1])),d="top"===r?c[0]+Math.abs(t.container.getBBox().minY):h-u,e){var y=e.getWidth();g=e.x+y+12}}"bottom"===r&&o>0&&(o=0),"right"===r&&s>0&&(s=0),t.moveTo(g+s,d+o)}alignLegends(){var t=this;return m(t.legends,(function(e,r){m(e,(function(i,a){var n=e[a-1];t._alignLegend(i,n,r)}))})),t}bindEvents(){var t,e,r,i=this.legendCfg.triggerOn||"touchstart";t=this.canvasDom,e=i,r=this.handleEvent,t.addEventListener(e,r,H)}unBindEvents(){var t,e,r,i=this.legendCfg.triggerOn||"touchstart";t=this.canvasDom,e=i,r=this.handleEvent,t.removeEventListener(e,r,H)}}function Ea(t){var e=new ja({container:t.get("backPlot").addGroup(),plotRange:t.get("plotRange"),chart:t});t.set("legendController",e),t.legend=function(t,r){var i=e.legendCfg;return e.enable=!0,f(t,"Boolean")?(e.enable=t,i=r||{}):v(t)?i=t:i[t]=r,e.legendCfg=i,this}}function Fa(t){var e=t.get("legendController");if(!e.enable)return null;var{legendCfg:r,container:i}=e;if(r&&r.custom)e.addCustomLegend();else{var a=t.getLegendItems(),n=t.get("scales"),s=t.get("filters");m(a,(function(t,r){var i,a=n[r],o=a.values;i=s&&s[r]?o.filter((function(t){return!s[r](t)})):[],e.addLegend(a,t,i)}))}r&&!1!==r.clickable&&e.bindEvents();var o=e.legends,l={top:0,right:0,bottom:0,left:0};m(o,(function(e,r){var i=0;m(e,(function(t){var e=t.getWidth(),a=t.getHeight();"top"===r||"bottom"===r?(i=Math.max(i,a),t.offsetY>0&&(i+=t.offsetY)):(i=Math.max(i,e),t.offsetX>0&&(i+=t.offsetX))})),l[r]=i+function(t,e){var r=0;switch(e=Q(e),t){case"top":r=e[0];break;case"right":r=e[1];break;case"bottom":r=e[2];break;case"left":r=e[3]}return r}(r,t.get("appendPadding"))})),t.set("legendRange",l),Object.keys(o).length?i.set("ariaLabel",nt.legend.prefix):i.set("ariaLabel",null)}function za(t){t.get("legendController").alignLegends()}function La(t){t.get("legendController").clear(),t.set("legendRange",null)}const Ba={init:Ea,beforeGeomDraw:Fa,afterGeomDraw:za,clearInner:La},Xa=Object.freeze(Object.defineProperty({__proto__:null,afterGeomDraw:za,beforeGeomDraw:Fa,clearInner:La,default:Ba,init:Ea},Symbol.toStringTag,{value:"Module"}));var Ra="object"==typeof performance&&performance.now?performance:Date;class Ga{constructor(){this.anims=[],this.time=null,this.playing=!1,this.canvas=[]}play(){var t=this;t.time=Ra.now(),t.playing=!0,vi((function e(){t.playing&&(vi(e),t.update())}))}stop(){this.playing=!1,this.time=null,this.canvas=[]}pushAnim(t){this.playing||this.play();var{delay:e,duration:r}=t,i=this.time+e,a=i+r;t.startTime=i,t.endTime=a,this.anims.push(t)}update(){var t=Ra.now();if(this.canvas=[],this.anims.length){for(var e=0;e<this.anims.length;e++){var r=this.anims[e];if(!(t<r.startTime||r.hasEnded)){var i=r.shape;if(i.get("destroyed"))this.anims.splice(e,1),e--;else{var{startState:a,endState:n,interpolate:s,duration:o}=r;t>=r.startTime&&!r.hasStarted&&(r.hasStarted=!0,r.onStart&&r.onStart());var l=(t-r.startTime)/o;if(l=Math.max(0,Math.min(l,1)),l=r.easing(l),r.onFrame)r.onFrame(l);else for(var h in s){var c=(0,s[h])(l),u=void 0;if("points"===h){u=[];for(var f=Math.max(a.points.length,n.points.length),g=0;g<f;g+=2)u.push({x:c[g],y:c[g+1]})}else u=c;i._attrs.attrs[h]=u,i._attrs.bbox=null}var d=i.get("canvas");-1===this.canvas.indexOf(d)&&this.canvas.push(d),r.onUpdate&&r.onUpdate(l),t>=r.endTime&&!r.hasEnded&&(r.hasEnded=!0,r.onEnd&&r.onEnd()),1===l&&(this.anims.splice(e,1),e--)}}}this.canvas.map((function(t){return t.draw(),t})),this.time=Ra.now()}else this.stop()}}function Ha(t){return t}function Wa(t){return 1-Va(1-t)}function Va(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}const qa=Object.freeze(Object.defineProperty({__proto__:null,backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},backOut:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},bounceIn:Wa,bounceInOut:function(t){return t<.5?.5*Wa(2*t):.5*Va(2*t-1)+.5},bounceOut:Va,cubicIn:function(t){return t*t*t},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},cubicOut:function(t){return--t*t*t+1},elasticIn:function(t){var e,r=.1;return 0===t?0:1===t?1:(!r||r<1?(r=1,e=.1):e=.4/(2*Math.PI)*Math.asin(1/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticInOut:function(t){var e,r=.1,i=.4;return 0===t?0:1===t?1:(!r||r<1?(r=1,e=.1):e=i/(2*Math.PI)*Math.asin(1/r),(t*=2)<1?r*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:r*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},elasticOut:function(t){var e,r=.1;return 0===t?0:1===t?1:(!r||r<1?(r=1,e=.1):e=.4/(2*Math.PI)*Math.asin(1/r),r*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},linear:Ha,quadraticIn:function(t){return t*t},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},quadraticOut:function(t){return t*(2-t)}},Symbol.toStringTag,{value:"Module"}));function Za(t){for(var e=[],r=0,i=t.length;r<i;r++)t[r]&&(e.push(t[r].x),e.push(t[r].y));return e}function Ua(t,e){return e-=t=+t,function(r){return t+e*r}}function Ja(t,e){var r,i=e?e.length:0,a=t?Math.min(i,t.length):0,n=new Array(a),s=new Array(i);for(r=0;r<a;++r)n[r]=Ua(t[r],e[r]);for(;r<i;++r)s[r]=e[r];return function(t){for(r=0;r<a;++r)s[r]=n[r](t);return s}}class $a{constructor(t,e,r){this.hasStarted=!1,this.hasEnded=!1,this.shape=t,this.source=e,this.timeline=r,this.animate=null}to(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.delay||0,i=e.attrs||{},a=e.duration||1e3;t="function"==typeof e.easing?e.easing:qa[e.easing]||Ha;var n={shape:this.shape,delay:r,duration:a,easing:t},s={};for(var o in i){var l=this.source[o],h=i[o];"points"===o?(l=Za(l),h=Za(h),s.points=Ja(l,h),this.source.points=l,i.points=h):"matrix"===o?s.matrix=Ja(l,h):s[o]=Ua(l,h)}return n.interpolate=s,n.startState=this.source,n.endState=i,this.timeline.pushAnim(n),this.animate=n,this}onFrame(t){return this.animate&&(this.animate.onFrame=function(e){t(e)}),this}onStart(t){return this.animate&&(this.animate.onStart=function(){t()}),this}onUpdate(t){return this.animate&&(this.animate.onUpdate=function(e){t(e)}),this}onEnd(t){return this.animate&&(this.animate.onEnd=function(){t()}),this}}function Ka(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function Qa(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ka(Object(r),!0).forEach((function(e){tn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ka(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function tn(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var en={appear:{duration:450,easing:"quadraticOut"},update:{duration:300,easing:"quadraticOut"},enter:{duration:300,easing:"quadraticOut"},leave:{duration:350,easing:"quadraticIn"}},rn={defaultCfg:{},Action:{},getAnimation(t,e,r){var i=this.defaultCfg[t];if(i){var a=i[r];if(g(a))return a(e)}return!1},getAnimateCfg(t,e){var r=en[e],i=this.defaultCfg[t];return i&&i.cfg&&i.cfg[e]?j({},r,i.cfg[e]):r},registerAnimation(t,e){this.Action||(this.Action={}),this.Action=Qa(Qa({},this.Action),{},{[t]:e})}};function an(t,e,r){var i;t.apply(e);var a=e[0],n=e[1];if("x"===r){t.transform([["t",a,n],["s",.01,1],["t",-a,-n]]);var s=t.getMatrix();i=gt.transform(s,[["t",a,n],["s",100,1],["t",-a,-n]])}else if("y"===r){t.transform([["t",a,n],["s",1,.01],["t",-a,-n]]);var o=t.getMatrix();i=gt.transform(o,[["t",a,n],["s",1,100],["t",-a,-n]])}else if("xy"===r){t.transform([["t",a,n],["s",.01,.01],["t",-a,-n]]);var l=t.getMatrix();i=gt.transform(l,[["t",a,n],["s",100,100],["t",-a,-n]])}return i}function nn(t,e,r,i){var a=t._id,n=t.get("index"),{easing:s,delay:o,duration:l}=function(t,e,r){var i={};return t.delay&&(i.delay=g(t.delay)?t.delay(e,r):t.delay),i.easing=t.easing,i.duration=t.duration,i.delay=t.delay,i}(r,n,a),h=t.animate().to({attrs:e,duration:l,delay:o,easing:s});i&&h.onEnd((function(){i()}))}function sn(t,e){var r=d(t.attr("fillOpacity"))?1:t.attr("fillOpacity"),i=d(t.attr("strokeOpacity"))?1:t.attr("strokeOpacity");t.attr("fillOpacity",0),t.attr("strokeOpacity",0),nn(t,{fillOpacity:r,strokeOpacity:i},e)}const on=Object.freeze(Object.defineProperty({__proto__:null,fadeIn:sn},Symbol.toStringTag,{value:"Module"}));function ln(t,e,r,i,a){var n,s,{start:o,end:l,width:h,height:c}=function(t){var e=t.start,r=t.end;return{start:e,end:r,width:r.x-e.x,height:Math.abs(r.y-e.y)}}(r),u=new Ur.Rect({attrs:{x:o.x,y:l.y,width:h,height:c}});"y"===a?(n=o.x+h/2,s=i.y<o.y?i.y:o.y):"x"===a?(n=i.x>o.x?i.x:o.x,s=o.y+c/2):"xy"===a&&(r.isPolar?(n=r.center.x,s=r.center.y):(n=(o.x+l.x)/2,s=(o.y+l.y)/2));var f=an(u,[n,s],a);u.isClip=!0,u.endState={matrix:f},u.set("canvas",t.get("canvas")),t.attr("clip",u);nn(u,u.endState,e,(function(){t.attr("clip",null),u.remove(!0)}))}function hn(t,e,r){for(var i=t.get("children"),a=0,n=i.length;a<n;a++){var s=i[a],o=s.getBBox();nn(s,{matrix:an(s,[(o.minX+o.maxX)/2,(o.minY+o.maxY)/2],r)},e)}}function cn(t,e,r,i){ln(t,e,r,i,"x")}function un(t,e,r,i){ln(t,e,r,i,"y")}function fn(t,e,r,i){ln(t,e,r,i,"xy")}function gn(t,e){hn(t,e,"xy")}function dn(t,e,r){var i=_i(r);i.set("canvas",t.get("canvas")),t.attr("clip",i);var a={};if(r.isPolar){var{startAngle:n,endAngle:s}=r;a.endAngle=s,i.attr("endAngle",n)}else{var{start:o,end:l}=r,h=Math.abs(o.x-l.x),c=Math.abs(o.y-l.y);r.isTransposed?(i.attr("height",0),a.height=c):(i.attr("width",0),a.width=h)}nn(i,a,e,(function(){t.attr("clip",null),i.remove(!0)}))}const pn=Object.freeze(Object.defineProperty({__proto__:null,groupScaleInX:cn,groupScaleInXY:fn,groupScaleInY:un,groupWaveIn:dn,shapesScaleInX:function(t,e){hn(t,e,"x")},shapesScaleInXY:gn,shapesScaleInY:function(t,e){hn(t,e,"y")}},Symbol.toStringTag,{value:"Module"}));var vn;Zr.prototype.animate=function(){var t=O({},this.get("attrs"));return new $a(this,t,vn)},Mi.prototype.animate=function(t){return this.set("animate",t),this},rn.Action=on,rn.defaultCfg={interval:{enter:t=>t.isPolar&&t.transposed?function(t){t.set("zIndex",-1),t.get("parent").sort()}:sn},area:{enter:t=>t.isPolar?null:sn},line:{enter:t=>t.isPolar?null:sn},path:{enter:t=>t.isPolar?null:sn}};var mn={line:t=>t.isPolar?fn:dn,area:t=>t.isPolar?fn:dn,path:t=>t.isPolar?fn:dn,point:()=>gn,interval(t){var e;return t.isPolar?(e=fn,t.transposed&&(e=dn)):e=t.transposed?cn:un,e},schema:()=>dn};function yn(t,e,r){var i=[];return m(t,(function(t,a){var n=t.get("container").get("children"),s=t.get("type"),o=d(t.get("animateCfg"))?bn(s,e):t.get("animateCfg");!1!==o&&m(n,(function(e,n){e.get("className")===s&&(e._id=function(t,e,r){var i,a=t.get("type"),n="geom"+r+"-"+a,s=t.getXScale(),o=t.getYScale(),l=s.field||"x",h=o.field||"y",c=e[h];return i=s.isIdentity?s.value:e[l],n+="interval"===a||"schema"===a?"-"+i:"line"===a||"area"===a||"path"===a?"-"+a:s.isCategory?"-"+i:"-"+i+"-"+c,m(t._getGroupScales(),(function(t){var r=t.field;"identity"!==t.type&&(n+="-"+e[r])})),n}(t,e.get("origin")._origin,a),e.set("coord",r),e.set("animateCfg",o),e.set("index",n),i.push(e))})),t.set("shapes",n)})),i}function xn(t,e,r,i){return g(i)?i:_(i)?rn.Action[i]:rn.getAnimation(t,e,r)}function _n(t,e,r){if(!1===r||v(r)&&!1===r[e])return!1;var i=rn.getAnimateCfg(t,e);return r&&r[e]?j({},i,r[e]):i}function Sn(t,e,r){var i,a,n=[],s=[];m(e,(function(e){var r=t[e._id];r?(e.set("cacheShape",r),n.push(e),delete t[e._id]):s.push(e)})),m(t,(function(t){var{className:e,coord:n,_id:s,attrs:o,index:l,type:h}=t;if(!1===(a=_n(e,"leave",t.animateCfg)))return!0;if(i=xn(e,n,"leave",a.animation),g(i)){var c=r.addShape(h,{attrs:o,index:l,canvas:r,className:e});c._id=s,i(c,a,n)}})),m(n,(function(t){var e=t.get("className");if(!1===(a=_n(e,"update",t.get("animateCfg"))))return!0;var r=t.get("coord"),n=t.get("cacheShape").attrs,s=function(t,e){var r={};for(var i in e)(w(t[i])&&t[i]!==e[i]||p(t[i])&&JSON.stringify(t[i])!==JSON.stringify(e[i]))&&(r[i]=e[i]);return r}(n,t._attrs.attrs);if(Object.keys(s).length)if(i=xn(e,r,"update",a.animation),g(i))i(t,a,r);else{var o={};m(s,(function(t,e){o[e]=n[e]})),t.attr(o),t.animate().to({attrs:s,duration:a.duration,easing:a.easing,delay:a.delay}).onEnd((function(){t.set("cacheShape",null)}))}})),m(s,(function(t){var e=t.get("className"),r=t.get("coord");if(!1===(a=_n(e,"enter",t.get("animateCfg"))))return!0;if(i=xn(e,r,"enter",a.animation),g(i))if("interval"===e&&r.isPolar&&r.transposed){var s=t.get("index"),o=n[s-1];i(t,a,o)}else i(t,a,r)}))}function bn(t,e){if(!t)return null;var r=e.get("animate");return t.indexOf("guide-tag")>-1&&(t="guide-tag"),v(r)?r[t]:!1!==r&&null}function Mn(){(vn=new Ga).play()}function wn(t){if(!1!==t.get("animate")){var e=t.get("isUpdate"),r=t.get("canvas"),i=t.get("coord"),a=t.get("geoms"),n=r.get("caches")||[];0===n.length&&(e=!1);var s=yn(a,t,i),{frontPlot:o,backPlot:l}=t.get("axisController"),h=o.get("children").concat(l.get("children")),c=[];t.get("guideController")&&(c=t.get("guideController").guideShapes);var u,f,p=[];if(h.concat(c).forEach((function(e){var r=bn(e.get("className"),t);e.set("coord",i),e.set("animateCfg",r),p.push(e),s.push(e)})),r.set("caches",function(t){for(var e={},r=0,i=t.length;r<i;r++){var a=t[r];if(a._id&&!a.isClip){var n=a._id;e[n]={_id:n,type:a.get("type"),attrs:O({},a._attrs.attrs),className:a.get("className"),geomType:a.get("className"),index:a.get("index"),coord:a.get("coord"),animateCfg:a.get("animateCfg")}}}return e}(s)),e)Sn(n,s,r);else m(a,(function(e){var r=e.get("type"),a=d(e.get("animateCfg"))?bn(r,t):e.get("animateCfg");if(!1!==a)if(u=_n(r,"appear",a),f=xn(r,i,"appear",u.animation),g(f))m(e.get("shapes"),(function(t){f(t,u,i)}));else if(mn[r]){f=pn[u.animation]||mn[r](i);var n=e.getYScale(),s=i.convertPoint({x:0,y:n.scale(e.getYMinValue())}),o=e.get("container");f&&f(o,u,i,s)}})),m(p,(function(t){var e=t.get("animateCfg"),r=t.get("className");if(e&&e.appear){var a=rn.getAnimateCfg(r,"appear"),n=j({},a,e.appear),s=xn(r,i,"appear",n.animation);g(s)&&s(t,n,i)}}))}}function Pn(){vn.stop()}const Cn={afterCanvasInit:Mn,beforeCanvasDraw:wn,afterCanvasDestroyed:Pn},kn=Object.freeze(Object.defineProperty({__proto__:null,afterCanvasDestroyed:Pn,afterCanvasInit:Mn,beforeCanvasDraw:wn,default:Cn},Symbol.toStringTag,{value:"Module"}));function Tn(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Mi._Interactions={},Mi.registerInteraction=function(t,e){Mi._Interactions[t]=e},Mi.getInteraction=function(t){return Mi._Interactions[t]},Mi.prototype.interaction=function(t,e){var r=this._interactions||{};r[t]&&r[t].destroy();var i=new(Mi.getInteraction(t))(e,this);return r[t]=i,this._interactions=r,this},Mi.prototype.clearInteraction=function(t){var e=this._interactions;if(e)return t?(e[t]&&e[t].destroy(),delete e[t]):m(e,(function(t,r){t.destroy(),delete e[r]})),this};var Dn=[0,1];class An{constructor(t){var e=this;Tn(this,"chart",null),Tn(this,"values",null),Tn(this,"range",Dn),Tn(this,"startRange",Dn),Tn(this,"minCount",10),Tn(this,"_afterinit",(function(){var t=e.getPinchScale(),r=[].concat(t.values);e.values=r,e.minScale||(e.minScale=e.minCount/r.length),e.range!==Dn&&(e.updateRange(e.range),e.updateTicks())})),Tn(this,"_afterdatachange",(function(){e.updateRange(e.range)})),this.chart=t,this._initEvent(t)}_initEvent(t){t.on(ot,this._afterinit),t.on(lt,this._afterdatachange)}getPinchScale(){var{chart:t}=this;return t.getXScale()}getFollowScale(){var{chart:t}=this;return(t.getYScales()||[])[0]}start(){var{range:t}=this,e=this.getPinchScale(),[r,i]=t;this.startRange=[r,i],this.lastTickCount=e.tickCount}doZoom(t,e,r){var{startRange:i,minScale:a}=this,[n,s]=i,o=(s-n)*(1-r),l=o*t,h=o*e,c=Math.max(0,n-l),u=Math.min(1,s+h),f=[c,u];u-c<a||this.updateRange(f)}doMove(t){if(t){var e,{startRange:r}=this,[i,a]=r,n=a-i,s=n*t,o=i-s,l=a-s;e=o<0?[0,n]:l>1?[1-n,1]:[o,l],this.updateRange(e)}}updateRange(t){var{values:e}=this,[r,i]=t;r=Math.max(0,r),i=Math.min(1,i),this.range=[r,i];var a=e.length,n=r*a,s=i*a,o=e.slice(n,s);this.repaint(o)}repaint(t){var{chart:e}=this,r=this.getPinchScale(),{values:i,ticks:a}=r;(function(t,e){if(t.length!==e.length)return!1;var r=t.length-1;return t[0]===e[0]&&t[r]===e[r]})(i,t)||(this.updateScale(r,{ticks:a,values:t}),this.updateFollowScale(r,t),e.repaint())}updateFollowScale(t,e){var{chart:r}=this,i=this.getFollowScale(),{field:a,type:n}=t,{field:s}=i,o=[],l={};e.forEach((function(t){l[t]=!0})),r.get("data").forEach((function(t){if("timeCat"===n){var e=et(t[a]);l[e]&&o.push(t[s])}}));var{min:h,max:c}=G(o);this.updateScale(i,{min:h,max:c,nice:!0})}updateScale(t,e){t&&t.change(e)}updateTicks(){var{chart:t,values:e}=this,r=this.getPinchScale(),{values:i,tickCount:a}=r,n=Math.round(a*e.length/i.length),s=Wt("cat")({tickCount:n,values:e});this.updateScale(r,{ticks:s,values:i}),t.repaint()}destroy(){var{chart:t}=this;t.off(ot,this._afterinit),t.off(lt,this._afterdatachange)}}function In(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class Yn{getDefaultCfg(){return{}}getInteractionContext(t){var e=t.get("interactionContext");return e||(e=new An(t),t.set("interactionContext",e),e)}constructor(t,e){var r=this;In(this,"type",""),In(this,"startEvent","touchstart"),In(this,"processEvent","touchmove"),In(this,"endEvent","touchend"),In(this,"resetEvent",null),In(this,"context",null),In(this,"_start",(function(t){r.preStart&&r.preStart(t),r.start(t),r.onStart&&r.onStart(t)})),In(this,"_process",(function(t){r.preProcess&&r.preProcess(t),r.process(t),r.onProcess&&r.onProcess(t)})),In(this,"_end",(function(t){r.preEnd&&r.preEnd(t),r.end(t),r.onEnd&&r.onEnd(t)})),In(this,"_reset",(function(t){r.preReset&&r.preReset(t),r.reset(t),r.onReset&&r.onReset(t)})),O(this,this.getDefaultCfg(),t),this.context=this.getInteractionContext(e),this.chart=e;var{range:i}=this;i&&(this.context.range=i),this._bindEvents(e)}_bindEvents(t){var{startEvent:e,processEvent:r,endEvent:i,resetEvent:a}=this,n=t.get("canvas");n.on(e,this._start),n.on(r,this._process),n.on(i,this._end),n.on(a,this._reset)}_clearEvents(){var{chart:t,startEvent:e,processEvent:r,endEvent:i,resetEvent:a}=this,n=t.get("canvas");n.off(e,this._start),n.off(r,this._process),n.off(i,this._end),n.off(a,this._start)}start(){}process(){}end(){}reset(){}destroy(){this.context.destroy(),this._clearEvents()}}Mi.registerInteraction("pan",class extends Yn{getDefaultCfg(){return{type:"pan",startEvent:"panstart",processEvent:"pan",endEvent:"panend"}}start(){var{context:t}=this;t.start()}process(t){var{direction:e,deltaX:r}=t;if("up"!==e&&"down"!==e){t.preventDefault&&t.preventDefault();var{context:i}=this,a=i.chart.get("coord"),{start:n,end:s}=a,o=r/(s.x-n.x);i.doMove(o)}}}),Mi.registerInteraction("pinch",class extends Yn{getDefaultCfg(){return{type:"pinch",startEvent:"pinchstart",processEvent:"pinch",endEvent:"pinchend"}}constructor(t,e){super(t,e);var{context:r}=this;O(r,t)}start(){var{context:t}=this;t.start()}process(t){t.preventDefault&&t.preventDefault();var{zoom:e,center:r}=t,{context:i}=this,{chart:a}=i,n=a.get("coord"),{start:s,end:o}=n,l=o.x-s.x,h=Math.abs(r.x-s.x)/l,c=Math.abs(o.x-r.x)/l;i.doZoom(h,c,e)}end(){var{context:t}=this;t.updateTicks()}}),Ur.Marker,Mi.plugins.register([Pa,Xa,Ya,kn]);const On={Chart:Mi},Nn=()=>{const{recordList:t}=s(),i=e.useMemo((()=>{const e=t.sort(((t,e)=>new Date(t.date).getTime()-new Date(e.date).getTime())),r=e[e.length-1],i=(null==r?void 0:r.kilometerOfDisplay)??0;return{...t.reduce(((t,e)=>("refueling"===e.type?(t.refuelingCost+=Number(e.cost),t.equalOilCount+=Number(e.oil)):(t.chargingCost+=Number(e.cost),t.equalElecCount+=Number(e.electric)),t)),{refuelingCost:0,chargingCost:0,equalOilCount:0,equalElecCount:0}),totalKilometers:i}}),[t]),a=e.useMemo((()=>{if(i.totalKilometers<=0)return 0;return(i.refuelingCost+i.chargingCost)/i.totalKilometers*100}),[i]),{refuelingCost:n,chargingCost:o,equalOilCount:l,equalElecCount:h}=i;return r.jsxs("div",{className:"statistics-card",children:[r.jsx("h3",{className:"statistics-title",children:"能源消耗统计"}),r.jsxs("div",{className:"statistics-content",children:[r.jsxs("div",{className:"statistics-item",children:[r.jsx("span",{className:"label",children:"每百公里平均花费"}),r.jsxs("span",{className:"value",children:[a.toFixed(2)," 元"]})]}),r.jsxs("div",{className:"statistics-details",children:[r.jsxs("div",{className:"statistics-item",children:[r.jsx("span",{className:"label",children:"补能总量："}),r.jsxs("span",{className:"value",children:[r.jsx("span",{className:"oil",children:l.toFixed(2)})," L +",r.jsx("span",{className:"charge",children:h.toFixed(2)})," kWh"]})]}),r.jsxs("div",{className:"statistics-item",children:[r.jsx("span",{className:"label",children:"等效："}),r.jsxs("div",{className:"value",children:[r.jsx("span",{className:"oil",children:(l+h/3.5).toFixed(2)})," L /",r.jsx("span",{className:"charge",children:(h+3.5*l).toFixed(2)})," kWh"]})]})]}),r.jsxs("div",{className:"statistics-details",children:[r.jsxs("div",{className:"statistics-item",children:[r.jsx("span",{className:"label",children:"总花费："}),r.jsxs("div",{className:"mid-label",children:[r.jsx("span",{className:"oil",children:n.toFixed(2)})," 元 +",r.jsx("span",{className:"charge",children:o.toFixed(2)})," 元"]}),r.jsxs("span",{className:"value",children:[(n+o).toFixed(2),"元"]})]}),r.jsxs("div",{className:"statistics-item",children:[r.jsx("span",{className:"label",children:"总里程"}),r.jsxs("span",{className:"value",children:[i.totalKilometers," km"]})]})]})]})]})},jn=({chartId:t,width:i,renderChart:a})=>(e.useEffect((()=>{i&&a()}),[i]),r.jsx("div",{className:`${t} chart-container`,children:r.jsx("canvas",{id:t,width:i||100,height:"260"})})),En=({width:t})=>{const{recordList:i}=s(),a="power-chart",n=e.useMemo((()=>{const t=[],e=[];return i.forEach((r=>{var i,a;const n=o(r.date).format("YY/MM");"charging"===r.type&&(n===(null==(i=t[t.length-1])?void 0:i.date)?t[t.length-1].value+=1:t.push({date:n,name:"充电",value:1})),"refueling"===r.type&&(n===(null==(a=e[e.length-1])?void 0:a.date)?e[e.length-1].value+=1:e.push({date:n,name:"加油",value:1}))})),[...t,...e].sort(((t,e)=>{const r=t.date.split("/"),i=e.date.split("/"),a=Number(r[0])-Number(i[0]);return 0===a?Number(r[1])-Number(i[1]):a}))}),[i]);e.useMemo((()=>{let t=i.reduce(((t,e)=>{const r=o(e.date).format("YY/MM");if(0===t.length)t.push([{date:r,value:e.kilometerOfDisplay}]);else{r===t[t.length-1][0].date?t[t.length-1].push({date:r,value:e.kilometerOfDisplay}):t.push([{date:r,value:e.kilometerOfDisplay}])}return t}),[]);return t.map(((e,r)=>{if(0===r)return{date:e[0].date,value:Number(e[e.length-1].value)};{const i=t[r-1],a=i[i.length-1].value;return{date:e[0].date,value:e[e.length-1].value-a}}}))}),[i]);return r.jsx(jn,{chartId:a,width:t,renderChart:()=>{const t=new On.Chart({id:a,pixelRatio:window.devicePixelRatio});t.source(n),t.interval().position("date*value").color("name").adjust({type:"dodge",marginRatio:.05}),t.render()}})},Fn=({width:t})=>{const{recordList:i}=s(),a="monthly-mileage-chart",n=e.useMemo((()=>{let t=i.reduce(((t,e)=>{const r=o(e.date).format("YY/MM");if(0===t.length)t.push([{date:r,value:e.kilometerOfDisplay}]);else{r===t[t.length-1][0].date?t[t.length-1].push({date:r,value:e.kilometerOfDisplay}):t.push([{date:r,value:e.kilometerOfDisplay}])}return t}),[]);return t.map(((e,r)=>{if(0===r)return{date:e[0].date,value:Number(e[e.length-1].value)};{const i=t[r-1],a=i[i.length-1].value;return{date:e[0].date,value:e[e.length-1].value-a}}}))}),[i]);return r.jsx(jn,{chartId:a,width:t,renderChart:()=>{const t=new On.Chart({id:a,pixelRatio:window.devicePixelRatio});t.source(n),t.line().position("date*value"),t.render()}})},zn=({recordList:t,width:i})=>{const a="basic-chart",n=e.useMemo((()=>{const e=[];return t.filter((t=>"charging"===t.type)).forEach((t=>{const r=o(t.date).format("MM/DD");e.push({date:r,value:Number(t.cost),type:"费用"},{date:r,value:Number((t.cost/t.electric*10).toFixed(2)),type:"价格*10"},{date:r,value:t.electric,type:"电量"})})),e}),[t]);return e.useEffect((()=>{i&&(()=>{const t=new On.Chart({id:a,pixelRatio:window.devicePixelRatio});t.source(n,{cost:{tickCount:5,min:0}}),t.tooltip({custom:!0,onChange:function(e){const r=t.get("legendController").legends.top[0],i=e.items,a=r.items,n=new Map;a.forEach((function(t){n.set(t.name,{...t})})),i.forEach((function(t){const e=t.name,r=t.value;n.get(e)&&n.set(e,{...t,value:r})})),r.setItems(Array.from(n.values()))},onHide:function(){t.get("legendController").legends.top[0].setItems(t.getLegendItems().type??[])}}),t.line().position("date*value").color("type"),t.render()})()}),[i]),r.jsx("div",{className:"basic-chart chart-container",children:r.jsx("canvas",{id:a,width:i||100,height:"260"})})},Ln=({recordList:t,width:i})=>{const a="per-cost-chart",n=e.useMemo((()=>{const e=[];let r=0;return t.forEach((({kilometerOfDisplay:t,cost:i})=>{if(r+=Number(i),t>=100*e.length){const i=Number((r/t*100).toFixed(2)),a=Math.floor((t-100*e.length)/100);for(let t=0;t<a;t++)e.push({range:100*e.length,value:i})}})),e.filter((t=>t.value<100))}),[t]);return e.useEffect((()=>{i&&(()=>{const t=new On.Chart({id:a,pixelRatio:window.devicePixelRatio});t.source(n,{range:{tickCount:5},value:{alias:"平均花费"}}),t.line().position("range*value").shape("smooth"),t.render()})()}),[i]),r.jsx("div",{className:"per-cost-chart chart-container",children:r.jsx("canvas",{id:a,width:i||100,height:"260"})})},Bn=()=>{const{recordList:t}=s(),i=e.useRef(null),[a,n]=e.useState(0);e.useEffect((()=>{const t=()=>{const t=i.current.getBoundingClientRect();n(t.width-32)};return i.current&&t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[i]);const o=t.length?t:l;return r.jsxs("div",{className:"chart-page",children:[!t.length&&r.jsx("div",{className:"demo-data-tip",children:"DEMO MODE"}),r.jsx(Nn,{}),r.jsxs("div",{className:"content",ref:i,children:[r.jsx(zn,{recordList:o,width:a}),r.jsx("p",{className:"chart-legend",children:"充电记录"}),r.jsx(Ln,{recordList:o,width:a}),r.jsx("p",{className:"chart-legend",children:"每百公里平均费用"}),r.jsx(En,{width:a}),r.jsx("p",{className:"chart-legend",children:"充电加油记录"}),r.jsx(Fn,{width:a}),r.jsx("p",{className:"chart-legend",children:"每月行驶里程"})]})]})};export{Bn as default};
