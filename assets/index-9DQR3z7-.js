import{r as e,j as a,u as l,b as t,a as r}from"./index-u5DnuwxY.js";import{d as i,c as s}from"./spin-loading-DwfaOn8j.js";import{B as n}from"./space-B4DpkMUn.js";import{N as o,I as c}from"./index-C0crkjCK.js";import{D as d,S as u}from"./selector-CBF6-ZR2.js";import"./LeftOutline-BdLPOPaU.js";const m=({onChange:l,defaultValue:t})=>{const[r,s]=e.useState(new Date(Date.now())),[n,o]=e.useState(!1);e.useEffect(()=>{t&&s(new Date(t))},[t]);const c={year:"年",month:"月",day:"日",hour:"时"};return a.jsxs("div",{className:"calendar-picker",children:[a.jsx("p",{className:"calendar-display",onClick:()=>{o(!0)},children:i(r).format("YYYY.MM.DD - HH:00")}),a.jsx(d,{visible:n,value:r,onClose:()=>{o(!1)},onConfirm:e=>{s(e),o(!1),l(e)},precision:"hour",renderLabel:(e,a)=>`${a}${c[e]}`})]})},p=()=>{const i=l(),d=t(),[p,f]=e.useState({id:0,type:"charging",oil:0,electric:0,cost:0,kilometerOfDisplay:0,date:Date.now()}),{setRecordData:y,removeRecordById:v,updateRecordById:b,recordList:h}=r();e.useEffect(()=>{if(d.id){const e=h.find(e=>Number(e.id)===Number(d.id));e&&f(e)}},[d.id]);const j=(e,a)=>{f({...p,[e.key]:a})},g=[{key:"type",label:"类型：",value:p.type,dataType:"select",data:{options:[{label:"加油",value:"refueling"},{label:"充电",value:"charging"}]}},"refueling"===p.type&&{key:"oil",label:"油量：",value:p.oil,dataType:"number",unit:"升"},"charging"===p.type&&{key:"electric",label:"电量：",value:p.electric,dataType:"number",unit:"度"},{key:"cost",label:"费用：",value:p.cost,dataType:"number",unit:"元（CNY）"},{key:"kilometerOfDisplay",label:"表显里程：",value:p.kilometerOfDisplay,dataType:"number",unit:"Km"},{key:"date",label:"时间",value:p.date,dataType:"date"}].filter(e=>!!e);return a.jsxs("div",{className:"record-container",children:[a.jsx(o,{title:d.id?"编辑记录":"新增记录",right:d.id&&a.jsx(n,{fill:"none",onClick:()=>{d.id&&(v(d.id),i(-1))},style:{color:"#ff4d4f"},children:"删除"})}),a.jsx("div",{className:s("type-line",p.type)}),a.jsxs("div",{className:"record-content",children:[a.jsx("div",{className:"record-form",children:g.map(e=>a.jsxs("div",{className:"record-form-item",children:[a.jsx("div",{className:"record-form-item-label",children:e.label}),a.jsxs("div",{className:"record-form-item-input",children:["select"===e.dataType?a.jsx(u,{className:s("record-form-item-selector",{charging:"charging"===e.value,refueling:"refueling"===e.value}),options:e.data.options,value:[e.value],onChange:a=>{j(e,a[0])}}):null,"number"===e.dataType?a.jsx(c,{onClick:e=>{e.target.select()},type:"number",value:String(e.value),onChange:a=>{j(e,a)}}):null,"date"===e.dataType?a.jsx(m,{onChange:a=>{j(e,a.toString())},defaultValue:new Date(e.value)}):null,a.jsx("p",{className:"record-form-item-unit",children:e.unit})]})]},e.key))}),a.jsx(n,{type:"submit",color:"primary",className:"record-form-submit",onClick:()=>{d.id?b(Number(d.id),p):y(p),i(-1)},children:"提交"})]})]})};export{p as default};
